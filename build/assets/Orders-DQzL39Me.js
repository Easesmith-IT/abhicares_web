import{r,j as e,f,e as O}from"./index-DmceSUEu.js";import{c as t,W as $}from"./Wrapper-CijAMONv.js";import{i as S,x as I}from"./LogoutModal-BO_6Xxx7.js";import{L as M}from"./Loader-ChNLyE8c.js";import{R as P}from"./index.esm-CK3PNbdM.js";import{h as A}from"./jspdf-html2canvas.min-DV9-5cxe.js";import{f as h}from"./index-DSEmMwTb.js";import{P as k}from"./react-bootstrap-pagination-control.esm-z_C9wi5S.js";import"./logo -C1Nz5jdc.js";import"./iconBase-CgRV0d11.js";const F="_wrapper_7u2da_1",V="_modal_7u2da_27",R="_heading_container_7u2da_45",E="_contianer_7u2da_61",L="_mt_7u2da_87",T="_btn_container_7u2da_95",U="_button_7u2da_109",W="_table_wrapper_7u2da_125",Y="_table_7u2da_125",q="_d_flex_7u2da_151",i={wrapper:F,modal:V,heading_container:R,contianer:E,mt:L,btn_container:T,button:U,table_wrapper:W,table:Y,d_flex:q},z=({setIsModalOpen:l})=>{const[o,p]=r.useState(""),[c,j]=r.useState([]);c.map(a=>[{OrderId:a._id},{date:h(new Date(a.createdAt),"dd-MM-yyyy")},{value:0},{orderValue:a.orderValue},{time:h(new Date(a.createdAt),"hh.mm aaaaa'm'")},{name:a.user.name},{phone:a.user.phone}]);const x=()=>{A(document.querySelector("#table"),{jsPDF:{format:"a4"},imageType:"image/jpeg",output:"./pdf/generate.pdf"})},g=a=>{p(a.target.value)},y=async()=>{if(o)try{const a=o.split("-"),{data:m}=await f.post("https://abhicares.com/api/admin/get-monthly-orders",{month:a[1],year:a[0]},{withCredentials:!0});l(!0),j(m.data),console.log("orders-month",m)}catch(a){console.log(a)}};return e.jsx("div",{className:i.wrapper,children:e.jsxs("div",{className:i.modal,children:[e.jsxs("div",{className:i.heading_container,children:[e.jsx("h4",{children:"Monthly Orders"}),e.jsxs("div",{className:i.d_flex,children:[e.jsxs("div",{className:t.d_flex,children:[e.jsx("input",{onChange:g,type:"month",name:"month",id:"month"}),e.jsx("button",{onClick:y,children:"Submit"})]}),e.jsx(P,{onClick:()=>l(!1),cursor:"pointer",size:26})]})]}),c.length===0&&e.jsx("p",{style:{padding:"0px 0px 20px 20px"},children:"No orders found."}),c.length>0&&e.jsxs("div",{className:t["report-body"],children:[e.jsx("div",{id:"table",className:i.table_wrapper,children:e.jsxs("table",{border:"2px",className:i.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"OrderId"}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{children:"Total Value"}),e.jsx("th",{children:"Order Time"}),e.jsx("th",{children:"User Name"}),e.jsx("th",{children:"User Mobile"})]})}),e.jsx("tbody",{children:c.map(a=>e.jsxs("tr",{children:[e.jsx("td",{style:{width:"210px",paddingInline:"10px"},children:a._id}),e.jsx("td",{style:{width:"160px"},children:h(new Date(a.createdAt),"dd-MM-yyyy")}),e.jsx("td",{children:a.orderValue}),e.jsx("td",{children:h(new Date(a.createdAt),"hh.mm aaaaa'm'")}),e.jsx("td",{children:a.user.name}),e.jsx("td",{children:a.user.phone})]}))})]})}),e.jsx("div",{className:i.btn_container,children:e.jsx("button",{className:i.button,onClick:x,children:"Download"})})]})]})})},ae=()=>{const[l,o]=r.useState([]),[p,c]=r.useState(!0),[j,x]=r.useState(!1);r.useState(null);const[g,y]=r.useState(1),[a,m]=r.useState(1),[d,N]=r.useState({startDate:"",endDate:"",status:""}),_=s=>{const{name:n,value:u}=s.target;N({...d,[n]:u})},v=r.useRef(),D=O(),C=async s=>{m(s)},b=async()=>{var s;try{const{data:n}=await f.get(`https://abhicares.com/api/admin/get-all-orders?page=${a}&status=${d.status}&startDate=${d.startDate}&endDate=${d.endDate}`,{withCredentials:!0});o(n.data),y(Number((s=n==null?void 0:n.pagination)==null?void 0:s.totalPages)),console.log("allOrders",n)}catch(n){console.log(n)}finally{c(!1)}};r.useEffect(()=>{b()},[a,d.status,d.startDate,d.endDate]);const w=async()=>{var s;try{const n=v.current.value;if(!n){b();return}const{data:u}=await f.get(`https://abhicares.com/api/admin/get-order-by-id?orderId=${n}`,{withCredentials:!0});console.log("orderbyid",u),o([u.data])}catch(n){console.log(n),((s=n==null?void 0:n.response)==null?void 0:s.status)===404&&o([])}};return e.jsxs(e.Fragment,{children:[e.jsx($,{children:e.jsxs("div",{className:t["report-container"],children:[e.jsxs("div",{className:t["report-header"],children:[e.jsx("h1",{className:t["recent-Articles"],children:"Orders"}),e.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"flex-end"},children:[e.jsxs("div",{children:[e.jsx("p",{children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:d.startDate,onChange:_,className:t.filter_input})]}),e.jsxs("div",{children:[e.jsx("p",{children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:d.endDate,onChange:_,className:t.filter_input})]}),e.jsxs("select",{name:"status",value:d.status,onChange:_,className:t.filter_input,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"OutOfDelivery",children:"OutOfDelivery"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]}),e.jsxs("div",{className:"d-flex",style:{position:"relative"},children:[e.jsx("input",{ref:v,style:{width:"300px",padding:"5px 10px",borderRadius:"5px"},type:"text",placeholder:"search order by id"}),e.jsx(S,{onClick:w,style:{position:"absolute",right:"8px",top:"10px",cursor:"pointer"}})]}),e.jsx("div",{className:t.d_flex,children:e.jsx("button",{onClick:()=>x(!0),children:e.jsx(I,{})})})]})]}),e.jsxs("div",{className:t["report-body"],children:[e.jsxs("div",{className:t["report-topic-heading"],children:[e.jsx("h3",{className:t["t-op"],style:{width:"200px"},children:"Order Id"}),e.jsx("h3",{className:t["t-op"],children:"Order Date"}),e.jsx("h3",{className:`${t["t-op"]}`,children:"Status"}),e.jsx("h3",{className:`${t["t-op"]}`,children:"Order Value"}),e.jsx("h3",{className:t["t-op"],children:"Details"})]}),e.jsxs("div",{className:t.items,children:[!p&&(l==null?void 0:l.length)===0&&e.jsx("p",{children:"No orders found"}),p&&(l==null?void 0:l.length)===0&&e.jsx(M,{}),l==null?void 0:l.map((s,n)=>e.jsxs("div",{className:`${t.item1} ${t.cursor}`,children:[e.jsx("h3",{className:`${t["t-op-nextlvl"]}`,style:{width:"200px"},children:s.orderId}),e.jsx("h3",{className:t["t-op-nextlvl"],children:h(new Date(s.createdAt),"dd-MM-yyyy")}),e.jsx("h3",{className:`${t["t-op-nextlvl"]} ${t.status} ${s.status==="Cancelled"?t.Cancelled:s.status==="Completed"?t.Completed:s.status==="pending"?t.pending:t.OutOfDelivery}`,children:s.status}),e.jsxs("h3",{className:`${t["t-op-nextlvl"]}`,children:["â‚¹",s.orderValue]}),e.jsx("h3",{className:t["t-op-nextlvl"],children:e.jsx("button",{onClick:()=>D(`/admin/Orders/${s._id}`,{state:s}),className:t.button,children:"View Details"})})]},n))]}),e.jsx("div",{style:{marginTop:"100px"},children:e.jsx(k,{changePage:C,limit:10,page:a,total:g+"0"})})]})]})}),j&&e.jsx(z,{setIsModalOpen:x})]})};export{ae as default};
