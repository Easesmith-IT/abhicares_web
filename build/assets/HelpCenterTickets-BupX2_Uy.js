import{r,e as z,_ as O,j as e}from"./index-ByJISQQA.js";import{u as f,a as W,g as G}from"./index.esm-DOGlSqOG.js";import{L as H}from"./Loader-D4WHkZ9W.js";import{W as J,c as o}from"./Wrapper-BCCU84lI.js";import{h}from"./HelpCenter.module-CDSZ6uwM.js";import{D as K}from"./DeleteModal-BiL83sQ8.js";import{P as U}from"./react-bootstrap-pagination-control.esm-qM7EkYi3.js";import{u as V}from"./useDeleteApiReq-B07zlnIj.js";import{f as X}from"./index-zP_g29Hf.js";import"./iconBase-DXlUIwUJ.js";import"./useDispatch-C8mZ4_gt.js";import"./logo -C1Nz5jdc.js";const hs=()=>{const{res:u,fetchData:b,isLoading:Y}=V(),{res:d,fetchData:I,isLoading:Z}=f(),{res:n,fetchData:S,isLoading:m}=f(),{res:l,fetchData:N,isLoading:g}=f();r.useState(!1);const[x,j]=r.useState(!1),[_,P]=r.useState(""),[p,v]=r.useState([]),B=z(),[i,A]=r.useState(1),[E,C]=r.useState(0),[a,L]=r.useState({date:"",serviceType:"",raisedBy:"",status:"",searchQuery:""}),[y,$]=r.useState([]);console.log("filter",a);const M=async()=>{I("/admin/get-all-category")};r.useEffect(()=>{M()},[]),r.useEffect(()=>{((d==null?void 0:d.status)===200||(d==null?void 0:d.status)===201)&&(console.log("getCategoriesRes",d),$(d==null?void 0:d.data.data))},[d]);const Q=async s=>{A(s)},c=s=>{const{name:t,value:q}=s.target;L({...a,[t]:q})},D=async()=>{S(`/admin/get-all-tickets?page=${i}&ticketId=${a.searchQuery}`)};r.useEffect(()=>{((n==null?void 0:n.status)===200||(n==null?void 0:n.status)===201)&&(C(n==null?void 0:n.data.totalPages),v(n==null?void 0:n.data.data))},[n]),r.useEffect(()=>{!a.date&&!a.raisedBy&&!a.serviceType&&a.searchQuery&&!a.status?D():F()},[i,a.date,a.raisedBy,a.serviceType,a.searchQuery,a.status]);const F=async()=>{N(`/admin/filter-ticket?date=${a.date}&serviceType=${a.serviceType}&raisedBy=${a.raisedBy}&page=${i}`)};r.useEffect(()=>{((l==null?void 0:l.status)===200||(l==null?void 0:l.status)===201)&&(C(l==null?void 0:l.data.totalPages),v(l==null?void 0:l.data.data))},[l]);const T=s=>{P(s),j(!x)},w=async()=>{b(`/admin/delete-ticket?ticketId=${_}`)};return r.useEffect(()=>{((u==null?void 0:u.status)===200||(u==null?void 0:u.status)===201)&&(O.success("Ticket deleted successfully"),D(),j(!x))},[u]),e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsxs("div",{className:o["report-container"],children:[e.jsxs("div",{className:o["report-header"],children:[e.jsx("h1",{className:o["recent-Articles"],children:"All Tickets"}),e.jsxs("div",{className:o.filter,children:[e.jsx("input",{type:"search",name:"searchQuery",value:a.searchQuery,onChange:c,placeholder:"Search by ticket Id",className:o.filter_input}),e.jsx("input",{type:"date",name:"date",value:a.date,onChange:c,placeholder:"Start Date",className:o.filter_input}),e.jsxs("select",{name:"serviceType",value:a.serviceType,onChange:c,className:o.filter_input,children:[e.jsx("option",{value:"",children:"Select Service Category"}),y==null?void 0:y.map(s=>e.jsx("option",{value:s==null?void 0:s._id,children:s==null?void 0:s.name},s==null?void 0:s._id))]}),e.jsxs("select",{name:"raisedBy",value:a.raisedBy,onChange:c,className:o.filter_input,children:[e.jsx("option",{value:"",children:"Raised by"}),e.jsx("option",{value:"customer",children:"Customer"}),e.jsx("option",{value:"partner",children:"Partner"})]})]})]}),e.jsx("div",{style:{marginTop:"10px"},children:(m||g)&&e.jsx(H,{})}),e.jsxs("div",{className:h.container,children:[!m&&!g&&(p==null?void 0:p.length)===0&&e.jsx("p",{children:"No tickets found"}),p==null?void 0:p.map(s=>{var t;return e.jsxs("div",{className:h.helpCenter,children:[e.jsxs("div",{className:h.helpCenter_left,children:[e.jsx("p",{children:s!=null&&s.status?e.jsxs("div",{children:[e.jsx("b",{children:"Status:"})," ",e.jsx("span",{className:(s==null?void 0:s.status)==="in-review"?h.under_review:h.resolved,children:s==null?void 0:s.status})]}):e.jsx("span",{children:"Status unavailable"})}),e.jsxs("p",{children:[e.jsx("b",{children:"Raised by:"})," ",s==null?void 0:s.raisedBy]}),e.jsxs("p",{children:[e.jsx("b",{children:"Concern:"})," ",s==null?void 0:s.description]}),e.jsxs("p",{children:[e.jsx("b",{children:"Issue Date:"})," ",X(new Date(s==null?void 0:s.createdAt),"dd-MM-yyyy")]}),e.jsxs("p",{children:[e.jsx("b",{children:"Raiser ID :"})," ",(s==null?void 0:s.raisedBy)==="customer"?s==null?void 0:s.userId:s==null?void 0:s.sellerId]}),(s==null?void 0:s.bookingId)&&e.jsxs("p",{children:[e.jsx("b",{children:"Booking ID :"})," ",(t=s==null?void 0:s.bookingId)==null?void 0:t.bookingId]}),e.jsxs("p",{children:[e.jsx("b",{children:"Service ID :"})," ",s==null?void 0:s.serviceId]}),e.jsxs("p",{children:[e.jsx("b",{children:"Ticket type :"})," ",s==null?void 0:s.ticketType]}),e.jsxs("p",{children:[e.jsx("b",{children:"Ticket Id :"})," ",s==null?void 0:s.ticketId]})]}),e.jsxs("div",{className:h.helpCenter_right,children:[e.jsx(W,{onClick:()=>T(s._id),cursor:"pointer",size:22,color:"red"}),e.jsx(G,{onClick:()=>B(`/admin/help-center/tickets/${s._id}`),cursor:"pointer",size:22})]})]},s==null?void 0:s._id)})]}),e.jsx("div",{children:e.jsx(U,{changePage:Q,limit:10,page:i,total:E+"0"})})]})}),x&&e.jsx(K,{handleDelete:w,setState:j})]})};export{hs as default};
