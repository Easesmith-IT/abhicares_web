import{r as f}from"./index-CGylhn6U.js";const G=()=>{const[_,i]=f.useState({geometry:{},formattedAddress:"",city:"",state:"",pincode:""}),[L,A]=f.useState(null),v=async()=>{try{const o=await navigator.permissions.query({name:"geolocation"});A(o.state),await(async()=>{o.state==="granted"?navigator.geolocation.getCurrentPosition(async a=>{const{latitude:t,longitude:r}=a.coords;i(n=>({...n,geometry:{lat:t,lng:r}}));const d=new window.google.maps.LatLng(t,r);new window.google.maps.Geocoder().geocode({location:d},(n,e)=>{if(console.log("results",n),e==="OK"&&n[0]){const l=y(n),g=s(n,"locality"),m=s(n,"administrative_area_level_1"),u=s(n,"postal_code");i(p=>({...p,formattedAddress:l,city:g,state:m,pincode:u}))}else console.error("Error in geocoding:",e)})},a=>{console.error("Error in getting location",a.message)}):(o.state==="prompt"||o.state==="denied")&&(console.error("Geolocation permission denied by the user"),await(async()=>{navigator.geolocation.getCurrentPosition(async t=>{const{latitude:r,longitude:d}=t.coords;i(e=>({...e,geometry:{lat:r,lng:d}}));const w=new window.google.maps.LatLng(r,d);new window.google.maps.Geocoder().geocode({location:w},(e,l)=>{if(console.log("results",e),l==="OK"&&e[0]){const g=y(e),m=s(e,"locality"),u=s(e,"administrative_area_level_1"),p=s(e,"postal_code");i(E=>({...E,formattedAddress:g,city:m,state:u,pincode:p})),console.log("formattedAddress",g),console.log("city",m),console.log("state",u),console.log("pincode",p)}else console.error("Error in geocoding:",l)})},t=>{console.error("Error in getting location",t.message)})})())})()}catch(o){console.error("Error checking geolocation permission:",o)}};f.useEffect(()=>{v()},[]);const s=(o,c)=>{for(const a of o){const t=a.address_components.find(r=>r.types.includes(c));if(t)return t.long_name}return null},y=o=>{for(const c of o)if(c.types.includes("street_address")||c.types.includes("route"))return c.formatted_address;return o[0].formatted_address};return{location:_,status:L}};export{G as u};
