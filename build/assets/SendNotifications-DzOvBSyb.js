import{r,_ as w,j as e}from"./index-A8F5s_OX.js";import{W as D,c as d}from"./Wrapper-Bob4AYsk.js";import{R as E}from"./index.esm-Dl0gbRna.js";/* empty css                   */import{u as L}from"./usePostApiReq-Cj9USDwk.js";import{f as y}from"./index-aMvTzC6n.js";import{u as v}from"./index.esm-MqVG0Kzl.js";import"./logo -C1Nz5jdc.js";import"./iconBase-i28GCwjE.js";const F="_wrapper_h75sc_1",M="_modal_h75sc_27",P="_heading_container_h75sc_47",A="_form_h75sc_59",$="_input_container_h75sc_73",I="_input_h75sc_73",O="_button_wrapper_h75sc_105",k="_button_h75sc_105",W="_image_h75sc_131",s={wrapper:F,modal:M,heading_container:P,form:A,input_container:$,input:I,button_wrapper:O,button:k,image:W},q=({setIsModalOpen:a,getNotifications:h})=>{const{res:l,fetchData:c,isLoading:f}=L(),[t,o]=r.useState({image:"",imagePrev:"",title:"",desc:"",timingType:"",time:"",date:"",appType:"all"}),j=m=>{const n=m.target.files[0];console.log(n);const u=new FileReader;u.readAsDataURL(n),u.addEventListener("load",function(){console.log(this.result),o({...t,image:n,imagePrev:this.result})})},p=m=>{const{name:n,value:u}=m.target;o({...t,[n]:u})};console.log("notificationInfo",t);const _=async m=>{if(m.preventDefault(),!t.title||!t.desc||!t.appType){console.log("error");return}const n=new FormData;n.append("title",t.title),n.append("description",t.desc),n.append("date",t.date),n.append("time",t.time),n.append("image",t.image),n.append("appType",t.appType),c("/admin/send-notification",n)};return r.useEffect(()=>{((l==null?void 0:l.status)===200||(l==null?void 0:l.status)===201)&&(w.success("Notification sent successfully"),h(),a(!1))},[l]),e.jsx("div",{className:s.wrapper,children:e.jsxs("div",{className:s.modal,children:[e.jsxs("div",{className:s.heading_container,children:[e.jsx("h4",{children:"Send Notification"}),e.jsx("div",{className:s.d_flex,children:e.jsx(E,{onClick:()=>a(!1),cursor:"pointer",size:26})})]}),e.jsxs("form",{onSubmit:_,className:s.form,children:[e.jsxs("div",{className:s.imageWrapper,children:[t.imagePrev&&e.jsx("img",{className:s.image,src:t.imagePrev,alt:""}),e.jsx("div",{children:e.jsx("input",{type:"file",name:"image",accept:"image/*",onChange:j})})]}),e.jsxs("div",{className:s.input_container,children:[e.jsx("label",{htmlFor:"title",children:"Title"}),e.jsx("input",{className:s.input,onChange:p,value:t.title,type:"text",name:"title",id:"title"})]}),e.jsxs("div",{className:s.input_container,children:[e.jsx("label",{htmlFor:"desc",children:"Description"}),e.jsx("textarea",{className:s.input,onChange:p,value:t.desc,name:"desc",id:"desc"})]}),e.jsxs("div",{className:s.input_container,children:[e.jsx("label",{htmlFor:"appType",children:"App Type"}),e.jsxs("select",{className:s.input,onChange:p,value:t.appType,name:"appType",id:"appType",children:[e.jsx("option",{value:"mainApp",children:"Main App"}),e.jsx("option",{value:"partnerApp",children:"Partner App"}),e.jsx("option",{value:"all",children:"all"})]})]}),e.jsxs("div",{className:s.input_container,children:[e.jsx("label",{htmlFor:"timing",children:"Timing"}),e.jsxs("select",{className:s.input,onChange:p,value:t.timingType,name:"timingType",id:"timingType",children:[e.jsx("option",{value:"now",children:"Now"}),e.jsx("option",{value:"select",children:"Choose Time"})]}),t.timingType==="select"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px"},children:[e.jsx("input",{className:s.input,onChange:p,value:t.date,type:"date",name:"date",id:"date"}),e.jsx("input",{className:s.input,onChange:p,value:t.time,type:"time",name:"time",id:"time"})]})]}),e.jsx("div",{className:s.button_wrapper,children:e.jsx("button",{className:s.button,children:f?"Sending...":"Send"})})]})]})})},z="_notification_rfkr1_1",B={notification:z},G=({notification:a})=>{const{date:h,time:l}=a.scheduleTiming||{},c=new Date(`2024-01-01T${l}`),f=y(c,"hh:mm:ss a");return console.log(f),e.jsxs("div",{className:B.notification,children:[e.jsx("h4",{children:a==null?void 0:a.title}),e.jsx("p",{children:a==null?void 0:a.description}),e.jsxs("p",{children:[e.jsx("b",{children:"Scheduled time: "})," ",h&&y(new Date(h),"dd/MM/yyyy")," ",f]})]})},R=()=>{const{res:a,fetchData:h,isLoading:l}=v(),{res:c,fetchData:f,isLoading:t}=v(),{res:o,fetchData:j,isLoading:p}=v(),[_,m]=r.useState(!1),[n,u]=r.useState([]);r.useState(null);const[x,T]=r.useState(""),[g,S]=r.useState(""),N=async()=>{h("/admin/get-all-notifications")};r.useEffect(()=>{var i;((a==null?void 0:a.status)===200||(a==null?void 0:a.status)===201)&&u((i=a==null?void 0:a.data)==null?void 0:i.data)},[a]),console.log("searchTerm",x);const b=async()=>{f(`/admin/search-notifications?title=${x}`)};r.useEffect(()=>{var i;((c==null?void 0:c.status)===200||(c==null?void 0:c.status)===201)&&u((i=c==null?void 0:c.data)==null?void 0:i.data)},[c]);const C=async()=>{j(`/admin/filter-notifications?date=${g}`)};return r.useEffect(()=>{var i;((o==null?void 0:o.status)===200||(o==null?void 0:o.status)===201)&&u((i=o==null?void 0:o.data)==null?void 0:i.data)},[o]),r.useEffect(()=>{!x&&N()},[]),r.useEffect(()=>{x&&b()},[x]),r.useEffect(()=>{g&&C()},[g]),e.jsxs(e.Fragment,{children:[e.jsx(D,{children:e.jsxs("div",{className:d["report-container"],children:[e.jsxs("div",{className:d["report-header"],children:[e.jsx("h1",{className:d["recent-Articles"],children:"Notifications"}),e.jsx("input",{onChange:i=>T(i.target.value),className:d.input,type:"text",placeholder:"Search notification",value:x}),e.jsxs("div",{className:d.filterSend,children:[e.jsx("span",{children:"Filter by date"}),e.jsx("input",{onChange:i=>S(i.target.value),className:d.input,style:{width:"200px"},type:"date",value:g})]}),e.jsx("button",{onClick:()=>m(!0),className:d.sendNotificationBtn,children:"Send Notification"})]}),e.jsx("div",{className:d["report-body"],children:l||t||p?e.jsx("div",{children:"Loading notifications..."}):e.jsx("div",{className:d.notifications,children:n.length>0?n.map(i=>e.jsx(G,{notification:i},i._id)):e.jsx("div",{children:"No notifications found"})})})]})}),_&&e.jsx(q,{setIsModalOpen:m,getNotifications:N})]})};export{R as default};
