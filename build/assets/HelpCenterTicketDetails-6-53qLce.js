import{r as t,e as ds,j as s,f as X,_ as as,p as os}from"./index-C00j65eE.js";import{W as is}from"./Wrapper-Bui_DUEg.js";import{T as f}from"./TimeLine-BHQ747b_.js";import{c as o}from"./AddResoulationModal.module-DEfsxiwO.js";import{R as Z}from"./index.esm-dmdmgyGU.js";/* empty css                   */import{u as cs}from"./useAuthorization-BQLez6m4.js";import{p as ls}from"./index-Wjobe2wE.js";import{f as Q}from"./index-CwLm7xHs.js";import{B as ts}from"./Button-DUNLdeQj.js";import"./logo -C1Nz5jdc.js";import"./LogoutModal-BFEBZfWM.js";import"./iconBase-DBedV832.js";import"./index.esm-B5E25rFw.js";const hs=({setIsModalOpen:l,id:n,getTicketDetails:h})=>{(()=>{const c=new Date,r=String(c.getDate()).padStart(2,"0"),p=String(c.getMonth()+1).padStart(2,"0"),g=c.getFullYear();return`${r}/${p}/${g}`})();const[a,e]=t.useState({status:"",resolution:"",ticketId:n,date:""}),{checkAuthorization:j}=cs(),x=c=>{const{name:r,value:p}=c.target;e({...a,[r]:p})};ds();const u=async c=>{if(c.preventDefault(),!(!a.resolution||!a.status))try{const{data:r}=await X.patch("https://abhicares.com/api/admin/update-ticket",{...a},{withCredentials:!0});as.success("Ticket updated successfully"),console.log("dataxghu :",r),h(),l(!1)}catch(r){console.log(r),l(!1),j(r)}};return s.jsx("div",{className:o.wrapper,children:s.jsxs("div",{className:o.modal,children:[s.jsxs("div",{className:o.heading_container,children:[s.jsx("h4",{children:"Add Resoulation"}),s.jsx("div",{className:o.d_flex,children:s.jsx(Z,{onClick:()=>l(!1),cursor:"pointer",size:26})})]}),s.jsxs("form",{onSubmit:u,className:o.form,children:[s.jsxs("div",{className:o.input_container,children:[s.jsx("label",{htmlFor:"status",children:"Status"}),s.jsxs("select",{name:"status",value:a.status,onChange:x,className:o.input,children:[s.jsx("option",{value:"",children:"Select status"}),s.jsx("option",{value:"raised",children:"Raised"}),s.jsx("option",{value:"in-review",children:"In review"}),s.jsx("option",{value:"completed",children:"Completed"})]})]}),s.jsxs("div",{className:o.input_container,children:[s.jsx("label",{htmlFor:"resolution",children:"Resolution"}),s.jsx("input",{className:o.input,onChange:x,value:a.resolution,type:"text",name:"resolution",id:"resolution"})]}),s.jsxs("div",{className:o.input_container,children:[s.jsx("label",{htmlFor:"date",children:"Date"}),s.jsx("input",{className:o.input,onChange:x,value:a.date,type:"date",name:"date",id:"date"})]}),s.jsx("div",{className:o.button_wrapper,children:s.jsx("button",{onClick:u,className:o.button,children:"Resolve"})})]})]})})},ms="_wrapper_qpe1i_1",ps="_modal_qpe1i_27",xs="_heading_container_qpe1i_47",us="_service_qpe1i_59",js="_icon_qpe1i_67",gs="_d_flex_qpe1i_79",_s="_features_qpe1i_93",fs="_feature_qpe1i_93",vs="_feature_wrapper_qpe1i_137",bs="_feature_img_qpe1i_151",Ns="_feature_content_qpe1i_175",Is="_icons_cotainer_qpe1i_185",i={wrapper:ms,modal:ps,heading_container:xs,service:us,icon:js,d_flex:gs,features:_s,feature:fs,feature_wrapper:vs,feature_img:bs,feature_content:Ns,icons_cotainer:Is},ys=({setIsModalOpen:l,service:n})=>{var h;return s.jsx("div",{className:i.wrapper,children:s.jsxs("div",{className:i.modal,children:[s.jsxs("div",{className:i.heading_container,children:[s.jsx("h4",{children:"Service Details"}),s.jsx("div",{className:i.d_flex,children:s.jsx(Z,{onClick:()=>l(!1),cursor:"pointer",size:26})})]}),s.jsxs("div",{className:i.service,children:[s.jsxs("div",{className:i.d_flex,children:[s.jsx("div",{children:s.jsx("img",{className:i.icon,src:`https://storage.googleapis.com/abhicares-backend-bucket/${n.imageUrl}`,alt:"icon"})}),s.jsxs("div",{children:[s.jsx("h4",{children:n==null?void 0:n.name}),s.jsx("div",{children:s.jsxs("p",{children:["Starting Price: â‚¹",n==null?void 0:n.startingPrice]})}),s.jsx("p",{children:(n==null?void 0:n.description)&&ls(n==null?void 0:n.description)})]})]}),s.jsx("h5",{children:"Features"}),s.jsx("div",{className:i.features,children:(h=n==null?void 0:n.features)==null?void 0:h.map((d,a)=>s.jsx("div",{className:i.feature,children:s.jsxs("div",{className:i.feature_wrapper,children:[s.jsx("div",{className:i.feature_img,children:s.jsx("img",{src:`https://storage.googleapis.com/abhicares-backend-bucket/${d==null?void 0:d.image}`,alt:"feature"})}),s.jsxs("div",{className:i.feature_content,children:[s.jsx("h5",{children:d==null?void 0:d.title}),s.jsx("p",{children:d==null?void 0:d.description})]})]})}))}),(n==null?void 0:n.features.length)===0&&s.jsx("p",{children:"No features found"})]})]})})},zs=()=>{var v,b,N,I,y,w,S,C,$,R,T,q,A,M,P,B,F,L,O,z,H,E,U,V,W,Y,G,J;t.useState("in-progress");const[l,n]=t.useState(!1),[h,d]=t.useState(!1),a=os(),[e,j]=t.useState(""),[x,u]=t.useState(!0),c=async()=>{try{const{data:m}=await X.get(`https://abhicares.com/api/admin/get-single-ticket?ticketId=${a==null?void 0:a.ticketId}`,{withCredentials:!0});console.log("details of ticket",m),j(m.ticket)}catch(m){console.log(m)}finally{u(!1)}};t.useEffect(()=>{c()},[]);const r=m=>{var K;return(K=e==null?void 0:e.ticketHistory)==null?void 0:K.find(_=>(_==null?void 0:_.status)===m)},{addressLine:p,city:g,pincode:k,landmark:D}=((v=e==null?void 0:e.bookingId)==null?void 0:v.userAddress)||{},{addressLine:ss,city:es,pincode:ns,state:rs}=((b=e==null?void 0:e.sellerId)==null?void 0:b.address)||{};return s.jsxs(is,{children:[s.jsxs("div",{className:"container",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"card left",children:[s.jsxs("div",{className:"header",children:[s.jsxs("div",{children:[s.jsx("h3",{children:"Update status"}),(e==null?void 0:e.status)!=="completed"&&s.jsx("button",{onClick:n,className:"button",children:"Update"}),l&&s.jsx(hs,{setIsModalOpen:n,getTicketDetails:c,id:a.ticketId})]}),s.jsx("p",{children:(e==null?void 0:e.createdAt)&&Q(new Date(e==null?void 0:e.createdAt),"dd MMMM, yyyy HH:mm:ss")})]}),s.jsxs("div",{className:"content",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Raised Id:"})," ",(e==null?void 0:e.raisedBy)==="customer"?(N=e==null?void 0:e.userId)==null?void 0:N._id:(I=e==null?void 0:e.sellerId)==null?void 0:I._id]}),s.jsx("div",{className:"raisedby",children:s.jsxs("p",{children:[s.jsx("strong",{children:"Raised by:"})," ",(e==null?void 0:e.raisedBy)==="customer"?(y=e==null?void 0:e.userId)==null?void 0:y.name:(w=e==null?void 0:e.sellerId)==null?void 0:w.name,s.jsx("br",{}),(S=e==null?void 0:e.userId)==null?void 0:S.phone]})}),s.jsxs("p",{children:[s.jsx("strong",{children:"Concern (description):"})," ",e==null?void 0:e.description]})]})]}),s.jsxs("div",{className:"section card left-card",children:[s.jsx("h4",{children:"Customer Details"}),s.jsxs("div",{children:[s.jsx("b",{children:"Customer Name: "}),(C=e==null?void 0:e.userId)==null?void 0:C.name]}),s.jsxs("div",{children:[s.jsx("b",{children:"Customer Phone Number:"}),($=e==null?void 0:e.userId)==null?void 0:$.phone]}),s.jsxs("div",{children:[s.jsx("b",{children:"Address: "}),`${p}, ${D}, ${g}, ${k}`]})]}),(e==null?void 0:e.sellerId)&&s.jsxs("div",{className:"section card left-card",children:[s.jsx("h4",{children:"Service Provider Details"}),s.jsxs("div",{children:[s.jsx("b",{children:"Service Provider Name: "}),(R=e==null?void 0:e.sellerId)==null?void 0:R.name]}),s.jsxs("div",{children:[s.jsx("b",{children:"Phone Number:"}),(T=e==null?void 0:e.sellerId)==null?void 0:T.phone]}),s.jsxs("div",{children:[s.jsx("b",{children:"Address: "}),`${ss}, ${es}, ${rs}, ${ns}`]})]})]}),s.jsxs("div",{className:"right",children:[s.jsxs("div",{className:"section card",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Booking Id:"})," ",(q=e==null?void 0:e.bookingId)==null?void 0:q.bookingId]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Service Booked:"}),(A=e==null?void 0:e.serviceId)==null?void 0:A.name," ",s.jsx(ts,{onClick:()=>d(!0),children:"View"})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Time: "}),((M=e==null?void 0:e.bookingId)==null?void 0:M.bookingTime)&&Q(new Date((P=e==null?void 0:e.bookingId)==null?void 0:P.bookingTime),"hh:mm aa")]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Address: "}),(B=e==null?void 0:e.bookingId)==null?void 0:B.userAddress.addressLine]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Cost:"})," Rs",(F=e==null?void 0:e.bookingId)==null?void 0:F.orderValue]})]}),s.jsxs("div",{className:"section card card2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Booking Id: "}),(L=e==null?void 0:e.bookingId)==null?void 0:L.bookingId]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Service Id: "}),(O=e==null?void 0:e.serviceId)==null?void 0:O._id]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Ticket Type: "}),e==null?void 0:e.ticketType," "]}),s.jsxs("div",{style:{marginTop:"20px",display:"flex",flexDirection:"column",gap:"20px"},children:[s.jsx(f,{title:"Raised",time:r("raised")?(z=r("raised"))==null?void 0:z.date:"",status:((H=r("raised"))==null?void 0:H.status)||"",className:r("raised")?"bg-green":"bg-gray",desc:((E=r("raised"))==null?void 0:E.resolution)||""}),s.jsx(f,{title:"In Progress",time:r("in-review")?(U=r("in-review"))==null?void 0:U.date:"",status:((V=r("in-review"))==null?void 0:V.status)||"",className:r("in-review")?"bg-green":"bg-gray",desc:((W=r("in-review"))==null?void 0:W.resolution)||""}),s.jsx(f,{title:"Completed",time:r("completed")?(Y=r("completed"))==null?void 0:Y.date:"",status:((G=r("completed"))==null?void 0:G.status)||"",className:r("completed")?"bg-green":"bg-gray",desc:((J=r("completed"))==null?void 0:J.resolution)||""})]})]})]})]}),h&&s.jsx(ys,{setIsModalOpen:d,service:e==null?void 0:e.serviceId})]})};export{zs as default};
