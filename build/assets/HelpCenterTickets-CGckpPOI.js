import{r,e as A,f as c,j as s,_ as M}from"./index-lY8eDmQj.js";import{a as E,h as z}from"./LogoutModal-CpkpXklC.js";import{W as F,c as l}from"./Wrapper-C5Vyjcs6.js";import{h as o}from"./HelpCenter.module-CDSZ6uwM.js";import{L}from"./Loader-D1crzail.js";import{D as R}from"./DeleteModal-CI6_ta-U.js";import{P as O}from"./react-bootstrap-pagination-control.esm-Cul1rgAV.js";import{u as W}from"./useAuthorization-ZL8Fu2nK.js";import{f as H}from"./index-3HMGIBDb.js";import"./iconBase-BlupGJxB.js";import"./logo -C1Nz5jdc.js";const ee=()=>{r.useState(!1);const[h,d]=r.useState(!1),[f,v]=r.useState(""),[n,g]=r.useState([]),[x,j]=r.useState(!0),C=A(),{checkAuthorization:b}=W(),[t,S]=r.useState(1),[N,m]=r.useState(0),[a,T]=r.useState({date:"",serviceType:"",raisedBy:"",status:""}),[p,D]=r.useState([]);console.log("filter",a);const _=async()=>{try{const{data:e}=await c.get("https://abhicares.com/api/admin/get-all-category",{withCredentials:!0});D(e.data),console.log("allCategories",e)}catch(e){console.log(e)}};r.useEffect(()=>{_()},[]);const w=async e=>{S(e)},u=e=>{const{name:i,value:B}=e.target;T({...a,[i]:B})},y=async()=>{try{const{data:e}=await c.get(`https://abhicares.com/api/admin/get-all-tickets?page=${t}`,{withCredentials:!0});console.log("tickets",e),m(e.totalPages),g(e.data)}catch(e){console.log(e)}finally{j(!1)}};r.useEffect(()=>{!a.date&&!a.raisedBy&&!a.serviceType&&!a.status?y():I()},[t,a.date,a.raisedBy,a.serviceType,a.status]);const I=async()=>{try{const{data:e}=await c.get(`https://abhicares.com/api/admin/filter-ticket?date=${a.date}&serviceType=${a.serviceType}&raisedBy=${a.raisedBy}&page=${t}`,{withCredentials:!0});console.log("filter tickets",e),m(e.totalPages),g(e.data)}catch(e){console.log(e)}finally{j(!1)}},P=e=>{v(e),d(!h)},$=async()=>{try{const{data:e}=await c.delete(`https://abhicares.com/api/admin/delete-ticket?ticketId=${f}`,{withCredentials:!0});M.success("Ticket deleted successfully"),y(),d(!h)}catch(e){console.log(e),d(!1),b(e)}};return s.jsxs(s.Fragment,{children:[s.jsx(F,{children:s.jsxs("div",{className:l["report-container"],children:[s.jsxs("div",{className:l["report-header"],children:[s.jsx("h1",{className:l["recent-Articles"],children:"All Tickets"}),s.jsxs("div",{className:l.filter,children:[s.jsx("input",{type:"date",name:"date",value:a.date,onChange:u,placeholder:"Start Date",className:l.filter_input}),s.jsxs("select",{name:"serviceType",value:a.serviceType,onChange:u,className:l.filter_input,children:[s.jsx("option",{value:"",children:"Select Service Category"}),p==null?void 0:p.map(e=>s.jsx("option",{value:e==null?void 0:e._id,children:e==null?void 0:e.name},e==null?void 0:e._id))]}),s.jsxs("select",{name:"raisedBy",value:a.raisedBy,onChange:u,className:l.filter_input,children:[s.jsx("option",{value:"",children:"Raised by"}),s.jsx("option",{value:"customer",children:"Customer"}),s.jsx("option",{value:"partner",children:"Partner"})]})]})]}),s.jsxs("div",{className:o.container,children:[!x&&(n==null?void 0:n.length)===0&&s.jsx("p",{children:"No tickets found"}),x&&(n==null?void 0:n.length)===0&&s.jsx(L,{}),n==null?void 0:n.map(e=>{var i;return s.jsxs("div",{className:o.helpCenter,children:[s.jsxs("div",{className:o.helpCenter_left,children:[s.jsx("p",{children:e!=null&&e.status?s.jsxs("div",{children:[s.jsx("b",{children:"Status:"})," ",s.jsx("span",{className:(e==null?void 0:e.status)==="in-review"?o.under_review:o.resolved,children:e==null?void 0:e.status})]}):s.jsx("span",{children:"Status unavailable"})}),s.jsxs("p",{children:[s.jsx("b",{children:"Raised by:"})," ",e==null?void 0:e.raisedBy]}),s.jsxs("p",{children:[s.jsx("b",{children:"Concern:"})," ",e==null?void 0:e.description]}),s.jsxs("p",{children:[s.jsx("b",{children:"Issue Date:"})," ",H(new Date(e==null?void 0:e.createdAt),"dd-MM-yyyy")]}),s.jsxs("p",{children:[s.jsx("b",{children:"Raiser ID :"})," ",(e==null?void 0:e.raisedBy)==="customer"?e==null?void 0:e.userId:e==null?void 0:e.sellerId]}),(e==null?void 0:e.bookingId)&&s.jsxs("p",{children:[s.jsx("b",{children:"Booking ID :"})," ",(i=e==null?void 0:e.bookingId)==null?void 0:i.bookingId]}),s.jsxs("p",{children:[s.jsx("b",{children:"Service ID :"})," ",e==null?void 0:e.serviceId]}),s.jsxs("p",{children:[s.jsx("b",{children:"Ticket type :"})," ",e==null?void 0:e.ticketType]})]}),s.jsxs("div",{className:o.helpCenter_right,children:[s.jsx(E,{onClick:()=>P(e._id),cursor:"pointer",size:22,color:"red"}),s.jsx(z,{onClick:()=>C(`/admin/help-center/tickets/${e._id}`),cursor:"pointer",size:22})]})]},e==null?void 0:e._id)})]}),s.jsx("div",{children:s.jsx(O,{changePage:w,limit:10,page:t,total:N+"0"})})]})}),h&&s.jsx(R,{handleDelete:$,setState:d})]})};export{ee as default};
