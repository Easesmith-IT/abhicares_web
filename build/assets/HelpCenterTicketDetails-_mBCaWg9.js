import{r as h,e as os,_ as as,j as s,u as is}from"./index-CGylhn6U.js";import{W as cs}from"./Wrapper-CdkfNuyb.js";import{T as f}from"./TimeLine-D4k9dyfD.js";import{c as a}from"./AddResoulationModal.module-DEfsxiwO.js";import{R as Z}from"./index.esm-C03Euai7.js";/* empty css                   */import{u as ls}from"./useAuthorization-C2vLYWOS.js";import{u as ts}from"./usePatchApiReq-CoISmjAR.js";import{p as hs}from"./index-Bz3gEjcd.js";import{u as ms}from"./index.esm-BJ_kW8OL.js";import{f as X}from"./index-DMx44xLR.js";import{B as ps}from"./Button-BQpLpF18.js";import"./logo -C1Nz5jdc.js";import"./useDispatch-Dqrl4_SR.js";import"./iconBase-BOE9-_A9.js";import"./index.esm-BCgy5go5.js";const xs=({setIsModalOpen:d,id:n,getTicketDetails:p})=>{(()=>{const t=new Date,r=String(t.getDate()).padStart(2,"0"),x=String(t.getMonth()+1).padStart(2,"0"),g=t.getFullYear();return`${r}/${x}/${g}`})();const[l,j]=h.useState({status:"",resolution:"",ticketId:n,date:""});ls();const m=t=>{const{name:r,value:x}=t.target;j({...l,[r]:x})};os();const{res:o,fetchData:e}=ts(),u=async t=>{t.preventDefault(),!(!l.resolution||!l.status)&&await e("/admin/update-ticket",{...l})};return h.useEffect(()=>{((o==null?void 0:o.status)===200||(o==null?void 0:o.status)===201)&&(console.log("addResoulationRes",o),as.success("Ticket updated successfully"),p(),d(!1))},[o]),s.jsx("div",{className:a.wrapper,children:s.jsxs("div",{className:a.modal,children:[s.jsxs("div",{className:a.heading_container,children:[s.jsx("h4",{children:"Add Resoulation"}),s.jsx("div",{className:a.d_flex,children:s.jsx(Z,{onClick:()=>d(!1),cursor:"pointer",size:26})})]}),s.jsxs("form",{onSubmit:u,className:a.form,children:[s.jsxs("div",{className:a.input_container,children:[s.jsx("label",{htmlFor:"status",children:"Status"}),s.jsxs("select",{name:"status",value:l.status,onChange:m,className:a.input,children:[s.jsx("option",{value:"",children:"Select status"}),s.jsx("option",{value:"raised",children:"Raised"}),s.jsx("option",{value:"in-review",children:"In review"}),s.jsx("option",{value:"completed",children:"Completed"})]})]}),s.jsxs("div",{className:a.input_container,children:[s.jsx("label",{htmlFor:"resolution",children:"Resolution"}),s.jsx("input",{className:a.input,onChange:m,value:l.resolution,type:"text",name:"resolution",id:"resolution"})]}),s.jsxs("div",{className:a.input_container,children:[s.jsx("label",{htmlFor:"date",children:"Date"}),s.jsx("input",{className:a.input,onChange:m,value:l.date,type:"date",name:"date",id:"date"})]}),s.jsx("div",{className:a.button_wrapper,children:s.jsx("button",{onClick:u,className:a.button,children:"Resolve"})})]})]})})},us="_wrapper_qpe1i_1",js="_modal_qpe1i_27",gs="_heading_container_qpe1i_47",_s="_service_qpe1i_59",fs="_icon_qpe1i_67",vs="_d_flex_qpe1i_79",Ns="_features_qpe1i_93",bs="_feature_qpe1i_93",Is="_feature_wrapper_qpe1i_137",ys="_feature_img_qpe1i_151",ws="_feature_content_qpe1i_175",Ss="_icons_cotainer_qpe1i_185",c={wrapper:us,modal:js,heading_container:gs,service:_s,icon:fs,d_flex:vs,features:Ns,feature:bs,feature_wrapper:Is,feature_img:ys,feature_content:ws,icons_cotainer:Ss},Cs=({setIsModalOpen:d,service:n})=>{var p;return s.jsx("div",{className:c.wrapper,children:s.jsxs("div",{className:c.modal,children:[s.jsxs("div",{className:c.heading_container,children:[s.jsx("h4",{children:"Service Details"}),s.jsx("div",{className:c.d_flex,children:s.jsx(Z,{onClick:()=>d(!1),cursor:"pointer",size:26})})]}),s.jsxs("div",{className:c.service,children:[s.jsxs("div",{className:c.d_flex,children:[s.jsx("div",{children:s.jsx("img",{className:c.icon,src:`https://storage.googleapis.com/abhicares-backend-bucket/${n.imageUrl}`,alt:"icon"})}),s.jsxs("div",{children:[s.jsx("h4",{children:n==null?void 0:n.name}),s.jsx("div",{children:s.jsxs("p",{children:["Starting Price: â‚¹",n==null?void 0:n.startingPrice]})}),s.jsx("p",{children:(n==null?void 0:n.description)&&hs(n==null?void 0:n.description)})]})]}),s.jsx("h5",{children:"Features"}),s.jsx("div",{className:c.features,children:(p=n==null?void 0:n.features)==null?void 0:p.map((i,l)=>s.jsx("div",{className:c.feature,children:s.jsxs("div",{className:c.feature_wrapper,children:[s.jsx("div",{className:c.feature_img,children:s.jsx("img",{src:`https://storage.googleapis.com/abhicares-backend-bucket/${i==null?void 0:i.image}`,alt:"feature"})}),s.jsxs("div",{className:c.feature_content,children:[s.jsx("h5",{children:i==null?void 0:i.title}),s.jsx("p",{children:i==null?void 0:i.description})]})]})}))}),(n==null?void 0:n.features.length)===0&&s.jsx("p",{children:"No features found"})]})]})})},Ws=()=>{var v,N,b,I,y,w,S,C,$,q,A,M,T,P,F,B,R,L,O,E,H,z,U,V,W,G,Y,J,K;const{res:d,fetchData:n,isLoading:p}=ms(),[i,l]=h.useState(!1),[j,m]=h.useState(!1),o=is(),[e,u]=h.useState(""),t=async()=>{n(`/admin/get-single-ticket?ticketId=${o==null?void 0:o.ticketId}`)};h.useEffect(()=>{t()},[]),h.useEffect(()=>{((d==null?void 0:d.status)===200||(d==null?void 0:d.status)===201)&&u(d==null?void 0:d.data.ticket)},[d]);const r=ds=>{var Q;return(Q=e==null?void 0:e.ticketHistory)==null?void 0:Q.find(_=>(_==null?void 0:_.status)===ds)},{addressLine:x,city:g,pincode:k,landmark:D}=((v=e==null?void 0:e.bookingId)==null?void 0:v.userAddress)||{},{addressLine:ss,city:es,pincode:ns,state:rs}=((N=e==null?void 0:e.sellerId)==null?void 0:N.address)||{};return s.jsxs(cs,{children:[s.jsxs("div",{className:"container",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"card left",children:[s.jsxs("div",{className:"header",children:[s.jsxs("div",{children:[s.jsx("h3",{children:"Update status"}),(e==null?void 0:e.status)!=="completed"&&s.jsx("button",{onClick:l,className:"button",children:"Update"}),i&&s.jsx(xs,{setIsModalOpen:l,getTicketDetails:t,id:o.ticketId})]}),s.jsxs("div",{children:[s.jsx("p",{children:e==null?void 0:e.ticketId}),s.jsx("p",{children:(e==null?void 0:e.createdAt)&&X(new Date(e==null?void 0:e.createdAt),"dd MMMM, yyyy HH:mm:ss")})]})]}),s.jsxs("div",{className:"content",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Raised Id:"})," ",(e==null?void 0:e.raisedBy)==="customer"?(b=e==null?void 0:e.userId)==null?void 0:b._id:(I=e==null?void 0:e.sellerId)==null?void 0:I._id]}),s.jsx("div",{className:"raisedby",children:s.jsxs("p",{children:[s.jsx("strong",{children:"Raised by:"})," ",(e==null?void 0:e.raisedBy)==="customer"?(y=e==null?void 0:e.userId)==null?void 0:y.name:(w=e==null?void 0:e.sellerId)==null?void 0:w.name,s.jsx("br",{}),(S=e==null?void 0:e.userId)==null?void 0:S.phone]})}),s.jsxs("p",{children:[s.jsx("strong",{children:"Concern (description):"})," ",e==null?void 0:e.description]})]})]}),s.jsxs("div",{className:"section card left-card",children:[s.jsx("h4",{children:"Customer Details"}),s.jsxs("div",{children:[s.jsx("b",{children:"Customer Name: "}),(C=e==null?void 0:e.userId)==null?void 0:C.name]}),s.jsxs("div",{children:[s.jsx("b",{children:"Customer Phone Number:"}),($=e==null?void 0:e.userId)==null?void 0:$.phone]}),s.jsxs("div",{children:[s.jsx("b",{children:"Address: "}),`${x}, ${D}, ${g}, ${k}`]})]}),(e==null?void 0:e.sellerId)&&s.jsxs("div",{className:"section card left-card",children:[s.jsx("h4",{children:"Service Provider Details"}),s.jsxs("div",{children:[s.jsx("b",{children:"Service Provider Name: "}),(q=e==null?void 0:e.sellerId)==null?void 0:q.name]}),s.jsxs("div",{children:[s.jsx("b",{children:"Phone Number:"}),(A=e==null?void 0:e.sellerId)==null?void 0:A.phone]}),s.jsxs("div",{children:[s.jsx("b",{children:"Address: "}),`${ss}, ${es}, ${rs}, ${ns}`]})]})]}),s.jsxs("div",{className:"right",children:[s.jsxs("div",{className:"section card",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Booking Id:"})," ",(M=e==null?void 0:e.bookingId)==null?void 0:M.bookingId]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Service Booked:"}),s.jsxs("p",{children:[(T=e==null?void 0:e.serviceId)==null?void 0:T.name," ",(P=e==null?void 0:e.serviceId)!=null&&P.name?s.jsx(ps,{onClick:()=>m(!0),children:"View"}):"No service booked"]})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Time: "}),((F=e==null?void 0:e.bookingId)==null?void 0:F.bookingTime)&&X(new Date((B=e==null?void 0:e.bookingId)==null?void 0:B.bookingTime),"hh:mm aa")]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Address: "}),(R=e==null?void 0:e.bookingId)==null?void 0:R.userAddress.addressLine]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Cost:"})," Rs",(L=e==null?void 0:e.bookingId)==null?void 0:L.orderValue]})]}),s.jsxs("div",{className:"section card card2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Booking Id: "}),(O=e==null?void 0:e.bookingId)==null?void 0:O.bookingId]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Service Id: "}),(E=e==null?void 0:e.serviceId)==null?void 0:E._id]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Ticket Type: "}),e==null?void 0:e.ticketType," "]}),s.jsxs("div",{style:{marginTop:"20px",display:"flex",flexDirection:"column",gap:"20px"},children:[s.jsx(f,{title:"Raised",time:r("raised")?(H=r("raised"))==null?void 0:H.date:"",status:((z=r("raised"))==null?void 0:z.status)||"",className:r("raised")?"bg-green":"bg-gray",desc:((U=r("raised"))==null?void 0:U.resolution)||""}),s.jsx(f,{title:"In Progress",time:r("in-review")?(V=r("in-review"))==null?void 0:V.date:"",status:((W=r("in-review"))==null?void 0:W.status)||"",className:r("in-review")?"bg-green":"bg-gray",desc:((G=r("in-review"))==null?void 0:G.resolution)||""}),s.jsx(f,{title:"Completed",time:r("completed")?(Y=r("completed"))==null?void 0:Y.date:"",status:((J=r("completed"))==null?void 0:J.status)||"",className:r("completed")?"bg-green":"bg-gray",desc:((K=r("completed"))==null?void 0:K.resolution)||""})]})]})]})]}),j&&s.jsx(Cs,{setIsModalOpen:m,service:e==null?void 0:e.serviceId})]})};export{Ws as default};
