import{d as A,j as e,r as p,e as g,_ as v}from"./index-DpM_z6IC.js";import{A as N,m as S}from"./LogoutModal-rCWBQ8ER.js";import{u as C}from"./usegelocation-Rx6cwE4V.js";const z="_modal_overlay_1ceo1_1",E="_modal_open_1ceo1_21",B="_modal_close_1ceo1_33",G="_modal_wrapper_1ceo1_41",U="_modal_1ceo1_1",W="_p_1ceo1_103",Y="_mt_1ceo1_113",M="_input_box_1ceo1_121",K="_defaultAddress_1ceo1_137",O="_input_1ceo1_121",P="_button_1ceo1_165",T="_radio_wrapper_1ceo1_189",Z="_radio_1ceo1_189",s={modal_overlay:z,modal_open:E,modal_close:B,modal_wrapper:G,modal:U,p:W,mt:Y,input_box:M,defaultAddress:K,input:O,button:P,radio_wrapper:T,radio:Z},q=({isOpen:u,closeCurrentLocationAddModal:d,setAddressInfo:r})=>{const{location:o}=C(),n=()=>{r(l=>({...l,addressLine:o.formattedAddress,pincode:o.pincode,city:o.city})),d(!1)};return e.jsx("div",{className:`${s.modal_overlay} ${u?s.modal_open:s.modal_close}`,children:e.jsxs("div",{className:s.modal_wrapper,children:[e.jsx("button",{onClick:d,className:s.modal_close,children:e.jsx(N,{size:20})}),e.jsxs("div",{className:s.modal,children:[o&&e.jsx("p",{children:o.formattedAddress}),e.jsx("button",{type:"submit",className:s.button,onClick:n,children:"Confirm Address"})]})]})})},R=A.GoogleApiWrapper({apiKey:"AIzaSyB_ZhYrt0hw7zB74UYGhh4Wt_IkltFzo-I"})(q),H=({isOpen:u,setIsAddAddressModalOpen:d,getAllAddress:r,Data:o=""})=>{const{location:n,status:l}=C();console.log("status",l),console.log("location",n);const[L,x]=p.useState(!1),[k,j]=p.useState(!1),[a,y]=p.useState({addressLine:o.addressLine||"",pincode:o.pincode||"",landmark:o.landmark,defaultAddress:o.defaultAddress||!1,city:o.city||""}),[f,_]=p.useState(""),c=h=>{const{name:i,value:m}=h.target;y({...a,[i]:m})},w=async h=>{var i,m;if(h.preventDefault(),!a.addressLine||!a.pincode||!a.city||!a.landmark){_("All fields are required.");return}if(_(""),o)try{const{data:t}=await g.patch(`https://abhicares.com/api/shopping/update-user-address/${o._id}`,{...a},{withCredentials:!0});v.success("Address updated successfully"),r(),d(!1),console.log(t)}catch(t){console.log(t)}else try{const t={coordinates:[n.geometry.lat,n.geometry.lng]},b={...a,location:t,city:n.city};console.log("body",b);const{data:I}=await g.post("https://abhicares.com/api/shopping/create-user-address",{...b},{withCredentials:!0});v.success("Address created successfully"),r(),d(!1),console.log(I)}catch(t){_((m=(i=t==null?void 0:t.response)==null?void 0:i.data)==null?void 0:m.message),console.log(t)}},$=()=>{l!=="granted"?(console.log("inside if"),j(!0)):(console.log("inside else"),x(!0),j(!1))},F=()=>{x(!1)};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`${s.modal_overlay} ${u?s.modal_open:s.modal_close}`,children:e.jsxs("div",{className:s.modal_wrapper,children:[e.jsx("button",{onClick:()=>d(!1),className:s.modal_close,children:e.jsx(N,{size:20})}),e.jsx("div",{className:s.modal,children:e.jsxs("form",{onSubmit:w,children:[e.jsxs("p",{className:s.p,children:[o?"Update":"Add"," address"]}),e.jsxs("div",{className:s.mt,children:[e.jsx("label",{htmlFor:"addressLine",children:"Address Line"}),e.jsx("div",{className:s.input_box,children:e.jsx("input",{className:s.input,onChange:c,value:a.addressLine,type:"text",name:"addressLine",id:"addressLine",placeholder:"Enter address line"})})]}),e.jsxs("div",{className:s.mt,children:[e.jsx("label",{htmlFor:"city",children:"City"}),e.jsx("div",{className:s.input_box,children:e.jsx("input",{className:s.input,onChange:c,value:a.city,type:"text",name:"city",id:"city",placeholder:"Enter city"})})]}),e.jsxs("div",{className:s.mt,children:[e.jsx("label",{htmlFor:"pincode",children:"Pincode"}),e.jsx("div",{className:s.input_box,children:e.jsx("input",{className:s.input,onChange:c,value:a.pincode,type:"number",name:"pincode",id:"pincode",placeholder:"Enter pincode"})})]}),e.jsxs("div",{className:s.mt,children:[e.jsx("label",{htmlFor:"landmark",children:"Landmark"}),e.jsx("div",{className:s.input_box,children:e.jsx("input",{className:s.input,onChange:c,value:a.landmark,type:"text",name:"landmark",id:"landmark",placeholder:"Enter landmark"})})]}),e.jsxs("div",{className:s.mt,children:[e.jsx("label",{htmlFor:"defaultAddress",children:"Default Address"}),e.jsxs("select",{className:`${s.input_box} ${s.defaultAddress}`,onChange:c,value:a.defaultAddress,name:"defaultAddress",id:"defaultAddress",children:[e.jsx("option",{value:"true",children:"True"}),e.jsx("option",{value:"false",children:"False"})]})]}),e.jsxs("button",{type:"button",className:s.button,onClick:$,disabled:k,style:{color:l!=="granted"?"grey":"black"},children:[e.jsx(S,{}),l==="granted"?"Use Current Location":"Location Disabled"]}),f&&e.jsxs("p",{style:{color:"red",marginTop:"10px"},children:["*",f]}),e.jsx("button",{type:"submit",className:s.button,children:o?"Update":"Proceed"})]})})]})}),e.jsx(R,{isOpen:L,closeCurrentLocationAddModal:F,setAddressInfo:y})]})},X=A.GoogleApiWrapper({apiKey:"AIzaSyB_ZhYrt0hw7zB74UYGhh4Wt_IkltFzo-I"})(H);export{X as A};
