import{r as o,e as I,j as t}from"./index-B-IXA8Ie.js";import{W as M,c as s}from"./Wrapper-MkLY3g7U.js";import{u as h,h as F}from"./index.esm-BbyRK8SJ.js";import{L as O}from"./Loader-BC-JdY3x.js";import{P as V}from"./react-bootstrap-pagination-control.esm-BkNEHDtK.js";import{f as u}from"./index--LFhlb37.js";import"./logo -C1Nz5jdc.js";import"./useDispatch-C5OFXrAN.js";import"./iconBase-3hUsnpgH.js";const K=()=>{const{res:e,fetchData:b,isLoading:x}=h(),{res:l,fetchData:$,isLoading:m}=h(),{res:i,fetchData:C,isLoading:g}=h(),[d,r]=o.useState([]),[n,j]=o.useState({date:"",status:""}),[D,y]=o.useState(1),[p,k]=o.useState(1),w=async a=>{k(a)};console.log("filters",n);const f=a=>{const{name:c,value:E}=a.target;j({...n,[c]:E})},A=I(),v=o.useRef(),N=async()=>{b(`/admin/get-booking-list?page=${p}`)};o.useEffect(()=>{var a,c;((e==null?void 0:e.status)===200||(e==null?void 0:e.status)===201)&&(console.log("getBookingListRes",e),r(e==null?void 0:e.data.data),y((c=(a=e==null?void 0:e.data)==null?void 0:a.pagination)==null?void 0:c.totalPages))},[e]);const P=async()=>{$(`/admin/search-filter-bookings?status=${n.status}&bookingDate=${n.date}&page=${p}`)};o.useEffect(()=>{var a,c;((l==null?void 0:l.status)===200||(l==null?void 0:l.status)===201)&&(y((c=(a=l==null?void 0:l.data)==null?void 0:a.pagination)==null?void 0:c.totalPages),r(l==null?void 0:l.data.data))},[l]),o.useEffect(()=>{n.date||n.status?P():N()},[n.date,n.status,p]);const S=async()=>{const a=v.current.value;if(!a){N();return}C(`/admin/get-booking-by-id?bookingId=${a}`)};return o.useEffect(()=>{((i==null?void 0:i.status)===200||(i==null?void 0:i.status)===201)&&r(i==null?void 0:i.data.data)},[i]),t.jsx(t.Fragment,{children:t.jsx(M,{children:t.jsxs("div",{className:s["report-container"],children:[t.jsxs("div",{className:s["report-header"],children:[t.jsx("h1",{className:s["recent-Articles"],children:"Bookings"}),t.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"center"},children:[t.jsxs("div",{className:"d-flex",style:{position:"relative"},children:[t.jsx("input",{ref:v,style:{width:"300px",padding:"5px 10px",borderRadius:"5px"},type:"text",placeholder:"search booking by id"}),t.jsx(F,{onClick:S,style:{position:"absolute",right:"8px",top:"10px",cursor:"pointer"}})]}),t.jsx("input",{type:"date",name:"date",value:n.date,onChange:f,className:s.filter_input}),t.jsx("button",{onClick:()=>j({...n,date:u(new Date,"yyyy-MM-dd")}),style:{background:"black",color:"white",padding:"5px 20px",borderRadius:"6px"},children:"Todays Bookings"}),t.jsxs("select",{name:"status",value:n.status,onChange:f,className:s.filter_input,children:[t.jsx("option",{value:"",children:"Select Status"}),t.jsx("option",{value:"cancelled",children:"Cancelled"}),t.jsx("option",{value:"alloted",children:"Alloted"}),t.jsx("option",{value:"completed",children:"Completed"}),t.jsx("option",{value:"not-alloted",children:"Not Alloted"})]})]})]}),t.jsxs("div",{className:s["report-body"],children:[t.jsxs("div",{className:s["report-topic-heading"],children:[t.jsx("h3",{className:s["t-op"],style:{width:"200px"},children:"Booking Id"}),t.jsx("h3",{className:s["t-op"],children:"Delivery Date"}),t.jsx("h3",{className:s["t-op"],children:"Booking Date"}),t.jsx("h3",{className:`${s["t-op"]}`,children:"Status"}),t.jsx("h3",{className:`${s["t-op"]}`,children:"Booking Value"}),t.jsx("h3",{className:s["t-op"],children:"Details"})]}),t.jsxs("div",{className:s.items,children:[!x&&!m&&!g&&(d==null?void 0:d.length)===0&&t.jsx("p",{children:"No bookings found"}),(x||m||g)&&t.jsx(O,{}),d==null?void 0:d.map((a,c)=>t.jsxs("div",{className:`${s.item1} ${s.cursor}`,children:[t.jsx("h3",{className:`${s["t-op-nextlvl"]}`,style:{width:"200px"},children:a.bookingId}),t.jsxs("h3",{className:s["t-op-nextlvl"],children:[t.jsx("span",{style:{color:"green"},children:a.autoAssigned&&"auto"})," ",u(new Date(a==null?void 0:a.bookingDate),"dd-MM-yyyy")]}),t.jsxs("h3",{className:s["t-op-nextlvl"],children:[" ",u(new Date(a==null?void 0:a.createdAt),"dd-MM-yyyy")]}),t.jsx("h3",{className:`${s["t-op-nextlvl"]} ${s.status} ${a.status==="cancelled"?s.Cancelled:a.status==="completed"?s.Completed:a.status==="alloted"?s.alloted:s.OutOfDelivery}`,children:a.status}),t.jsxs("h3",{className:`${s["t-op-nextlvl"]}`,children:["â‚¹",a.orderValue]}),t.jsx("h3",{className:s["t-op-nextlvl"],children:t.jsx("button",{onClick:()=>A(`/admin/bookings/${a._id}`,{state:a}),className:s.button,children:"View Details"})})]},c))]}),t.jsx("div",{style:{marginTop:"20px"},children:t.jsx(V,{changePage:w,limit:10,page:p,total:D+"0"})})]})]})})})};export{K as default};
