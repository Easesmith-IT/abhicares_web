import{r as p,e as F,j as a,_ as w,f as h}from"./index-C00j65eE.js";import{W as U}from"./Wrapper-Bui_DUEg.js";import{c as d}from"./Banner.module-CgHYAcNB.js";import{u as E}from"./useAuthorization-BQLez6m4.js";import{U as H}from"./UpdateBannerModal-CzkpMu57.js";import"./logo -C1Nz5jdc.js";import"./LogoutModal-BFEBZfWM.js";import"./iconBase-DBedV832.js";import"./index.esm-dmdmgyGU.js";const z=()=>{E();const[l,u]=p.useState([{bannerName:"hero-banner1",file:null,preview:null},{bannerName:"hero-banner2",file:null,preview:null},{bannerName:"hero-banner3",file:null,preview:null}]),[r,b]=p.useState([{bannerName:"banner4",file:null,preview:null},{bannerName:"banner5",file:null,preview:null}]),[j,g]=p.useState(!1),[$,f]=p.useState({img:"",type:"",page:"",section:""});F();const y=(e,n)=>{const s=e.target.files[0],t=new FileReader;t.readAsDataURL(s),t.addEventListener("load",function(){console.log(this.result);const c=r.findIndex(m=>m.bannerName===n);console.log("index",c);const o=[...r];o.splice(c,1,{bannerName:n,file:s,preview:this.result}),b(o)})},C=(e,n)=>{const s=e.target.files[0];console.log(s);const t=new FileReader;t.readAsDataURL(s),t.addEventListener("load",function(){console.log(this.result);const c=l.findIndex(m=>m.bannerName===n),o=[...l];o.splice(c,1,{bannerName:n,file:s,preview:this.result}),u(o)})},I=async e=>{console.log("type==",e),new FormData;const n=e==="banner1"?0:1;if(r[n].file===null){w.error("Please select the image");return}f({img:r[n].file,type:e,page:"home-banners",section:"app-homepage"}),g(!0)},k=async e=>{console.log(e);let n=l.find(s=>s.bannerName===e);if(!n.file){w.error("Please select the image");return}f({img:n.file,type:e,page:"home-hero-banners",section:"app-homepage"}),g(!0)},x=async()=>{try{const e=await h.get("https://abhicares.com/api/content/get-banners",{params:{heroBanners:!0,page:"home-hero-banners",section:"app-homepage"},withCredentials:!0}),n=[...l];for(let i=0;i<e.data.banners.length;i++){const B=e.data.banners[i].image,N=`hero-banner${i+1}`,v=l.findIndex(R=>R.bannerName===N);v!==-1&&n.splice(v,1,{bannerName:N,file:"",preview:`https://storage.googleapis.com/abhicares-backend-bucket/${B}`})}u(n);const s=await h.get("https://abhicares.com/api/content/get-banners",{params:{type:"banner1",page:"home-banners",section:"app-homepage"},withCredentials:!0});console.log("rs 2 bann",s);const t=[...r],c=r.findIndex(i=>i.bannerName==="banner4");t.splice(c,1,{bannerName:"banner4",file:null,preview:`https://storage.googleapis.com/abhicares-backend-bucket/${s.data.banners.image}`}),b(()=>t);const o=await h.get("https://abhicares.com/api/content/get-banners",{params:{type:"banner2",page:"home-banners",section:"app-homepage"},withCredentials:!0}),m=r.findIndex(i=>i.bannerName==="banner5");t.splice(m,1,{bannerName:"banner5",file:null,preview:`https://storage.googleapis.com/abhicares-backend-bucket/${o.data.banners.image}`}),b(()=>t),console.log("response1",e),console.log(s),console.log("response3",o)}catch(e){console.log(e.message)}};return p.useEffect(()=>{x()},[]),a.jsxs(a.Fragment,{children:[a.jsx(U,{children:a.jsxs("div",{children:[a.jsx("div",{className:"my-3 mx-5 d-flex justify-content-between",children:a.jsx("h3",{children:"Hero Banners(3)"})}),a.jsx("div",{className:d.imagesContainer,children:l&&l.map((e,n)=>a.jsxs("div",{className:d.imageWrapper,children:[e.bannerName&&e.preview&&a.jsx("img",{src:e.preview,alt:`i${n+1}`}),a.jsx("input",{type:"file",name:e.bannerName,accept:"image/*",onChange:s=>C(s,e.bannerName),className:"mb-2"}),a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>k(`hero-banner${n+1}`),children:"Update"})]},n))}),a.jsx("div",{className:d.otherBanners,children:r&&r.map((e,n)=>a.jsxs("div",{className:d.bannerContainer,children:[a.jsx("h4",{children:`Banner ${n+1}`}),e.bannerName&&e.preview&&a.jsx("img",{src:e.preview,alt:`banner${n+1}`}),a.jsxs("div",{className:d.bannerFooter,children:[a.jsx("input",{type:"file",name:e.bannerName,accept:"image/*",onChange:s=>y(s,e.bannerName),className:"mb-2"}),a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>I(`banner${n+1}`),children:"Update"})]})]},n))}),a.jsx("div",{className:"d-flex justify-content-end mx-5 mt-4"})]})}),j&&a.jsx(H,{getBannersFromServer:x,setIsModalOpen:g,data:$})]})};export{z as default};
