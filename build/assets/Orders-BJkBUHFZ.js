import{r as l,j as e,e as A}from"./index-B-IXA8Ie.js";import{c as t,W as E}from"./Wrapper-MkLY3g7U.js";import{u as b,h as I,B as k}from"./index.esm-BbyRK8SJ.js";import{L as F}from"./Loader-BC-JdY3x.js";import{R as L}from"./index.esm-UZTkdxOj.js";import{h as V}from"./jspdf-html2canvas.min-DgPDKMHS.js";import{u as T}from"./usePostApiReq-BqGvxZz6.js";import{f as u}from"./index--LFhlb37.js";import{P as q}from"./react-bootstrap-pagination-control.esm-BkNEHDtK.js";import"./logo -C1Nz5jdc.js";import"./useDispatch-C5OFXrAN.js";import"./iconBase-3hUsnpgH.js";const U="_wrapper_7u2da_1",W="_modal_7u2da_27",Y="_heading_container_7u2da_45",z="_contianer_7u2da_61",G="_mt_7u2da_87",H="_btn_container_7u2da_95",J="_button_7u2da_109",K="_table_wrapper_7u2da_125",Q="_table_7u2da_125",X="_d_flex_7u2da_151",c={wrapper:U,modal:W,heading_container:Y,contianer:z,mt:G,btn_container:H,button:J,table_wrapper:K,table:Q,d_flex:X},Z=({setIsModalOpen:n})=>{const{res:i,fetchData:x,isLoading:d}=T(),[m,j]=l.useState(""),[o,r]=l.useState([]);o.map(a=>[{OrderId:a._id},{date:u(new Date(a.createdAt),"dd-MM-yyyy")},{value:0},{orderValue:a.orderValue},{time:u(new Date(a.createdAt),"hh.mm aaaaa'm'")},{name:a.user.name},{phone:a.user.phone}]);const p=()=>{V(document.querySelector("#table"),{jsPDF:{format:"a4"},imageType:"image/jpeg",output:"./pdf/generate.pdf"})},_=a=>{j(a.target.value)},f=async()=>{if(!m)return;const a=m.split("-");x("/admin/get-monthly-orders",{month:a[1],year:a[0]})};return l.useEffect(()=>{((i==null?void 0:i.status)===200||(i==null?void 0:i.status)===201)&&(n(!0),r(i==null?void 0:i.data.data))},[i]),e.jsx("div",{className:c.wrapper,children:e.jsxs("div",{className:c.modal,children:[e.jsxs("div",{className:c.heading_container,children:[e.jsx("h4",{children:"Monthly Orders"}),e.jsxs("div",{className:c.d_flex,children:[e.jsxs("div",{className:t.d_flex,children:[e.jsx("input",{onChange:_,type:"month",name:"month",id:"month"}),e.jsx("button",{onClick:f,children:"Submit"})]}),e.jsx(L,{onClick:()=>n(!1),cursor:"pointer",size:26})]})]}),o.length===0&&e.jsx("p",{style:{padding:"0px 0px 20px 20px"},children:"No orders found."}),o.length>0&&e.jsxs("div",{className:t["report-body"],children:[e.jsx("div",{id:"table",className:c.table_wrapper,children:e.jsxs("table",{border:"2px",className:c.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"OrderId"}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{children:"Total Value"}),e.jsx("th",{children:"Order Time"}),e.jsx("th",{children:"User Name"}),e.jsx("th",{children:"User Mobile"})]})}),e.jsx("tbody",{children:o.map(a=>e.jsxs("tr",{children:[e.jsx("td",{style:{width:"210px",paddingInline:"10px"},children:a._id}),e.jsx("td",{style:{width:"160px"},children:u(new Date(a.createdAt),"dd-MM-yyyy")}),e.jsx("td",{children:a.orderValue}),e.jsx("td",{children:u(new Date(a.createdAt),"hh.mm aaaaa'm'")}),e.jsx("td",{children:a.user.name}),e.jsx("td",{children:a.user.phone})]}))})]})}),e.jsx("div",{className:c.btn_container,children:e.jsx("button",{className:c.button,onClick:p,children:"Download"})})]})]})})},oe=()=>{const{res:n,fetchData:i,isLoading:x}=b(),{res:d,fetchData:m,error:j,isLoading:o}=b(),[r,p]=l.useState([]),[_,f]=l.useState(!1);l.useState(null);const[a,D]=l.useState({startDate:"",endDate:"",status:""}),g=s=>{const{name:h,value:O}=s.target;D({...a,[h]:O})},y=l.useRef(),C=A(),[w,S]=l.useState(1),[v,$]=l.useState(1),M=async s=>{$(s)},N=async()=>{i(`/admin/get-all-orders?page=${v}&status=${a.status}&startDate=${a.startDate}&endDate=${a.endDate}`)};l.useEffect(()=>{N()},[v,a.status,a.startDate,a.endDate]),l.useEffect(()=>{var s,h;((n==null?void 0:n.status)===200||(n==null?void 0:n.status)===201)&&(p(n==null?void 0:n.data.data),S(Number((h=(s=n==null?void 0:n.data)==null?void 0:s.pagination)==null?void 0:h.totalPages)))},[n]);const P=async()=>{const s=y.current.value;if(!s){N();return}m(`/admin/get-order-by-id?orderId=${s}`)};return l.useEffect(()=>{((d==null?void 0:d.status)===200||(d==null?void 0:d.status)===201)&&p([d==null?void 0:d.data.data])},[d]),l.useEffect(()=>{j&&p([])},[j]),e.jsxs(e.Fragment,{children:[e.jsx(E,{children:e.jsxs("div",{className:t["report-container"],children:[e.jsxs("div",{className:t["report-header"],children:[e.jsx("h1",{className:t["recent-Articles"],children:"Orders"}),e.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"flex-end"},children:[e.jsxs("div",{children:[e.jsx("p",{children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:a.startDate,onChange:g,className:t.filter_input})]}),e.jsxs("div",{children:[e.jsx("p",{children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:a.endDate,onChange:g,className:t.filter_input})]}),e.jsxs("select",{name:"status",value:a.status,onChange:g,className:t.filter_input,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"OutOfDelivery",children:"OutOfDelivery"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]}),e.jsxs("div",{className:"d-flex",style:{position:"relative"},children:[e.jsx("input",{ref:y,style:{width:"300px",padding:"5px 10px",borderRadius:"5px"},type:"text",placeholder:"search order by id"}),e.jsx(I,{onClick:P,style:{position:"absolute",right:"8px",top:"10px",cursor:"pointer"}})]}),e.jsx("div",{className:t.d_flex,children:e.jsx("button",{onClick:()=>f(!0),children:e.jsx(k,{})})})]})]}),e.jsxs("div",{className:t["report-body"],children:[e.jsxs("div",{className:t["report-topic-heading"],children:[e.jsx("h3",{className:t["t-op"],style:{width:"200px"},children:"Order Id"}),e.jsx("h3",{className:t["t-op"],children:"Order Date"}),e.jsx("h3",{className:`${t["t-op"]}`,children:"Status"}),e.jsx("h3",{className:`${t["t-op"]}`,children:"Order Value"}),e.jsx("h3",{className:t["t-op"],children:"Details"})]}),e.jsxs("div",{className:t.items,children:[!x&&!o&&(r==null?void 0:r.length)===0&&e.jsx("p",{children:"No orders found"}),(x||o)&&e.jsx(F,{}),r==null?void 0:r.map((s,h)=>e.jsxs("div",{className:`${t.item1} ${t.cursor}`,children:[e.jsx("h3",{className:`${t["t-op-nextlvl"]}`,style:{width:"200px"},children:s.orderId}),e.jsx("h3",{className:t["t-op-nextlvl"],children:u(new Date(s.createdAt),"dd-MM-yyyy")}),e.jsx("h3",{className:`${t["t-op-nextlvl"]} ${t.status} ${s.status==="Cancelled"?t.Cancelled:s.status==="Completed"?t.Completed:s.status==="pending"?t.pending:t.OutOfDelivery}`,children:s.status}),e.jsxs("h3",{className:`${t["t-op-nextlvl"]}`,children:["â‚¹",s.orderValue]}),e.jsx("h3",{className:t["t-op-nextlvl"],children:e.jsx("button",{onClick:()=>C(`/admin/Orders/${s._id}`,{state:s}),className:t.button,children:"View Details"})})]},h))]}),e.jsx("div",{style:{marginTop:"20px"},children:e.jsx(q,{changePage:M,limit:10,page:v,total:w+"0"})})]})]})}),_&&e.jsx(Z,{setIsModalOpen:f})]})};export{oe as default};
