import{r as o,e as O,_,j as e}from"./index-if6yrKUM.js";import{A as B}from"./add-icon-nobg-CDiYK8IX.js";import{L as I}from"./Loader-BnomTiAq.js";import{c as y}from"./Shared.module-DD54I-nI.js";import{F as U}from"./index.esm-BY-Oqx_M.js";import{u as z,a as $}from"./index.esm-CdsNXrcl.js";import{R as D}from"./index.esm-GoR2NAnb.js";/* empty css                   */import{u as T}from"./useAuthorization-Cwg4rSt3.js";import{u as S}from"./usePatchApiReq-I7ZOyaKg.js";import{u as W}from"./usePostApiReq-b9urQUdc.js";import{D as G}from"./DeleteModal-moBDRdw7.js";import{u as H}from"./useDeleteApiReq-BB0v6lqY.js";import{W as J}from"./Wrapper-DsK8qFe2.js";import{P as K}from"./react-bootstrap-pagination-control.esm-DLu67gnb.js";import"./iconBase-lzS6dEZZ.js";import"./useDispatch-D0Me-TH-.js";import"./logo -C1Nz5jdc.js";const Q="_container_1kxfl_1",V="_city_wrapper_1kxfl_17",X="_city_1kxfl_17",Y="_city_right_1kxfl_45",v={container:Q,city_wrapper:V,city:X,city_right:Y},Z="_wrapper_sq67q_1",R="_modal_sq67q_27",ee="_heading_container_sq67q_47",se="_form_sq67q_59",te="_input_container_sq67q_73",ae="_input_sq67q_73",ne="_button_wrapper_sq67q_105",ie="_button_sq67q_105",oe="_inputAndButton_sq67q_131",ce="_pincodes_heading_sq67q_145",t={wrapper:Z,modal:R,heading_container:ee,form:se,input_container:te,input:ae,button_wrapper:ne,button:ie,inputAndButton:oe,pincodes_heading:ce},w=({setIsModalOpen:r,city:a="",getAllCities:q})=>{T(),S();const{res:s,fetchData:A,isLoading:C}=W(),[i,x]=o.useState({city:(a==null?void 0:a.city)||"",state:(a==null?void 0:a.state)||"",pinCode:""}),[l,f]=o.useState((a==null?void 0:a.pinCodes)||[]);console.log("pinCodes",l);const j=()=>{if(i.pinCode||_.error("Please enter a pincode"),i.pinCode.length!==6){_.error("Pincode length must be 6 digits");return}f(c=>[...c,{code:i.pinCode}]),x({...i,pinCode:""})},m=c=>{const{name:u,value:g}=c.target;x({...i,[u]:g})};O();const{res:d,fetchData:N}=S(),p=async c=>{if(c.preventDefault(),!i.city||l.length===0||!i.state){_.error("All fields are required");return}a?N(`/admin/update-availabe-city/${a._id}`,{...i,pinCodes:l}):A("/admin/create-availabe-city",{...i,pinCode:l})};o.useEffect(()=>{((s==null?void 0:s.status)===200||(s==null?void 0:s.status)===201)&&(_.success("City added successfully"),q(),r(!1))},[s]);const P=c=>{let u=[...l];u.splice(c,1),f(u)};return o.useEffect(()=>{((d==null?void 0:d.status)===200||(d==null?void 0:d.status)===201)&&(console.log("updateCityRes",d),_.success("City updated successfully"),q(),r(!1))},[d]),e.jsx("div",{className:t.wrapper,children:e.jsxs("div",{className:t.modal,children:[e.jsxs("div",{className:t.heading_container,children:[e.jsxs("h4",{children:[a?"Update":"Add"," City"]}),e.jsx("div",{className:t.d_flex,children:e.jsx(D,{onClick:()=>r(!1),cursor:"pointer",size:26})})]}),e.jsxs("form",{onSubmit:p,className:t.form,children:[e.jsxs("div",{className:t.input_container,children:[e.jsx("label",{htmlFor:"city",children:"City"}),e.jsx("input",{className:t.input,onChange:m,value:i.city,type:"text",name:"city",id:"city"})]}),e.jsxs("div",{className:t.input_container,children:[e.jsx("label",{htmlFor:"state",children:"State"}),e.jsx("input",{className:t.input,onChange:m,value:i.state,type:"text",name:"state",id:"state"})]}),e.jsxs("div",{className:t.input_container,children:[e.jsx("label",{htmlFor:"pinCode",children:"Add Pincodes"}),e.jsxs("div",{className:t.inputAndButton,children:[e.jsx("input",{className:t.input,onChange:m,value:i.pinCode,type:"number",name:"pinCode",id:"pinCode"}),e.jsx("button",{onClick:j,type:"button",className:t.button,children:"Add Pincode"})]}),l.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:t.pincodes_heading,children:"Added Pincodes:"}),e.jsx("div",{className:t.pincodes,children:l.map((c,u)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("p",{children:c==null?void 0:c.code}),e.jsx(D,{onClick:()=>P(u),style:{color:"red"},cursor:"pointer"})]}))})]})]}),e.jsx("div",{className:t.button_wrapper,children:e.jsx("button",{className:t.button,children:C?"Loading...":a?"Update":"Add"})})]})]})})},Ae=()=>{const{res:r,fetchData:a,isLoading:q}=H(),{res:s,fetchData:A,isLoading:C}=z(),[i,x]=o.useState(!1),[l,f]=o.useState(!1),[j,m]=o.useState(!1),[d,N]=o.useState({}),[p,P]=o.useState([]),[c,u]=o.useState(1),[g,k]=o.useState(1),M=async n=>{k(n)},b=async()=>{A(`/admin/get-availabe-city?page=${g}`)};o.useEffect(()=>{b()},[g]),o.useEffect(()=>{var n,h;((s==null?void 0:s.status)===200||(s==null?void 0:s.status)===201)&&(console.log("getCitiesRes",s),u((h=(n=s==null?void 0:s.data)==null?void 0:n.pagination)==null?void 0:h.totalPages),P(s==null?void 0:s.data.data))},[s]);const E=n=>{N(n),f(!l)},L=n=>{N(n),m(!j)},F=async()=>{a(`/admin/delete-availabe-city/${d}`)};return o.useEffect(()=>{((r==null?void 0:r.status)===200||(r==null?void 0:r.status)===201)&&(_.success("City deleted successfully"),b(),m(!j))},[r]),e.jsxs(e.Fragment,{children:[e.jsx(J,{children:e.jsxs("div",{className:y["report-container"],children:[e.jsxs("div",{className:y["report-header"],children:[e.jsx("h1",{className:y["recent-Articles"],children:"Available Cities"}),e.jsx("button",{onClick:()=>x(!0),className:y.services_add_btn,children:e.jsx("img",{src:B,alt:"add seller"})})]}),e.jsx("div",{style:{marginTop:"20px"},children:C&&e.jsx(I,{})}),e.jsxs("div",{className:v.container,children:[!C&&(p==null?void 0:p.length)===0&&e.jsx("p",{children:"No cities found"}),p==null?void 0:p.map(n=>e.jsxs("div",{className:v.city_wrapper,children:[e.jsxs("div",{className:v.city,children:[e.jsx("div",{className:v.city_left,children:e.jsxs("p",{children:["city: ",n.city]})}),e.jsxs("div",{className:v.city_right,children:[e.jsx(U,{onClick:()=>E(n),cursor:"pointer",size:20}),e.jsx($,{onClick:()=>L(n._id),cursor:"pointer",size:22,color:"red"})]})]}),e.jsxs("p",{children:["state: ",n.state]}),e.jsxs("p",{children:["pincode: ",n.pinCodes.map(h=>h==null?void 0:h.code).join(", ")]})]},n._id))]}),e.jsx("div",{style:{marginTop:"20px"},children:e.jsx(K,{changePage:M,limit:10,page:g,total:c+"0"})})]})}),i&&e.jsx(w,{setIsModalOpen:x,getAllCities:b}),l&&e.jsx(w,{setIsModalOpen:f,getAllCities:b,city:d}),j&&e.jsx(G,{handleDelete:F,setState:m})]})};export{Ae as default};
