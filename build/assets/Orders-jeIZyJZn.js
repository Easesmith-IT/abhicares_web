import{r as i,j as e,e as A}from"./index-MFQKCb7o.js";import{c as t,W as O}from"./Wrapper-EuhUHBtD.js";import{u as D,h as E,z as I}from"./index.esm-Df65-zPW.js";import{L as k}from"./Loader-CooIHcb6.js";import{R as F}from"./index.esm-CqPrJGFm.js";import{h as V}from"./jspdf-html2canvas.min-CS5f29oT.js";import{u as L}from"./usePostApiReq-D4ZpDEWt.js";import{f as u}from"./index-D5Lf-kgZ.js";import{P as T}from"./react-bootstrap-pagination-control.esm-Bg2RX54B.js";import"./logo -C1Nz5jdc.js";import"./useDispatch-DbBSbkF0.js";import"./iconBase-BO1x0Pa9.js";const q="_wrapper_7u2da_1",z="_modal_7u2da_27",U="_heading_container_7u2da_45",W="_contianer_7u2da_61",Y="_mt_7u2da_87",G="_btn_container_7u2da_95",H="_button_7u2da_109",J="_table_wrapper_7u2da_125",K="_table_7u2da_125",Q="_d_flex_7u2da_151",o={wrapper:q,modal:z,heading_container:U,contianer:W,mt:Y,btn_container:G,button:H,table_wrapper:J,table:K,d_flex:Q},X=({setIsModalOpen:n})=>{const{res:d,fetchData:x,isLoading:r}=L(),[m,j]=i.useState(""),[l,p]=i.useState([]);l.map(a=>[{OrderId:a._id},{date:u(new Date(a.createdAt),"dd-MM-yyyy")},{value:0},{orderValue:a.orderValue},{time:u(new Date(a.createdAt),"hh.mm aaaaa'm'")},{name:a.user.name},{phone:a.user.phone}]);const _=()=>{V(document.querySelector("#table"),{jsPDF:{format:"a4"},imageType:"image/jpeg",output:"./pdf/generate.pdf"})},f=a=>{j(a.target.value)},g=async()=>{if(!m)return;const a=m.split("-");x("/admin/get-monthly-orders",{month:a[1],year:a[0]})};return i.useEffect(()=>{((d==null?void 0:d.status)===200||(d==null?void 0:d.status)===201)&&(n(!0),p(d==null?void 0:d.data.data))},[d]),e.jsx("div",{className:o.wrapper,children:e.jsxs("div",{className:o.modal,children:[e.jsxs("div",{className:o.heading_container,children:[e.jsx("h4",{children:"Monthly Orders"}),e.jsxs("div",{className:o.d_flex,children:[e.jsxs("div",{className:t.d_flex,children:[e.jsx("input",{onChange:f,type:"month",name:"month",id:"month"}),e.jsx("button",{onClick:g,children:"Submit"})]}),e.jsx(F,{onClick:()=>n(!1),cursor:"pointer",size:26})]})]}),l.length===0&&e.jsx("p",{style:{padding:"0px 0px 20px 20px"},children:"No orders found."}),l.length>0&&e.jsxs("div",{className:t["report-body"],children:[e.jsx("div",{id:"table",className:o.table_wrapper,children:e.jsxs("table",{border:"2px",className:o.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"OrderId"}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{children:"Total Value"}),e.jsx("th",{children:"Order Time"}),e.jsx("th",{children:"User Name"}),e.jsx("th",{children:"User Mobile"})]})}),e.jsx("tbody",{children:l.map(a=>e.jsxs("tr",{children:[e.jsx("td",{style:{width:"210px",paddingInline:"10px"},children:a._id}),e.jsx("td",{style:{width:"160px"},children:u(new Date(a.createdAt),"dd-MM-yyyy")}),e.jsx("td",{children:a.orderValue}),e.jsx("td",{children:u(new Date(a.createdAt),"hh.mm aaaaa'm'")}),e.jsx("td",{children:a.user.name}),e.jsx("td",{children:a.user.phone})]}))})]})}),e.jsx("div",{className:o.btn_container,children:e.jsx("button",{className:o.button,onClick:_,children:"Download"})})]})]})})},ce=()=>{const{res:n,fetchData:d,isLoading:x}=D(),{res:r,fetchData:m,error:j}=D(),[l,p]=i.useState([]),[_,f]=i.useState(!1);i.useState(null);const[g,a]=i.useState(1),[v,C]=i.useState(1),[c,w]=i.useState({startDate:"",endDate:"",status:""}),y=s=>{const{name:h,value:P}=s.target;w({...c,[h]:P})},N=i.useRef(),S=A(),$=async s=>{C(s)},b=async()=>{d(`/admin/get-all-orders?page=${v}&status=${c.status}&startDate=${c.startDate}&endDate=${c.endDate}`)};i.useEffect(()=>{b()},[v,c.status,c.startDate,c.endDate]),i.useEffect(()=>{var s,h;((n==null?void 0:n.status)===200||(n==null?void 0:n.status)===201)&&(p(n==null?void 0:n.data.data),a(Number((h=(s=n==null?void 0:n.data)==null?void 0:s.pagination)==null?void 0:h.totalPages)))},[n]);const M=async()=>{const s=N.current.value;if(!s){b();return}m(`/admin/get-order-by-id?orderId=${s}`)};return i.useEffect(()=>{((r==null?void 0:r.status)===200||(r==null?void 0:r.status)===201)&&p([r==null?void 0:r.data.data])},[r]),i.useEffect(()=>{j&&p([])},[j]),e.jsxs(e.Fragment,{children:[e.jsx(O,{children:e.jsxs("div",{className:t["report-container"],children:[e.jsxs("div",{className:t["report-header"],children:[e.jsx("h1",{className:t["recent-Articles"],children:"Orders"}),e.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"flex-end"},children:[e.jsxs("div",{children:[e.jsx("p",{children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:c.startDate,onChange:y,className:t.filter_input})]}),e.jsxs("div",{children:[e.jsx("p",{children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:c.endDate,onChange:y,className:t.filter_input})]}),e.jsxs("select",{name:"status",value:c.status,onChange:y,className:t.filter_input,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"OutOfDelivery",children:"OutOfDelivery"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]}),e.jsxs("div",{className:"d-flex",style:{position:"relative"},children:[e.jsx("input",{ref:N,style:{width:"300px",padding:"5px 10px",borderRadius:"5px"},type:"text",placeholder:"search order by id"}),e.jsx(E,{onClick:M,style:{position:"absolute",right:"8px",top:"10px",cursor:"pointer"}})]}),e.jsx("div",{className:t.d_flex,children:e.jsx("button",{onClick:()=>f(!0),children:e.jsx(I,{})})})]})]}),e.jsxs("div",{className:t["report-body"],children:[e.jsxs("div",{className:t["report-topic-heading"],children:[e.jsx("h3",{className:t["t-op"],style:{width:"200px"},children:"Order Id"}),e.jsx("h3",{className:t["t-op"],children:"Order Date"}),e.jsx("h3",{className:`${t["t-op"]}`,children:"Status"}),e.jsx("h3",{className:`${t["t-op"]}`,children:"Order Value"}),e.jsx("h3",{className:t["t-op"],children:"Details"})]}),e.jsxs("div",{className:t.items,children:[!x&&(l==null?void 0:l.length)===0&&e.jsx("p",{children:"No orders found"}),x&&(l==null?void 0:l.length)===0&&e.jsx(k,{}),l==null?void 0:l.map((s,h)=>e.jsxs("div",{className:`${t.item1} ${t.cursor}`,children:[e.jsx("h3",{className:`${t["t-op-nextlvl"]}`,style:{width:"200px"},children:s.orderId}),e.jsx("h3",{className:t["t-op-nextlvl"],children:u(new Date(s.createdAt),"dd-MM-yyyy")}),e.jsx("h3",{className:`${t["t-op-nextlvl"]} ${t.status} ${s.status==="Cancelled"?t.Cancelled:s.status==="Completed"?t.Completed:s.status==="pending"?t.pending:t.OutOfDelivery}`,children:s.status}),e.jsxs("h3",{className:`${t["t-op-nextlvl"]}`,children:["â‚¹",s.orderValue]}),e.jsx("h3",{className:t["t-op-nextlvl"],children:e.jsx("button",{onClick:()=>S(`/admin/Orders/${s._id}`,{state:s}),className:t.button,children:"View Details"})})]},h))]}),e.jsx("div",{style:{marginTop:"100px"},children:e.jsx(T,{changePage:$,limit:10,page:v,total:g+"0"})})]})]})}),_&&e.jsx(X,{setIsModalOpen:f})]})};export{ce as default};
