import{r as m,e as R,j as a,_ as U,f as u}from"./index-MFgKNwIH.js";import{W as E}from"./Wrapper-DFsBGa0y.js";import{c as g}from"./Banner.module-CgHYAcNB.js";import{u as F}from"./useAuthorization-CroFzkCu.js";import{U as S}from"./UpdateBannerModal-IEz022yu.js";import"./logo -C1Nz5jdc.js";import"./index.esm-cL7qp0JE.js";import"./iconBase-CdfoCUfg.js";import"./useDispatch-CwGLudnh.js";import"./index.esm-DfQilCDn.js";import"./usePostApiReq-BPpWmR_n.js";const G=()=>{F();const[i,f]=m.useState([{bannerName:"hero-banner1",file:null,preview:null},{bannerName:"hero-banner2",file:null,preview:null},{bannerName:"hero-banner3",file:null,preview:null}]),[t,b]=m.useState([{bannerName:"banner4",file:null,preview:null},{bannerName:"banner5",file:null,preview:null}]),[y,d]=m.useState(!1),[j,h]=m.useState({img:"",type:"",page:"",section:""});R(),console.log("banners",t);const w=(e,n)=>{const s=e.target.files[0],r=new FileReader;r.readAsDataURL(s),r.addEventListener("load",function(){console.log(this.result);const c=t.findIndex(p=>p.bannerName===n);console.log("index",c);const l=[...t];l.splice(c,1,{bannerName:n,file:s,preview:this.result}),b(l)})},$=(e,n)=>{const s=e.target.files[0];console.log(s);const r=new FileReader;r.readAsDataURL(s),r.addEventListener("load",function(){console.log(this.result);const c=i.findIndex(p=>p.bannerName===n),l=[...i];l.splice(c,1,{bannerName:n,file:s,preview:this.result}),f(l)})},I=async e=>{console.log("type==",e);const n=e==="banner1"?0:1;if(t[n].file===null){alert("Please select the images");return}h({img:t[n].file,type:e,page:"category-banners",section:"app-categorypage"}),d(!0)},C=async e=>{console.log(e);let n=i.find(s=>s.bannerName===e);if(console.log("filtered img",n),n&&n.file===null){U.error("Please select the image");return}h({img:n.file,type:e,page:"category-banners",section:"app-categorypage"}),d(!0)},x=async()=>{try{const e=await u.get("https://abhicares.com/api/content/get-banners",{params:{heroBanners:!0,page:"category-banners",section:"app-categorypage"}}),n=[...i];for(let o=0;o<e.data.banners.length;o++){const k=e.data.banners[o].image,N=`hero-banner${o+1}`,v=i.findIndex(B=>B.bannerName===N);v!==-1&&n.splice(v,1,{bannerName:N,file:null,preview:`https://storage.googleapis.com/abhicares-backend-bucket/${k}`})}f(n);const s=await u.get("https://abhicares.com/api/content/get-banners",{params:{type:"banner1",page:"category-banners",section:"app-categorypage"}});console.log("rs 2 bann",s);const r=[...t],c=t.findIndex(o=>o.bannerName==="banner4");r.splice(c,1,{bannerName:"banner4",file:null,preview:`https://storage.googleapis.com/abhicares-backend-bucket/${s.data.banners.image}`}),b(()=>r);const l=await u.get("https://abhicares.com/api/content/get-banners",{params:{type:"banner2",page:"category-banners",section:"app-categorypage"}}),p=t.findIndex(o=>o.bannerName==="banner5");r.splice(p,1,{bannerName:"banner5",file:null,preview:`https://storage.googleapis.com/abhicares-backend-bucket/${l.data.banners.image}`}),b(()=>r)}catch(e){console.log(e.message)}};return m.useEffect(()=>{x()},[]),a.jsxs(a.Fragment,{children:[a.jsx(E,{children:a.jsxs("div",{children:[a.jsx("div",{className:"my-3 mx-5 d-flex justify-content-between",children:a.jsx("h3",{children:"Hero Banners(3)"})}),a.jsx("div",{className:g.imagesContainer,children:i&&i.map((e,n)=>a.jsxs("div",{className:g.imageWrapper,children:[e.bannerName&&e.preview&&a.jsx("img",{src:e.preview,alt:`i${n+1}`}),a.jsx("input",{type:"file",name:e.bannerName,accept:"image/*",onChange:s=>$(s,e.bannerName),className:"mb-2"}),a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>C(`hero-banner${n+1}`),children:"Update"})]},n))}),a.jsx("div",{className:g.otherBanners,children:t&&t.map((e,n)=>a.jsxs("div",{className:g.bannerContainer,children:[a.jsx("h4",{children:`Banner ${n+1}`}),e.bannerName&&e.preview&&a.jsx("img",{src:e.preview,alt:`banner${n+1}`}),a.jsxs("div",{className:g.bannerFooter,children:[a.jsx("input",{type:"file",name:e.bannerName,accept:"image/*",onChange:s=>w(s,e.bannerName),className:"mb-2"}),a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>I(`banner${n+1}`),children:"Update"})]})]},n))}),a.jsx("div",{className:"d-flex justify-content-end mx-5 mt-4"})]})}),y&&a.jsx(S,{getBannersFromServer:x,setIsModalOpen:d,data:j})]})};export{G as default};
