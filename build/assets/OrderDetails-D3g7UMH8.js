import{o as I,r as d,e as $,p as R,j as s,f as v,_ as L}from"./index-lY8eDmQj.js";import{W as q}from"./Wrapper-C5Vyjcs6.js";import{u as E}from"./useAuthorization-ZL8Fu2nK.js";import{f as N}from"./index-3HMGIBDb.js";import"./logo -C1Nz5jdc.js";import"./LogoutModal-CpkpXklC.js";import"./iconBase-BlupGJxB.js";const M="_wrapper_xu49t_1",U="_left_div_xu49t_19",V="_select_xu49t_33",z="_info_xu49t_45",W="_heading_xu49t_55",B="_container_xu49t_67",F="_item_xu49t_91",Q="_img_xu49t_115",G="_right_div_xu49t_125",H="_right_div_top_xu49t_133",J="_right_div_bottom_xu49t_135",K="_d_flex_xu49t_157",i={wrapper:M,left_div:U,select:V,info:z,heading:W,container:B,item:F,img:Q,right_div:G,right_div_top:H,right_div_bottom:J,d_flex:K},oe=()=>{var x,p,m,_,f;const{state:o}=I(),[X,t]=d.useState(!1),[y,b]=d.useState(0),[Y,l]=d.useState(0),[Z,u]=d.useState(0),T=$(),[e,k]=d.useState(o||""),[C,a]=d.useState(o==null?void 0:o.status),{id:D}=R();console.log(e);const{checkAuthorization:P}=E(),h=async()=>{var r;try{t(!0);const{data:c}=await v.get(`https://abhicares.com/api/admin/get-order-details?orderId=${D}`,{withCredentials:!0});console.log("Order details",c),k(c==null?void 0:c.data),t(!1),a((r=c==null?void 0:c.data)==null?void 0:r.status)}catch(c){console.log(c)}};d.useEffect(()=>{h()},[e==null?void 0:e._id]);const S=async r=>{a(()=>r.target.value);try{const{data:c}=await v.post(`https://abhicares.com/api/admin/change-order-status/${e==null?void 0:e._id}`,{status:r.target.value},{withCredentials:!0});console.log("status",c),L.success("Order status changed successfully"),h()}catch(c){console.log(c),a(()=>e==null?void 0:e.status),P(c)}};return d.useEffect(()=>{if(e!=null&&e.items&&(e==null?void 0:e.items.length)>0){let r=0;for(const n of e.items)n!=null&&n.product?r=r+Number(n.quantity*n.product.offerPrice):r=r+Number(n.quantity*n.package.offerPrice);l(()=>r);const c=Number(r)*18/100;b(c);const{discountType:O,couponFixedValue:j,offPercentage:A,maxDiscount:g}=(e==null?void 0:e.couponId)||{};if(e!=null&&e.couponId)if(O==="fixed")u(j),l(n=>n-Number(j));else{let n=Math.ceil(r*(Number(A)/100));n=n>g?g:n,console.log("offerTotal",n),u(n),l(w=>w-Number(n))}}},[e==null?void 0:e.orderValue,e==null?void 0:e.couponId,e,e==null?void 0:e.items,y,T]),s.jsx(q,{children:s.jsxs("div",{className:i.wrapper,children:[s.jsxs("div",{className:i.left_div,children:[s.jsxs("div",{className:i.info,children:[s.jsxs("div",{children:[s.jsxs("h4",{children:["Order Id: ",e==null?void 0:e.orderId]}),s.jsx("h5",{children:"Update Status"}),s.jsxs("select",{onChange:S,value:C,className:i.select,name:"status",id:"status",children:[s.jsx("option",{value:"Pending",children:"Pending"}),s.jsx("option",{value:"OutOfDelivery",children:"OutOfDelivery"}),s.jsx("option",{value:"Completed",children:"Completed"}),s.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),s.jsxs("div",{children:[s.jsxs("p",{children:["Date of Order: ",(e==null?void 0:e.createdAt)&&N(new Date(e==null?void 0:e.createdAt),"dd-MM-yyyy")]}),s.jsxs("p",{children:["Time of Order: ",(e==null?void 0:e.createdAt)&&N(new Date(e==null?void 0:e.createdAt),"hh:mm aa")]}),s.jsxs("p",{children:["Payment Type: ",e==null?void 0:e.paymentType]}),s.jsxs("p",{children:["No of Left Bookings: ",e==null?void 0:e.No_of_left_bookings]}),s.jsxs("p",{children:["Refund Amount: ",(x=e==null?void 0:e.refundInfo)==null?void 0:x.amount]}),s.jsxs("p",{children:["Refund Status: ",(p=e==null?void 0:e.refundInfo)==null?void 0:p.status]})]})]}),s.jsxs("p",{style:{marginTop:"20px"},children:["Admin Comment: ",e==null?void 0:e.adminComment]}),s.jsx("h5",{className:i.heading,children:"Products"}),s.jsx("div",{className:i.container,children:(m=e==null?void 0:e.items)==null?void 0:m.map((r,c)=>s.jsxs("div",{className:i.item,children:[s.jsxs("div",{children:[s.jsx("img",{className:i.img,src:`https://storage.googleapis.com/abhicares-backend-bucket/${r.package?r.package.imageUrl[0]:r.product.imageUrl[0]}`,alt:"product"}),s.jsxs("div",{children:[s.jsx("h6",{children:r.package?r.package.name:r.product.name}),s.jsx("p",{children:r.package?"Package":"Product"})]})]}),s.jsxs("p",{children:["Qty: ",r.quantity]}),s.jsxs("p",{children:["₹",Number(r.package?r.package.offerPrice:r.product.offerPrice)*Number(r.quantity)]})]},c))})]}),s.jsxs("div",{className:i.right_div,children:[s.jsxs("div",{className:i.right_div_top,children:[s.jsx("h5",{children:"Order Summary"}),s.jsxs("div",{className:i.heading,children:[s.jsx("p",{children:"Descriptions"}),s.jsx("p",{children:"Amounts"})]}),s.jsxs("div",{className:i.d_flex,children:[s.jsx("p",{children:"Sub Total :"}),s.jsxs("p",{children:["₹",e==null?void 0:e.itemTotal]})]}),s.jsxs("div",{className:i.d_flex,children:[s.jsx("p",{children:"Tax (18%) :"}),s.jsxs("p",{children:["+ ₹",e==null?void 0:e.tax]})]}),(e==null?void 0:e.discount)>0&&s.jsxs("div",{className:i.d_flex,children:[s.jsxs("p",{children:["Discount ('",(_=e==null?void 0:e.couponId)==null?void 0:_.name,"') :"]}),s.jsxs("p",{children:["- ₹",e==null?void 0:e.discount]})]}),(e==null?void 0:e.referalDiscount)>0&&s.jsxs("div",{className:i.d_flex,children:[s.jsx("p",{children:"Referal Discount :"}),s.jsxs("p",{children:["- ₹",e==null?void 0:e.referalDiscount]})]}),s.jsxs("div",{className:i.d_flex,children:[s.jsx("p",{children:"Total Amount :"}),s.jsxs("p",{children:["₹",e==null?void 0:e.orderValue]})]})]}),s.jsxs("div",{className:i.right_div_bottom,children:[s.jsx("h5",{children:"Customer Details"}),s.jsxs("div",{className:i.d_flex,children:[s.jsx("p",{children:"Customer Name :"}),s.jsx("p",{children:(f=e==null?void 0:e.user)==null?void 0:f.name})]}),s.jsxs("div",{className:i.d_flex,children:[s.jsx("p",{children:"Customer Phone :"}),s.jsx("p",{children:e==null?void 0:e.user.phone})]}),s.jsxs("div",{className:i.d_flex,children:[s.jsx("p",{children:"Customer Address :"}),s.jsx("p",{children:`${e==null?void 0:e.user.address.addressLine},${e==null?void 0:e.user.address.landmark},${e==null?void 0:e.user.address.pincode}`})]})]})]})]})})};export{oe as default};
