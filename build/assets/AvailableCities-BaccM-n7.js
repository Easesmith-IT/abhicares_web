import{r as d,e as q,j as e,_ as h,f as C}from"./index-lY8eDmQj.js";import{W as D,c as g}from"./Wrapper-C5Vyjcs6.js";import{L as M}from"./Loader-D1crzail.js";import{A as P}from"./add-icon-nobg-CDiYK8IX.js";import{F as $}from"./index.esm-CnaLvXm0.js";import{a as z}from"./LogoutModal-CpkpXklC.js";import{R as N}from"./index.esm-TZhK3vYx.js";/* empty css                   */import{u as w}from"./useAuthorization-ZL8Fu2nK.js";import{D as F}from"./DeleteModal-CI6_ta-U.js";import"./logo -C1Nz5jdc.js";import"./iconBase-BlupGJxB.js";const B="_container_1kxfl_1",O="_city_wrapper_1kxfl_17",U="_city_1kxfl_17",E="_city_right_1kxfl_45",j={container:B,city_wrapper:O,city:U,city_right:E},I="_wrapper_sq67q_1",L="_modal_sq67q_27",R="_heading_container_sq67q_47",W="_form_sq67q_59",G="_input_container_sq67q_73",H="_input_sq67q_73",J="_button_wrapper_sq67q_105",K="_button_sq67q_105",Q="_inputAndButton_sq67q_131",T="_pincodes_heading_sq67q_145",a={wrapper:I,modal:L,heading_container:R,form:W,input_container:G,input:H,button_wrapper:J,button:K,inputAndButton:Q,pincodes_heading:T},A=({setIsModalOpen:l,city:n="",getAllCities:u})=>{const{checkAuthorization:m}=w(),[i,p]=d.useState({city:(n==null?void 0:n.city)||"",state:(n==null?void 0:n.state)||"",pinCode:""}),[c,_]=d.useState((n==null?void 0:n.pinCodes)||[]);console.log("pinCodes",c);const r=()=>{if(i.pinCode||h.error("Please enter a pincode"),i.pinCode.length!==6){h.error("Pincode length must be 6 digits");return}_(o=>[...o,{code:i.pinCode}]),p({...i,pinCode:""})},x=o=>{const{name:s,value:b}=o.target;p({...i,[s]:b})};q();const f=async o=>{if(o.preventDefault(),!i.city||c.length===0||!i.state){h.error("All fields are required");return}if(n)try{const{data:s}=await C.patch(`https://abhicares.com/api/admin/update-availabe-city/${n._id}`,{...i,pinCodes:c},{withCredentials:!0});h.success("City updated successfully"),u(),l(!1)}catch(s){l(!1),m(s),console.log(s)}else try{const{data:s}=await C.post("https://abhicares.com/api/admin/create-availabe-city",{...i,pinCode:c},{withCredentials:!0});h.success("City added successfully"),u(),l(!1)}catch(s){l(!1),m(s),console.log(s)}},v=o=>{let s=[...c];s.splice(o,1),_(s)};return e.jsx("div",{className:a.wrapper,children:e.jsxs("div",{className:a.modal,children:[e.jsxs("div",{className:a.heading_container,children:[e.jsxs("h4",{children:[n?"Update":"Add"," City"]}),e.jsx("div",{className:a.d_flex,children:e.jsx(N,{onClick:()=>l(!1),cursor:"pointer",size:26})})]}),e.jsxs("form",{onSubmit:f,className:a.form,children:[e.jsxs("div",{className:a.input_container,children:[e.jsx("label",{htmlFor:"city",children:"City"}),e.jsx("input",{className:a.input,onChange:x,value:i.city,type:"text",name:"city",id:"city"})]}),e.jsxs("div",{className:a.input_container,children:[e.jsx("label",{htmlFor:"state",children:"State"}),e.jsx("input",{className:a.input,onChange:x,value:i.state,type:"text",name:"state",id:"state"})]}),e.jsxs("div",{className:a.input_container,children:[e.jsx("label",{htmlFor:"pinCode",children:"Add Pincodes"}),e.jsxs("div",{className:a.inputAndButton,children:[e.jsx("input",{className:a.input,onChange:x,value:i.pinCode,type:"number",name:"pinCode",id:"pinCode"}),e.jsx("button",{onClick:r,type:"button",className:a.button,children:"Add Pincode"})]}),c.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:a.pincodes_heading,children:"Added Pincodes:"}),e.jsx("div",{className:a.pincodes,children:c.map((o,s)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx("p",{children:o==null?void 0:o.code}),e.jsx(N,{onClick:()=>v(s),style:{color:"red"},cursor:"pointer"})]}))})]})]}),e.jsx("div",{className:a.button_wrapper,children:e.jsx("button",{className:a.button,children:n?"Update":"Add"})})]})]})})},ce=()=>{const[l,n]=d.useState(!1),[u,m]=d.useState(!1),[i,p]=d.useState(!1),[c,_]=d.useState({}),[r,x]=d.useState([]),[f,v]=d.useState(!0);q();const{checkAuthorization:o}=w(),s=async()=>{try{const{data:t}=await C.get("https://abhicares.com/api/admin/get-availabe-city",{withCredentials:!0});console.log(t),x(t.data)}catch(t){console.log(t)}finally{v(!1)}};d.useEffect(()=>{s()},[]);const b=t=>{_(t),m(!u)},k=t=>{_(t),p(!i)},S=async()=>{try{const{data:t}=await C.delete(`https://abhicares.com/api/admin/delete-availabe-city/${c}`,{withCredentials:!0});h.success("City deleted successfully"),s(),p(!i)}catch(t){console.log(t),p(!1),o(t)}};return e.jsxs(e.Fragment,{children:[e.jsx(D,{children:e.jsxs("div",{className:g["report-container"],children:[e.jsxs("div",{className:g["report-header"],children:[e.jsx("h1",{className:g["recent-Articles"],children:"Available Cities"}),e.jsx("button",{onClick:()=>n(!0),className:g.services_add_btn,children:e.jsx("img",{src:P,alt:"add seller"})})]}),e.jsxs("div",{className:j.container,children:[!f&&(r==null?void 0:r.length)===0&&e.jsx("p",{children:"No cities found"}),f&&(r==null?void 0:r.length)===0&&e.jsx(M,{}),r==null?void 0:r.map(t=>e.jsxs("div",{className:j.city_wrapper,children:[e.jsxs("div",{className:j.city,children:[e.jsx("div",{className:j.city_left,children:e.jsxs("p",{children:["city: ",t.city]})}),e.jsxs("div",{className:j.city_right,children:[e.jsx($,{onClick:()=>b(t),cursor:"pointer",size:20}),e.jsx(z,{onClick:()=>k(t._id),cursor:"pointer",size:22,color:"red"})]})]}),e.jsxs("p",{children:["state: ",t.state]}),e.jsxs("p",{children:["pincode: ",t.pinCodes.map(y=>y==null?void 0:y.code).join(", ")]})]},t._id))]})]})}),l&&e.jsx(A,{setIsModalOpen:n,getAllCities:s}),u&&e.jsx(A,{setIsModalOpen:m,getAllCities:s,city:c}),i&&e.jsx(F,{handleDelete:S,setState:p})]})};export{ce as default};
