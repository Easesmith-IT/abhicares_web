import{r as o,e as F,_ as y,j as e,n as L,u as M}from"./index-B-IXA8Ie.js";import{W as U,c as b}from"./Wrapper-MkLY3g7U.js";import{A as $}from"./add-icon-nobg-CDiYK8IX.js";import{p as E}from"./index-BzzzayLF.js";import{R as O}from"./index.esm-UZTkdxOj.js";import{R as q}from"./index-BePlCa_-.js";/* empty css                   */import{u as S}from"./useAuthorization-DJfWabbS.js";import{f as P,u as z,a as T}from"./index.esm-BbyRK8SJ.js";import{u as W}from"./usePatchApiReq-CFyoLoKy.js";import{u as B}from"./usePostApiReq-BqGvxZz6.js";import{D as G}from"./DeleteModal-C90xvr-R.js";import{L as Q}from"./Loader-BC-JdY3x.js";import{F as J}from"./index.esm-BMR3ZfE0.js";import{u as K}from"./useDeleteApiReq-Cdh8879L.js";import"./logo -C1Nz5jdc.js";import"./useDispatch-C5OFXrAN.js";import"./iconBase-3hUsnpgH.js";const R="_heading_container_rgxyq_1",V={heading_container:R},X="_wrapper_10nyf_1",Y="_modal_10nyf_27",Z="_heading_container_10nyf_47",ee="_form_10nyf_59",ae="_input_container_10nyf_73",te="_input_10nyf_73",se="_button_wrapper_10nyf_105",ne="_button_10nyf_105",ie="_img_container_10nyf_133",oe="_icon_10nyf_145",s={wrapper:X,modal:Y,heading_container:Z,form:ee,input_container:ae,input:te,button_wrapper:se,button:ne,img_container:ie,icon:oe},A=({setIsModalOpen:i,categoryId:D,service:a="",getCategoryServices:l})=>{const{res:d,fetchData:H,isLoading:I}=B();S();const[_,v]=o.useState((a==null?void 0:a.description)||""),[t,p]=o.useState({name:(a==null?void 0:a.name)||"",startingPrice:(a==null?void 0:a.startingPrice)||"",img:(a==null?void 0:a.imageUrl)||"",appHomepage:(a==null?void 0:a.appHomepage)||!1,webHomepage:(a==null?void 0:a.webHomepage)||!1,previewImage:""}),h=o.useRef(null),f=g=>{g.preventDefault();const n=g.target.files[0],u=new FileReader;u.readAsDataURL(n),u.addEventListener("load",function(){p({...t,img:n,previewImage:this.result})})},j=g=>{const{name:n,value:u}=g.target;p({...t,[n]:u})},N=()=>{h.current&&(h.current.value=null),p({...t,img:"",previewImage:""})},w=()=>{p({...t,img:"",previewImage:""})};F();const{res:m,fetchData:C}=W(),c=async g=>{if(g.preventDefault(),!t.name||!t.startingPrice||!t.img||!_){y.error("All the fields are required");return}const n=new FormData;n.append("name",t.name),n.append("startingPrice",t.startingPrice),n.append("description",_),n.append("appHomepage",t.appHomepage),n.append("webHomepage",t.webHomepage),n.append("img",t.img),n.append("categoryId",D),a?await C(`/admin/update-service/${a._id}`,n):H("/admin/create-service",n)};return o.useEffect(()=>{((d==null?void 0:d.status)===200||(d==null?void 0:d.status)===201)&&(y.success("Service added successfully"),l(),i(!1))},[d]),o.useEffect(()=>{((m==null?void 0:m.status)===200||(m==null?void 0:m.status)===201)&&(y.success("Service updated successfully"),l(),i(!1))},[m]),e.jsx("div",{className:s.wrapper,children:e.jsxs("div",{className:s.modal,children:[e.jsxs("div",{className:s.heading_container,children:[e.jsxs("h4",{children:[a?"Update":"Add"," Service"]}),e.jsx("div",{className:s.d_flex,children:e.jsx(O,{onClick:()=>i(!1),cursor:"pointer",size:26})})]}),e.jsxs("form",{onSubmit:c,className:s.form,children:[e.jsxs("div",{className:s.input_container,children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx("input",{className:s.input,onChange:j,value:t.name,type:"text",name:"name",id:"name"})]}),e.jsxs("div",{className:s.input_container,children:[e.jsx("label",{htmlFor:"startingPrice",children:"Starting Price"}),e.jsx("input",{className:s.input,onChange:j,value:t.startingPrice,type:"number",name:"startingPrice",id:"startingPrice"})]}),e.jsxs("div",{className:s.input_container,children:[e.jsx("label",{htmlFor:"description",children:"Description"}),e.jsx(q,{theme:"snow",value:_,onChange:v})]}),e.jsxs("div",{className:s.input_container,children:[e.jsx("label",{htmlFor:"imageUrl",children:"Image"}),e.jsx("input",{ref:h,onChange:f,type:"file",name:"imageUrl",id:"imageUrl"}),t.previewImage&&e.jsxs("div",{className:s.img_container,children:[e.jsx("img",{width:200,height:150,src:t.previewImage,alt:"service"}),e.jsx(P,{onClick:N,className:s.icon})]}),!t.previewImage&&t.img&&e.jsxs("div",{className:s.img_container,children:[e.jsx("img",{width:200,height:150,src:`https://storage.googleapis.com/abhicares-backend-bucket/${t.img}`,alt:"service"}),e.jsx(P,{onClick:w,className:s.icon})]})]}),e.jsxs("div",{className:s.input_container,children:[e.jsx("label",{htmlFor:"appHomepage",children:"App Homepage"}),e.jsxs("select",{onChange:j,value:t.appHomepage,className:s.input,name:"appHomepage",id:"appHomepage",children:[e.jsx("option",{value:"true",children:"True"}),e.jsx("option",{value:"false",children:"False"})]})]}),e.jsxs("div",{className:s.input_container,children:[e.jsx("label",{htmlFor:"webHomepage",children:"Web Homepage"}),e.jsxs("select",{onChange:j,value:t.webHomepage,className:s.input,name:"webHomepage",id:"webHomepage",children:[e.jsx("option",{value:"true",children:"True"}),e.jsx("option",{value:"false",children:"False"})]})]}),e.jsx("div",{className:s.button_wrapper,children:e.jsx("button",{className:s.button,children:I?"Loading...":a?"Update":"Add"})})]})]})})},Ie=()=>{const{res:i,fetchData:D,isLoading:a}=z(),{res:l,fetchData:d,isLoading:H}=K(),[I,_]=o.useState(!1),[v,t]=o.useState(!1),[p,h]=o.useState(!1),[f,j]=o.useState([]),[N,w]=o.useState({}),m=F(),{state:C}=L(),c=M();S();const g=(r,x)=>{r.stopPropagation(),w(x),t(!p)},n=(r,x)=>{r.stopPropagation(),w(x),h(!p)},u=async()=>{D(`/admin/get-category-service/${c==null?void 0:c.categoryId}`)};o.useEffect(()=>{u()},[]),o.useEffect(()=>{((i==null?void 0:i.status)===200||(i==null?void 0:i.status)===201)&&j(i==null?void 0:i.data.data)},[i]);const k=async()=>{d(`/admin/delete-service/${N}`)};return o.useEffect(()=>{((l==null?void 0:l.status)===200||(l==null?void 0:l.status)===201)&&(y.success("Service deleted successfully"),u(),h(!p))},[l]),e.jsxs(e.Fragment,{children:[e.jsx(U,{children:e.jsxs("div",{className:b["services-wrapper"],children:[e.jsxs("div",{className:b["services-header"],children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Sub-Categories"}),e.jsx("h4",{style:{marginTop:"30px"},children:C.categoryName})]}),e.jsx("button",{onClick:()=>_(!0),className:b.services_add_btn,children:e.jsx("img",{src:$,alt:"add service"})})]}),e.jsxs("div",{className:b.card_container,children:[!a&&f.length===0&&e.jsx("p",{children:"No service found"}),a&&f.length===0&&e.jsx(Q,{}),f==null?void 0:f.map(r=>e.jsxs("div",{onClick:()=>m(`/admin/services/${c==null?void 0:c.categoryId}/product/${r._id}`,{state:r}),className:b.card,children:[e.jsx("img",{src:`https://storage.googleapis.com/abhicares-backend-bucket/${r.imageUrl}`,alt:"product"}),e.jsxs("div",{children:[e.jsxs("div",{className:V.heading_container,children:[e.jsx("h5",{children:r.name}),e.jsxs("div",{className:b.icon_container,children:[e.jsx(J,{onClick:x=>g(x,r),size:20}),e.jsx(T,{onClick:x=>n(x,r._id),size:22,color:"red"})]})]}),e.jsx("p",{children:E(r.description)})]})]},r._id))]})]})}),I&&e.jsx(A,{setIsModalOpen:_,categoryId:c==null?void 0:c.categoryId,getCategoryServices:u}),v&&e.jsx(A,{setIsModalOpen:t,service:N,getCategoryServices:u}),p&&e.jsx(G,{setState:h,handleDelete:k})]})};export{Ie as default};
