import{r as i,j as e,e as A}from"./index-if6yrKUM.js";import{W as I}from"./Wrapper-DsK8qFe2.js";import{c as a}from"./Shared.module-DD54I-nI.js";import{u as b,h as E,B as L}from"./index.esm-CdsNXrcl.js";import{L as k}from"./Loader-BnomTiAq.js";import{R as F}from"./index.esm-GoR2NAnb.js";import{h as V}from"./jspdf-html2canvas.min-CG1HE9vY.js";import{u as T}from"./usePostApiReq-b9urQUdc.js";import{f as u}from"./index-NDDHiImd.js";import{P as q}from"./react-bootstrap-pagination-control.esm-DLu67gnb.js";import"./logo -C1Nz5jdc.js";import"./useDispatch-D0Me-TH-.js";import"./iconBase-lzS6dEZZ.js";const U="_wrapper_7u2da_1",W="_modal_7u2da_27",Y="_heading_container_7u2da_45",z="_contianer_7u2da_61",G="_mt_7u2da_87",H="_btn_container_7u2da_95",J="_button_7u2da_109",K="_table_wrapper_7u2da_125",Q="_table_7u2da_125",X="_d_flex_7u2da_151",c={wrapper:U,modal:W,heading_container:Y,contianer:z,mt:G,btn_container:H,button:J,table_wrapper:K,table:Q,d_flex:X},Z=({setIsModalOpen:n})=>{const{res:l,fetchData:x,isLoading:d}=T(),[m,j]=i.useState(""),[o,r]=i.useState([]);o.map(t=>[{OrderId:t._id},{date:u(new Date(t.createdAt),"dd-MM-yyyy")},{value:0},{orderValue:t.orderValue},{time:u(new Date(t.createdAt),"hh.mm aaaaa'm'")},{name:t.user.name},{phone:t.user.phone}]);const p=()=>{V(document.querySelector("#table"),{jsPDF:{format:"a4"},imageType:"image/jpeg",output:"./pdf/generate.pdf"})},_=t=>{j(t.target.value)},f=async()=>{if(!m)return;const t=m.split("-");x("/admin/get-monthly-orders",{month:t[1],year:t[0]})};return i.useEffect(()=>{((l==null?void 0:l.status)===200||(l==null?void 0:l.status)===201)&&(console.log("monthlyOrdersRes",l),n(!0),r(l==null?void 0:l.data.data))},[l]),e.jsx("div",{className:c.wrapper,children:e.jsxs("div",{className:c.modal,children:[e.jsxs("div",{className:c.heading_container,children:[e.jsx("h4",{children:"Monthly Orders"}),e.jsxs("div",{className:c.d_flex,children:[e.jsxs("div",{className:a.d_flex,children:[e.jsx("input",{onChange:_,type:"month",name:"month",id:"month"}),e.jsx("button",{onClick:f,children:d?"Loading...":"Submit"})]}),e.jsx(F,{onClick:()=>n(!1),cursor:"pointer",size:26})]})]}),o.length===0&&e.jsx("p",{style:{padding:"0px 0px 20px 20px"},children:"No orders found."}),o.length>0&&e.jsxs("div",{className:a["report-body"],children:[e.jsx("div",{id:"table",className:c.table_wrapper,children:e.jsxs("table",{border:"2px",className:c.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"OrderId"}),e.jsx("th",{children:"Order Date"}),e.jsx("th",{children:"Total Value"}),e.jsx("th",{children:"Order Time"}),e.jsx("th",{children:"User Name"}),e.jsx("th",{children:"User Mobile"})]})}),e.jsx("tbody",{children:o.map(t=>e.jsxs("tr",{children:[e.jsx("td",{style:{width:"210px",paddingInline:"10px"},children:t==null?void 0:t.orderId}),e.jsx("td",{style:{width:"160px"},children:u(new Date(t.createdAt),"dd-MM-yyyy")}),e.jsx("td",{children:t.orderValue}),e.jsx("td",{children:u(new Date(t.createdAt),"hh.mm aaaaa'm'")}),e.jsx("td",{children:t.user.name}),e.jsx("td",{children:t.user.phone})]}))})]})}),e.jsx("div",{className:c.btn_container,children:e.jsx("button",{className:c.button,onClick:p,children:"Download"})})]})]})})},he=()=>{const{res:n,fetchData:l,isLoading:x}=b(),{res:d,fetchData:m,error:j,isLoading:o}=b(),[r,p]=i.useState([]),[_,f]=i.useState(!1),[t,D]=i.useState({startDate:"",endDate:"",status:""}),g=s=>{const{name:h,value:P}=s.target;D({...t,[h]:P})},y=i.useRef(),C=A(),[w,S]=i.useState(1),[v,$]=i.useState(1),M=async s=>{$(s)},N=async()=>{l(`/admin/get-all-orders?page=${v}&status=${t.status}&startDate=${t.startDate}&endDate=${t.endDate}`)};i.useEffect(()=>{N()},[v,t.status,t.startDate,t.endDate]),i.useEffect(()=>{var s,h;((n==null?void 0:n.status)===200||(n==null?void 0:n.status)===201)&&(p(n==null?void 0:n.data.data),S(Number((h=(s=n==null?void 0:n.data)==null?void 0:s.pagination)==null?void 0:h.totalPages)))},[n]);const O=async()=>{const s=y.current.value;if(!s){N();return}m(`/admin/get-order-by-id?orderId=${s}`)};return i.useEffect(()=>{((d==null?void 0:d.status)===200||(d==null?void 0:d.status)===201)&&p([d==null?void 0:d.data.data])},[d]),i.useEffect(()=>{j&&p([])},[j]),e.jsxs(e.Fragment,{children:[e.jsx(I,{children:e.jsxs("div",{className:a["report-container"],children:[e.jsxs("div",{className:a["report-header"],children:[e.jsx("h1",{className:a["recent-Articles"],children:"Orders"}),e.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"flex-end"},children:[e.jsxs("div",{children:[e.jsx("p",{children:"Start Date"}),e.jsx("input",{type:"date",name:"startDate",value:t.startDate,onChange:g,className:a.filter_input})]}),e.jsxs("div",{children:[e.jsx("p",{children:"End Date"}),e.jsx("input",{type:"date",name:"endDate",value:t.endDate,onChange:g,className:a.filter_input})]}),e.jsxs("select",{name:"status",value:t.status,onChange:g,className:a.filter_input,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"OutOfDelivery",children:"OutOfDelivery"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]}),e.jsxs("div",{className:"d-flex",style:{position:"relative"},children:[e.jsx("input",{ref:y,style:{width:"300px",padding:"5px 10px",borderRadius:"5px"},type:"text",placeholder:"search order by id"}),e.jsx(E,{onClick:O,style:{position:"absolute",right:"8px",top:"10px",cursor:"pointer"}})]}),e.jsx("div",{className:a.d_flex,children:e.jsx("button",{onClick:()=>f(!0),children:e.jsx(L,{})})})]})]}),e.jsxs("div",{className:a["report-body"],children:[e.jsxs("div",{className:a["report-topic-heading"],children:[e.jsx("h3",{className:a["t-op"],style:{width:"200px"},children:"Order Id"}),e.jsx("h3",{className:a["t-op"],children:"Order Date"}),e.jsx("h3",{className:`${a["t-op"]}`,children:"Status"}),e.jsx("h3",{className:`${a["t-op"]}`,children:"Order Value"}),e.jsx("h3",{className:a["t-op"],children:"Details"})]}),e.jsxs("div",{className:a.items,children:[!x&&!o&&(r==null?void 0:r.length)===0&&e.jsx("p",{children:"No orders found"}),(x||o)&&e.jsx(k,{}),r==null?void 0:r.map((s,h)=>e.jsxs("div",{className:`${a.item1} ${a.cursor}`,children:[e.jsx("h3",{className:`${a["t-op-nextlvl"]}`,style:{width:"200px"},children:s.orderId}),e.jsx("h3",{className:a["t-op-nextlvl"],children:u(new Date(s.createdAt),"dd-MM-yyyy")}),e.jsx("h3",{className:`${a["t-op-nextlvl"]} ${a.status} ${s.status==="Cancelled"?a.Cancelled:s.status==="Completed"?a.Completed:s.status==="pending"?a.pending:a.OutOfDelivery}`,children:s.status}),e.jsxs("h3",{className:`${a["t-op-nextlvl"]}`,children:["â‚¹",s.orderValue]}),e.jsx("h3",{className:a["t-op-nextlvl"],children:e.jsx("button",{onClick:()=>C(`/admin/Orders/${s._id}`,{state:s}),className:a.button,children:"View Details"})})]},h))]}),e.jsx("div",{style:{marginTop:"20px"},children:e.jsx(q,{changePage:M,limit:10,page:v,total:w+"0"})})]})]})}),_&&e.jsx(Z,{setIsModalOpen:f})]})};export{he as default};
