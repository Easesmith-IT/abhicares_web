import{d as A,j as e,r as l,_ as v}from"./index-CGylhn6U.js";import{A as N,z as S}from"./index.esm-BJ_kW8OL.js";import{u as L}from"./usegelocation-CZSQBNBP.js";import{u as $}from"./usePatchApiReq-CoISmjAR.js";import{u as B}from"./usePostApiReq-C7INsCRY.js";const G="_modal_overlay_1ceo1_1",U="_modal_open_1ceo1_21",P="_modal_close_1ceo1_33",W="_modal_wrapper_1ceo1_41",Y="_modal_1ceo1_1",q="_p_1ceo1_103",M="_mt_1ceo1_113",K="_input_box_1ceo1_121",O="_defaultAddress_1ceo1_137",T="_input_1ceo1_121",Z="_button_1ceo1_165",D="_radio_wrapper_1ceo1_189",H="_radio_1ceo1_189",s={modal_overlay:G,modal_open:U,modal_close:P,modal_wrapper:W,modal:Y,p:q,mt:M,input_box:K,defaultAddress:O,input:T,button:Z,radio_wrapper:D,radio:H},J=({isOpen:u,closeCurrentLocationAddModal:d,setAddressInfo:r})=>{const{location:a}=L(),t=()=>{r(p=>({...p,addressLine:a.formattedAddress,pincode:a.pincode,city:a.city})),d(!1)};return e.jsx("div",{className:`${s.modal_overlay} ${u?s.modal_open:s.modal_close}`,children:e.jsxs("div",{className:s.modal_wrapper,children:[e.jsx("button",{onClick:d,className:s.modal_close,children:e.jsx(N,{size:20})}),e.jsxs("div",{className:s.modal,children:[a&&e.jsx("p",{children:a.formattedAddress}),e.jsx("button",{type:"submit",className:s.button,onClick:t,children:"Confirm Address"})]})]})})},Q=A.GoogleApiWrapper({apiKey:"AIzaSyB_ZhYrt0hw7zB74UYGhh4Wt_IkltFzo-I"})(J),V=({isOpen:u,setIsAddAddressModalOpen:d,getAllAddress:r,Data:a=""})=>{const{res:t,fetchData:p,isLoading:C}=B(),{location:i,status:m}=L();console.log("status",m),console.log("location",i);const[k,f]=l.useState(!1),[w,j]=l.useState(!1),[o,y]=l.useState({addressLine:a.addressLine||"",pincode:a.pincode||"",landmark:a.landmark,defaultAddress:a.defaultAddress||!1,city:a.city||""}),[b,g]=l.useState(""),c=_=>{const{name:h,value:x}=_.target;y({...o,[h]:x})},{res:n,fetchData:F}=$(),I=async _=>{if(_.preventDefault(),!o.addressLine||!o.pincode||!o.city||!o.landmark){g("All fields are required.");return}if(g(""),a)await F(`/shopping/update-user-address/${a._id}`,{...o});else{const h={coordinates:[i.geometry.lat,i.geometry.lng]},x={...o,location:h,city:i.city};p("/shopping/create-user-address",x)}};l.useEffect(()=>{((t==null?void 0:t.status)===200||(t==null?void 0:t.status)===201)&&(d(!1),v.success("Address created successfully"),r())},[t]);const z=()=>{m!=="granted"?(console.log("inside if"),j(!0)):(console.log("inside else"),f(!0),j(!1))},E=()=>{f(!1)};return l.useEffect(()=>{((n==null?void 0:n.status)===200||(n==null?void 0:n.status)===201)&&(v.success("Address updated successfully"),r(),d(!1))},[n]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`${s.modal_overlay} ${u?s.modal_open:s.modal_close}`,children:e.jsxs("div",{className:s.modal_wrapper,children:[e.jsx("button",{onClick:()=>d(!1),className:s.modal_close,children:e.jsx(N,{size:20})}),e.jsx("div",{className:s.modal,children:e.jsxs("form",{onSubmit:I,children:[e.jsxs("p",{className:s.p,children:[a?"Update":"Add"," address"]}),e.jsxs("div",{className:s.mt,children:[e.jsx("label",{htmlFor:"addressLine",children:"Address Line"}),e.jsx("div",{className:s.input_box,children:e.jsx("input",{className:s.input,onChange:c,value:o.addressLine,type:"text",name:"addressLine",id:"addressLine",placeholder:"Enter address line"})})]}),e.jsxs("div",{className:s.mt,children:[e.jsx("label",{htmlFor:"city",children:"City"}),e.jsx("div",{className:s.input_box,children:e.jsx("input",{className:s.input,onChange:c,value:o.city,type:"text",name:"city",id:"city",placeholder:"Enter city"})})]}),e.jsxs("div",{className:s.mt,children:[e.jsx("label",{htmlFor:"pincode",children:"Pincode"}),e.jsx("div",{className:s.input_box,children:e.jsx("input",{className:s.input,onChange:c,value:o.pincode,type:"number",name:"pincode",id:"pincode",placeholder:"Enter pincode"})})]}),e.jsxs("div",{className:s.mt,children:[e.jsx("label",{htmlFor:"landmark",children:"Landmark"}),e.jsx("div",{className:s.input_box,children:e.jsx("input",{className:s.input,onChange:c,value:o.landmark,type:"text",name:"landmark",id:"landmark",placeholder:"Enter landmark"})})]}),e.jsxs("div",{className:s.mt,children:[e.jsx("label",{htmlFor:"defaultAddress",children:"Default Address"}),e.jsxs("select",{className:`${s.input_box} ${s.defaultAddress}`,onChange:c,value:o.defaultAddress,name:"defaultAddress",id:"defaultAddress",children:[e.jsx("option",{value:"true",children:"True"}),e.jsx("option",{value:"false",children:"False"})]})]}),e.jsxs("button",{type:"button",className:s.button,onClick:z,disabled:w,style:{color:m!=="granted"?"grey":"black"},children:[e.jsx(S,{}),m==="granted"?"Use Current Location":"Location Disabled"]}),b&&e.jsxs("p",{style:{color:"red",marginTop:"10px"},children:["*",b]}),e.jsx("button",{type:"submit",className:s.button,children:C?"Loading...":a?"Update":"Proceed"})]})})]})}),e.jsx(Q,{isOpen:k,closeCurrentLocationAddModal:E,setAddressInfo:y})]})},oe=A.GoogleApiWrapper({apiKey:"AIzaSyB_ZhYrt0hw7zB74UYGhh4Wt_IkltFzo-I"})(V);export{oe as A};
