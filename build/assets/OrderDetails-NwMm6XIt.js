import{n as W,r as c,e as B,u as F,_ as G,j as s}from"./index-CGylhn6U.js";import{W as Q}from"./Wrapper-CdkfNuyb.js";import{u as z}from"./usePostApiReq-C7INsCRY.js";import{u as H}from"./index.esm-BJ_kW8OL.js";import{f as t}from"./index-DMx44xLR.js";import"./logo -C1Nz5jdc.js";import"./useDispatch-Dqrl4_SR.js";import"./iconBase-BOE9-_A9.js";const J="_wrapper_xu49t_1",K="_left_div_xu49t_19",R="_select_xu49t_33",X="_info_xu49t_45",Y="_heading_xu49t_55",Z="_container_xu49t_67",ee="_item_xu49t_91",se="_img_xu49t_115",ie="_right_div_xu49t_125",ne="_right_div_top_xu49t_133",de="_right_div_bottom_xu49t_135",oe="_d_flex_xu49t_157",n={wrapper:J,left_div:K,select:R,info:X,heading:Y,container:Z,item:ee,img:se,right_div:ie,right_div_top:ne,right_div_bottom:de,d_flex:oe},je=()=>{var _,j,g,v,N,b,y,k,D,T,I,P;const{res:l,fetchData:A,isLoading:re}=z(),{res:o,fetchData:w,isLoading:ce}=H(),{state:a}=W(),[$,L]=c.useState(0),[le,h]=c.useState(0),[ae,x]=c.useState(0),p=B(),[e,q]=c.useState(a||""),[E,m]=c.useState(a==null?void 0:a.status),{id:O}=F();console.log("stateData",a);const f=async()=>{w(`/admin/get-order-details?orderId=${O}`)};c.useEffect(()=>{f()},[e==null?void 0:e._id]),c.useEffect(()=>{var i,r,u;((o==null?void 0:o.status)===200||(o==null?void 0:o.status)===201)&&(console.log("getOrderRes",o),q((i=o==null?void 0:o.data)==null?void 0:i.data),m((u=(r=o==null?void 0:o.data)==null?void 0:r.data)==null?void 0:u.status))},[o]);const M=async i=>{const r=i.target.value;m(()=>r),A(`/admin/change-order-status/${e==null?void 0:e._id}`,{status:r})};return c.useEffect(()=>{((l==null?void 0:l.status)===200||(l==null?void 0:l.status)===201)&&(G.success("Order status changed successfully"),f())},[l]),c.useEffect(()=>{if(e!=null&&e.items&&(e==null?void 0:e.items.length)>0){let i=0;for(const d of e.items)d!=null&&d.product?i=i+Number(d.quantity*d.product.offerPrice):i=i+Number(d.quantity*d.package.offerPrice);h(()=>i);const r=Number(i)*18/100;L(r);const{discountType:u,couponFixedValue:C,offPercentage:U,maxDiscount:S}=(e==null?void 0:e.couponId)||{};if(e!=null&&e.couponId)if(u==="fixed")x(C),h(d=>d-Number(C));else{let d=Math.ceil(i*(Number(U)/100));d=d>S?S:d,console.log("offerTotal",d),x(d),h(V=>V-Number(d))}}},[e==null?void 0:e.orderValue,e==null?void 0:e.couponId,e,e==null?void 0:e.items,$,p]),s.jsx(Q,{children:s.jsxs("div",{className:n.wrapper,children:[s.jsxs("div",{className:n.left_div,children:[s.jsxs("div",{className:n.info,children:[s.jsxs("div",{children:[s.jsxs("h4",{children:["Order Id: ",e==null?void 0:e.orderId]}),s.jsx("h5",{children:"Update Status"}),s.jsxs("select",{onChange:M,value:E,className:n.select,name:"status",id:"status",children:[s.jsx("option",{value:"Pending",children:"Pending"}),s.jsx("option",{value:"OutOfDelivery",children:"OutOfDelivery"}),s.jsx("option",{value:"Completed",children:"Completed"}),s.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),s.jsxs("div",{children:[s.jsxs("p",{children:["Date of Order:"," ",(e==null?void 0:e.createdAt)&&t(new Date(e==null?void 0:e.createdAt),"dd-MM-yyyy")]}),s.jsxs("p",{children:["Time of Order:"," ",(e==null?void 0:e.createdAt)&&t(new Date(e==null?void 0:e.createdAt),"hh:mm aa")]}),s.jsxs("p",{children:["Payment Type: ",e==null?void 0:e.paymentType]}),s.jsxs("p",{children:["No of Left Bookings: ",e==null?void 0:e.No_of_left_bookings]}),s.jsxs("p",{children:["Refund Amount: ",(_=e==null?void 0:e.refundInfo)==null?void 0:_.amount]}),s.jsxs("p",{children:["Refund Status: ",(j=e==null?void 0:e.refundInfo)==null?void 0:j.status]})]})]}),s.jsxs("p",{style:{marginTop:"20px"},children:["Admin Comment: ",e==null?void 0:e.adminComment]}),s.jsx("h5",{className:n.heading,children:"Products"}),s.jsx("div",{className:n.container,children:(g=e==null?void 0:e.items)==null?void 0:g.map((i,r)=>s.jsxs("div",{onClick:()=>p(`/admin/bookings/${i==null?void 0:i.bookingId}`),style:{cursor:"pointer"},className:n.item,children:[s.jsxs("div",{children:[s.jsx("img",{className:n.img,src:`https://storage.googleapis.com/abhicares-backend-bucket/${i.package?i.package.imageUrl[0]:i.product.imageUrl[0]}`,alt:"product"}),s.jsxs("div",{children:[s.jsx("h6",{children:i.package?i.package.name:i.product.name}),s.jsx("p",{children:i.package?"Package":"Product"})]}),s.jsxs("div",{children:[s.jsx("p",{children:i.bookingId.bookingDate&&t(new Date(i.bookingId.bookingDate),"dd-MM-yyyy")}),s.jsx("p",{children:i.bookingId.bookingTime&&t(new Date(i.bookingId.bookingTime),"hh:mm aa")})]})]}),s.jsxs("p",{children:["Qty: ",i.quantity]}),s.jsxs("p",{children:["₹",Number(i.package?i.package.offerPrice:i.product.offerPrice)*Number(i.quantity)]})]},r))})]}),s.jsxs("div",{className:n.right_div,children:[s.jsxs("div",{className:n.right_div_top,children:[s.jsx("h5",{children:"Order Summary"}),s.jsxs("div",{className:n.heading,children:[s.jsx("p",{children:"Descriptions"}),s.jsx("p",{children:"Amounts"})]}),s.jsxs("div",{className:n.d_flex,children:[s.jsx("p",{children:"Sub Total :"}),s.jsxs("p",{children:["₹",e==null?void 0:e.itemTotal]})]}),s.jsxs("div",{className:n.d_flex,children:[s.jsx("p",{children:"Tax and other charges :"}),s.jsxs("p",{children:["+ ₹",e==null?void 0:e.tax]})]}),(e==null?void 0:e.discount)>0&&s.jsxs("div",{className:n.d_flex,children:[s.jsxs("p",{children:["Discount ('",(v=e==null?void 0:e.couponId)==null?void 0:v.name,"') :"]}),s.jsxs("p",{children:["- ₹",e==null?void 0:e.discount]})]}),(e==null?void 0:e.referalDiscount)>0&&s.jsxs("div",{className:n.d_flex,children:[s.jsx("p",{children:"Referal Discount :"}),s.jsxs("p",{children:["- ₹",e==null?void 0:e.referalDiscount]})]}),s.jsxs("div",{className:n.d_flex,children:[s.jsx("p",{children:"Total Amount :"}),s.jsxs("p",{children:["₹",e==null?void 0:e.orderValue]})]})]}),s.jsxs("div",{className:n.right_div_bottom,children:[s.jsx("h5",{children:"Customer Details"}),s.jsxs("div",{className:n.d_flex,children:[s.jsx("p",{children:"Customer Name :"}),s.jsx("p",{children:(N=e==null?void 0:e.user)==null?void 0:N.name})]}),s.jsxs("div",{className:n.d_flex,children:[s.jsx("p",{children:"Customer Phone :"}),s.jsx("p",{children:(b=e==null?void 0:e.user)==null?void 0:b.phone})]}),s.jsxs("div",{className:n.d_flex,children:[s.jsx("p",{children:"Customer Address :"}),s.jsx("p",{children:`${(k=(y=e==null?void 0:e.user)==null?void 0:y.address)==null?void 0:k.addressLine},${(T=(D=e==null?void 0:e.user)==null?void 0:D.address)==null?void 0:T.landmark},${(P=(I=e==null?void 0:e.user)==null?void 0:I.address)==null?void 0:P.pincode}`})]})]})]})]})})};export{je as default};
