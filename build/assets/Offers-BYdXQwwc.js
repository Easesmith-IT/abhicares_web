import{r as l,e as q,_ as O,j as e}from"./index-BgkP9pz8.js";import{p as z}from"./index-BDlzfcse.js";import{W as $,c as j}from"./Wrapper-DS_6NVVl.js";import{F as W}from"./index.esm-BFuDLeVr.js";import{u as L,a as B}from"./index.esm-DnL9X2Ej.js";import{A as G}from"./add-icon-nobg-CDiYK8IX.js";import{R as Q}from"./index.esm-BP34_6mW.js";import{R as H}from"./index-COgJYnRU.js";/* empty css                   */import{u as J}from"./useAuthorization-tWnY0z3a.js";import{u as K}from"./usePatchApiReq-DS05ZUpu.js";import{u as X}from"./usePostApiReq-Y-Z3zkKe.js";import{D as Y}from"./DeleteModal-JeY62UYi.js";import{L as Z}from"./Loader-DZZMpz-K.js";import{u as R}from"./useDeleteApiReq-BaGwvOuV.js";import"./logo -C1Nz5jdc.js";import"./iconBase-BAuAS9aP.js";const ee="_container_14vyw_1",se="_city_14vyw_17",te="_d_flex_14vyw_39",ae="_p_14vyw_51",ne="_city_right_14vyw_61",N={container:ee,city:se,d_flex:te,p:ae,city_right:ne},ie="_wrapper_89j9y_1",ce="_modal_89j9y_27",le="_heading_container_89j9y_47",oe="_form_89j9y_59",re="_input_container_89j9y_73",de="_input_89j9y_73",pe="_button_wrapper_89j9y_105",ue="_button_89j9y_105",he="_categories_89j9y_131",i={wrapper:ie,modal:ce,heading_container:le,form:oe,input_container:re,input:de,button_wrapper:pe,button:ue,categories:he},xe=o=>{const s=/\s/.test(o),f=[...o].every(c=>c===c.toUpperCase());return!!(!s&&f)};function me(o){return o.toUpperCase().replace(/\s+/g,"")}const I=({setIsModalOpen:o,offer:s="",getAllOffers:f})=>{const{res:c,fetchData:F,isLoading:P}=X(),{res:d,fetchData:D,isLoading:b}=L();J();const[g,_]=l.useState((s==null?void 0:s.description)||""),[u,T]=l.useState((s==null?void 0:s.categoryType)||[]);l.useState(!1);const[a,C]=l.useState({name:(s==null?void 0:s.name)||"",offPercentage:(s==null?void 0:s.offPercentage)||"",noOfTimesPerUser:(s==null?void 0:s.noOfTimesPerUser)||1,status:(s==null?void 0:s.status)||!0,type:(s==null?void 0:s.discountType)||"",upTo:(s==null?void 0:s.maxDiscount)||"",offerValue:(s==null?void 0:s.fixedCouponValue)||"",categoryType:u}),[m,p]=l.useState([]),h=n=>{let{name:t,value:x}=n.target;t==="name"&&(x=me(x)),C({...a,[t]:x})},y=async()=>{D("/admin/get-all-category")};l.useEffect(()=>{y()},[]),l.useEffect(()=>{var n;((d==null?void 0:d.status)===200||(d==null?void 0:d.status)===201)&&p((n=d==null?void 0:d.data)==null?void 0:n.data)},[d]),q(),console.log("selectedItems",u),console.log("offerInfo",a);const S=n=>{const{value:t,checked:x}=n.target;T(x?v=>[...v,t]:v=>v.filter(U=>U!==t))},{res:r,fetchData:A}=K(),w=async n=>{n.preventDefault();const{name:t,offPercentage:x,type:v,offerValue:U,upTo:E,noOfTimesPerUser:k,categoryType:je}=a,M=!t||!v||!k||u.length===0||(v==="percentage"?!x||!E:!U),V=!g;if(console.log("isDescriptionMissing",V),console.log("isOfferMissing",M),console.log("isOfferMissing || isDescriptionMissing",M||V),M||V){O.error("All fields are required");return}if(!xe(a.name)){O.error("Please enter valid coupon code");return}s?await A("/admin/update-coupon",{...a,description:g,maxDiscount:a.type==="fixed"?"":a.upTo,discountType:a.type,couponFixedValue:a.type==="fixed"?a.offerValue:"",categoryType:u,offPercentage:a.type==="fixed"?"":a.offPercentage,id:s._id}):F("/admin/create-coupon",{...a,description:g,maxDiscount:a.type==="fixed"?"":a.upTo,discountType:a.type,couponFixedValue:a.type==="fixed"?a.offerValue:"",categoryType:u,offPercentage:a.type==="fixed"?"":a.offPercentage})};return l.useEffect(()=>{((r==null?void 0:r.status)===200||(r==null?void 0:r.status)===201)&&(console.log("updateOfferRes",r),O.success("Offer updated successfully"),f(),o(!1))},[r]),l.useEffect(()=>{((c==null?void 0:c.status)===200||(c==null?void 0:c.status)===201)&&(O.success("Offer added successfully"),f(),o(!1))},[c]),e.jsx("div",{className:i.wrapper,children:e.jsxs("div",{className:i.modal,children:[e.jsxs("div",{className:i.heading_container,children:[e.jsxs("h4",{children:[s?"Update":"Add"," Offer"]}),e.jsx("div",{className:i.d_flex,children:e.jsx(Q,{onClick:()=>o(!1),cursor:"pointer",size:26})})]}),e.jsxs("form",{onSubmit:w,className:i.form,children:[e.jsxs("div",{className:i.input_container,children:[e.jsx("label",{htmlFor:"name",children:"Coupon Code (in block letters and without space)"}),e.jsx("input",{className:i.input,onChange:h,value:a.name,type:"text",name:"name",id:"name"})]}),e.jsxs("div",{className:i.input_container,children:[e.jsx("label",{htmlFor:"categoryType",children:"Category"}),e.jsxs("div",{className:i.categories,children:[m.length>0&&!b&&(m==null?void 0:m.map(n=>e.jsxs("div",{style:{display:"flex",gap:"6px",alignItems:"center"},children:[e.jsx("input",{style:{width:"20px",height:"20px"},type:"checkbox",value:n==null?void 0:n._id,id:n==null?void 0:n._id,name:n==null?void 0:n._id,checked:u.some(t=>t===(n==null?void 0:n._id)),onChange:S}),e.jsx("label",{htmlFor:n==null?void 0:n._id,children:n==null?void 0:n.name})]}))),m.length===0&&b&&e.jsx("p",{children:"Loading..."}),m.length===0&&!b&&e.jsx("p",{children:"No Categories found"})]})]}),!s&&e.jsxs("div",{className:i.input_container,children:[e.jsx("label",{htmlFor:"type",children:"Coupon Type"}),e.jsxs("select",{className:i.input,onChange:h,value:a.type,name:"type",id:"type",children:[e.jsx("option",{value:"",children:"Select Coupon Type"}),e.jsx("option",{value:"percentage",children:"Percentage"}),e.jsx("option",{value:"fixed",children:"Fixed"})]})]}),a.type==="percentage"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:i.input_container,children:[e.jsx("label",{htmlFor:"offPercentage",children:"Offer Percentage"}),e.jsx("input",{className:i.input,onChange:h,value:a.offPercentage,type:"number",name:"offPercentage",id:"offPercentage"})]}),e.jsxs("div",{className:i.input_container,children:[e.jsx("label",{htmlFor:"upTo",children:"Up To"}),e.jsx("input",{className:i.input,onChange:h,value:a.upTo,type:"number",name:"upTo",id:"upTo"})]})]}),a.type==="fixed"&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:i.input_container,children:[e.jsx("label",{htmlFor:"offerValue",children:"Offer Value"}),e.jsx("input",{className:i.input,onChange:h,value:a.offerValue,type:"number",name:"offerValue",id:"offerValue"})]})}),e.jsxs("div",{className:i.input_container,children:[e.jsx("label",{htmlFor:"noOfTimesPerUser",children:"No of Times Per User"}),e.jsx("input",{className:i.input,onChange:h,value:a.noOfTimesPerUser,type:"number",name:"noOfTimesPerUser",id:"noOfTimesPerUser"})]}),s&&e.jsxs("div",{className:i.input_container,children:[e.jsx("label",{htmlFor:"status",children:"Status"}),e.jsxs("select",{className:i.input,onChange:h,value:a.status,name:"status",id:"status",children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"InActive"})]})]}),e.jsxs("div",{className:i.input_container,children:[e.jsx("label",{htmlFor:"description",children:"Description"}),e.jsx(H,{theme:"snow",value:g,onChange:_})]}),e.jsx("div",{className:i.button_wrapper,children:e.jsx("button",{className:i.button,children:P?"Loading...":s?"Update":"Add"})})]})]})})},Me=()=>{const{res:o,fetchData:s,isLoading:f}=R(),{res:c,fetchData:F,isLoading:P}=L(),[d,D]=l.useState(!1),[b,g]=l.useState(!1),[_,u]=l.useState(!1),[T,a]=l.useState({}),[C,m]=l.useState([]),[p,h]=l.useState([]),[y,S]=l.useState("all");l.useEffect(()=>{const t=C.filter(x=>x.status===y);h(y==="all"?C:t)},[y,C]),console.log("filteredCoupons",p);const r=async()=>{F("/admin/get-coupons")};l.useEffect(()=>{r()},[]),l.useEffect(()=>{((c==null?void 0:c.status)===200||(c==null?void 0:c.status)===201)&&m(c==null?void 0:c.data.data)},[c]);const A=t=>{a(t),g(!_)},w=t=>{a(t),u(!_)},n=async()=>{s(`/admin/delete-coupon/${T}`)};return l.useEffect(()=>{((o==null?void 0:o.status)===200||(o==null?void 0:o.status)===201)&&(O.success("Offer deleted successfully"),r(),u(!_))},[o]),e.jsxs(e.Fragment,{children:[e.jsx($,{children:e.jsxs("div",{className:j["report-container"],children:[e.jsxs("div",{className:j["report-header"],children:[e.jsx("h1",{className:j["recent-Articles"],children:"Offers"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"20px"},children:[e.jsxs("select",{className:j.input,onChange:t=>S(t.target.value),value:y,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"})]}),e.jsx("button",{onClick:()=>D(!0),className:j.services_add_btn,children:e.jsx("img",{src:G,alt:"add"})})]})]}),e.jsxs("div",{className:N.container,children:[!P&&(p==null?void 0:p.length)===0&&e.jsx("p",{children:"No offers found"}),P&&(p==null?void 0:p.length)===0&&e.jsx(Z,{}),p==null?void 0:p.map(t=>e.jsxs("div",{className:N.city,children:[e.jsxs("div",{className:N.city_left,children:[e.jsx("h5",{children:t.name}),e.jsxs("div",{className:N.d_flex,children:[(t==null?void 0:t.discountType)==="fixed"?e.jsxs("p",{children:["â‚¹",t.couponFixedValue]}):e.jsxs("p",{children:[t.offPercentage,"%"]}),e.jsx("p",{className:`${j.status} ${t.status==="active"?j.active:j.inactive}`,children:t.status})]}),e.jsxs("p",{children:[e.jsx("b",{children:"Type:"})," ",t==null?void 0:t.discountType]}),e.jsx("p",{className:N.p,children:z(t.description)})]}),e.jsxs("div",{className:N.city_right,children:[e.jsx(W,{onClick:()=>A(t),cursor:"pointer",size:20}),e.jsx(B,{onClick:()=>w(t._id),cursor:"pointer",size:22,color:"red"})]})]},t._id))]})]})}),d&&e.jsx(I,{setIsModalOpen:D,getAllOffers:r}),b&&e.jsx(I,{setIsModalOpen:g,getAllOffers:r,offer:T}),_&&e.jsx(Y,{handleDelete:n,setState:u})]})};export{Me as default};
