import{r as t,e as os,j as s,f as Z,_ as as,p as is}from"./index-DmceSUEu.js";import{W as cs}from"./Wrapper-CijAMONv.js";import{T as f}from"./TimeLine-DJ-F2EbP.js";import{c as a}from"./AddResoulationModal.module-DEfsxiwO.js";import{R as k}from"./index.esm-CK3PNbdM.js";/* empty css                   */import{u as ls}from"./useAuthorization-C8MmfE-L.js";import{p as ts}from"./index-CyJCqZ_n.js";import{f as X}from"./index-DSEmMwTb.js";import{B as hs}from"./Button-CbLLSuQr.js";import"./logo -C1Nz5jdc.js";import"./LogoutModal-BO_6Xxx7.js";import"./iconBase-CgRV0d11.js";import"./index.esm-Btv2RgTK.js";const ms=({setIsModalOpen:l,id:n,getTicketDetails:h})=>{(()=>{const c=new Date,r=String(c.getDate()).padStart(2,"0"),p=String(c.getMonth()+1).padStart(2,"0"),g=c.getFullYear();return`${r}/${p}/${g}`})();const[o,e]=t.useState({status:"",resolution:"",ticketId:n,date:""}),{checkAuthorization:j}=ls(),x=c=>{const{name:r,value:p}=c.target;e({...o,[r]:p})};os();const u=async c=>{if(c.preventDefault(),!(!o.resolution||!o.status))try{const{data:r}=await Z.patch("https://abhicares.com/api/admin/update-ticket",{...o},{withCredentials:!0});as.success("Ticket updated successfully"),console.log("dataxghu :",r),h(),l(!1)}catch(r){console.log(r),l(!1),j(r)}};return s.jsx("div",{className:a.wrapper,children:s.jsxs("div",{className:a.modal,children:[s.jsxs("div",{className:a.heading_container,children:[s.jsx("h4",{children:"Add Resoulation"}),s.jsx("div",{className:a.d_flex,children:s.jsx(k,{onClick:()=>l(!1),cursor:"pointer",size:26})})]}),s.jsxs("form",{onSubmit:u,className:a.form,children:[s.jsxs("div",{className:a.input_container,children:[s.jsx("label",{htmlFor:"status",children:"Status"}),s.jsxs("select",{name:"status",value:o.status,onChange:x,className:a.input,children:[s.jsx("option",{value:"",children:"Select status"}),s.jsx("option",{value:"raised",children:"Raised"}),s.jsx("option",{value:"in-review",children:"In review"}),s.jsx("option",{value:"completed",children:"Completed"})]})]}),s.jsxs("div",{className:a.input_container,children:[s.jsx("label",{htmlFor:"resolution",children:"Resolution"}),s.jsx("input",{className:a.input,onChange:x,value:o.resolution,type:"text",name:"resolution",id:"resolution"})]}),s.jsxs("div",{className:a.input_container,children:[s.jsx("label",{htmlFor:"date",children:"Date"}),s.jsx("input",{className:a.input,onChange:x,value:o.date,type:"date",name:"date",id:"date"})]}),s.jsx("div",{className:a.button_wrapper,children:s.jsx("button",{onClick:u,className:a.button,children:"Resolve"})})]})]})})},ps="_wrapper_qpe1i_1",xs="_modal_qpe1i_27",us="_heading_container_qpe1i_47",js="_service_qpe1i_59",gs="_icon_qpe1i_67",_s="_d_flex_qpe1i_79",fs="_features_qpe1i_93",vs="_feature_qpe1i_93",bs="_feature_wrapper_qpe1i_137",Ns="_feature_img_qpe1i_151",Is="_feature_content_qpe1i_175",ys="_icons_cotainer_qpe1i_185",i={wrapper:ps,modal:xs,heading_container:us,service:js,icon:gs,d_flex:_s,features:fs,feature:vs,feature_wrapper:bs,feature_img:Ns,feature_content:Is,icons_cotainer:ys},ws=({setIsModalOpen:l,service:n})=>{var h;return s.jsx("div",{className:i.wrapper,children:s.jsxs("div",{className:i.modal,children:[s.jsxs("div",{className:i.heading_container,children:[s.jsx("h4",{children:"Service Details"}),s.jsx("div",{className:i.d_flex,children:s.jsx(k,{onClick:()=>l(!1),cursor:"pointer",size:26})})]}),s.jsxs("div",{className:i.service,children:[s.jsxs("div",{className:i.d_flex,children:[s.jsx("div",{children:s.jsx("img",{className:i.icon,src:`https://storage.googleapis.com/abhicares-backend-bucket/${n.imageUrl}`,alt:"icon"})}),s.jsxs("div",{children:[s.jsx("h4",{children:n==null?void 0:n.name}),s.jsx("div",{children:s.jsxs("p",{children:["Starting Price: â‚¹",n==null?void 0:n.startingPrice]})}),s.jsx("p",{children:(n==null?void 0:n.description)&&ts(n==null?void 0:n.description)})]})]}),s.jsx("h5",{children:"Features"}),s.jsx("div",{className:i.features,children:(h=n==null?void 0:n.features)==null?void 0:h.map((d,o)=>s.jsx("div",{className:i.feature,children:s.jsxs("div",{className:i.feature_wrapper,children:[s.jsx("div",{className:i.feature_img,children:s.jsx("img",{src:`https://storage.googleapis.com/abhicares-backend-bucket/${d==null?void 0:d.image}`,alt:"feature"})}),s.jsxs("div",{className:i.feature_content,children:[s.jsx("h5",{children:d==null?void 0:d.title}),s.jsx("p",{children:d==null?void 0:d.description})]})]})}))}),(n==null?void 0:n.features.length)===0&&s.jsx("p",{children:"No features found"})]})]})})},Hs=()=>{var v,b,N,I,y,w,S,C,$,R,T,q,A,M,P,B,F,L,O,z,H,E,U,V,W,Y,G,J,K;t.useState("in-progress");const[l,n]=t.useState(!1),[h,d]=t.useState(!1),o=is(),[e,j]=t.useState(""),[x,u]=t.useState(!0),c=async()=>{try{const{data:m}=await Z.get(`https://abhicares.com/api/admin/get-single-ticket?ticketId=${o==null?void 0:o.ticketId}`,{withCredentials:!0});console.log("details of ticket",m),j(m.ticket)}catch(m){console.log(m)}finally{u(!1)}};t.useEffect(()=>{c()},[]);const r=m=>{var Q;return(Q=e==null?void 0:e.ticketHistory)==null?void 0:Q.find(_=>(_==null?void 0:_.status)===m)},{addressLine:p,city:g,pincode:D,landmark:ss}=((v=e==null?void 0:e.bookingId)==null?void 0:v.userAddress)||{},{addressLine:es,city:ns,pincode:rs,state:ds}=((b=e==null?void 0:e.sellerId)==null?void 0:b.address)||{};return s.jsxs(cs,{children:[s.jsxs("div",{className:"container",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"card left",children:[s.jsxs("div",{className:"header",children:[s.jsxs("div",{children:[s.jsx("h3",{children:"Update status"}),(e==null?void 0:e.status)!=="completed"&&s.jsx("button",{onClick:n,className:"button",children:"Update"}),l&&s.jsx(ms,{setIsModalOpen:n,getTicketDetails:c,id:o.ticketId})]}),s.jsxs("div",{children:[s.jsx("p",{children:e==null?void 0:e.ticketId}),s.jsx("p",{children:(e==null?void 0:e.createdAt)&&X(new Date(e==null?void 0:e.createdAt),"dd MMMM, yyyy HH:mm:ss")})]})]}),s.jsxs("div",{className:"content",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Raised Id:"})," ",(e==null?void 0:e.raisedBy)==="customer"?(N=e==null?void 0:e.userId)==null?void 0:N._id:(I=e==null?void 0:e.sellerId)==null?void 0:I._id]}),s.jsx("div",{className:"raisedby",children:s.jsxs("p",{children:[s.jsx("strong",{children:"Raised by:"})," ",(e==null?void 0:e.raisedBy)==="customer"?(y=e==null?void 0:e.userId)==null?void 0:y.name:(w=e==null?void 0:e.sellerId)==null?void 0:w.name,s.jsx("br",{}),(S=e==null?void 0:e.userId)==null?void 0:S.phone]})}),s.jsxs("p",{children:[s.jsx("strong",{children:"Concern (description):"})," ",e==null?void 0:e.description]})]})]}),s.jsxs("div",{className:"section card left-card",children:[s.jsx("h4",{children:"Customer Details"}),s.jsxs("div",{children:[s.jsx("b",{children:"Customer Name: "}),(C=e==null?void 0:e.userId)==null?void 0:C.name]}),s.jsxs("div",{children:[s.jsx("b",{children:"Customer Phone Number:"}),($=e==null?void 0:e.userId)==null?void 0:$.phone]}),s.jsxs("div",{children:[s.jsx("b",{children:"Address: "}),`${p}, ${ss}, ${g}, ${D}`]})]}),(e==null?void 0:e.sellerId)&&s.jsxs("div",{className:"section card left-card",children:[s.jsx("h4",{children:"Service Provider Details"}),s.jsxs("div",{children:[s.jsx("b",{children:"Service Provider Name: "}),(R=e==null?void 0:e.sellerId)==null?void 0:R.name]}),s.jsxs("div",{children:[s.jsx("b",{children:"Phone Number:"}),(T=e==null?void 0:e.sellerId)==null?void 0:T.phone]}),s.jsxs("div",{children:[s.jsx("b",{children:"Address: "}),`${es}, ${ns}, ${ds}, ${rs}`]})]})]}),s.jsxs("div",{className:"right",children:[s.jsxs("div",{className:"section card",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Booking Id:"})," ",(q=e==null?void 0:e.bookingId)==null?void 0:q.bookingId]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Service Booked:"}),s.jsxs("p",{children:[(A=e==null?void 0:e.serviceId)==null?void 0:A.name," ",(M=e==null?void 0:e.serviceId)!=null&&M.name?s.jsx(hs,{onClick:()=>d(!0),children:"View"}):"No service booked"]})]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Time: "}),((P=e==null?void 0:e.bookingId)==null?void 0:P.bookingTime)&&X(new Date((B=e==null?void 0:e.bookingId)==null?void 0:B.bookingTime),"hh:mm aa")]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Address: "}),(F=e==null?void 0:e.bookingId)==null?void 0:F.userAddress.addressLine]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Cost:"})," Rs",(L=e==null?void 0:e.bookingId)==null?void 0:L.orderValue]})]}),s.jsxs("div",{className:"section card card2",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Booking Id: "}),(O=e==null?void 0:e.bookingId)==null?void 0:O.bookingId]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Service Id: "}),(z=e==null?void 0:e.serviceId)==null?void 0:z._id]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Ticket Type: "}),e==null?void 0:e.ticketType," "]}),s.jsxs("div",{style:{marginTop:"20px",display:"flex",flexDirection:"column",gap:"20px"},children:[s.jsx(f,{title:"Raised",time:r("raised")?(H=r("raised"))==null?void 0:H.date:"",status:((E=r("raised"))==null?void 0:E.status)||"",className:r("raised")?"bg-green":"bg-gray",desc:((U=r("raised"))==null?void 0:U.resolution)||""}),s.jsx(f,{title:"In Progress",time:r("in-review")?(V=r("in-review"))==null?void 0:V.date:"",status:((W=r("in-review"))==null?void 0:W.status)||"",className:r("in-review")?"bg-green":"bg-gray",desc:((Y=r("in-review"))==null?void 0:Y.resolution)||""}),s.jsx(f,{title:"Completed",time:r("completed")?(G=r("completed"))==null?void 0:G.date:"",status:((J=r("completed"))==null?void 0:J.status)||"",className:r("completed")?"bg-green":"bg-gray",desc:((K=r("completed"))==null?void 0:K.resolution)||""})]})]})]})]}),h&&s.jsx(ws,{setIsModalOpen:d,service:e==null?void 0:e.serviceId})]})};export{Hs as default};
