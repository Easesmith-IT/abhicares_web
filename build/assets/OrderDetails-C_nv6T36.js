import{o as q,r as o,e as w,u as E,_ as O,j as s}from"./index-iVe9Vivd.js";import{W as M}from"./Wrapper-yQx_tRHn.js";import{u as U}from"./usePostApiReq-CXvXU-pP.js";import{u as V}from"./index.esm-BWkUA85f.js";import{f as y}from"./index-h5yRQfKO.js";import"./logo -C1Nz5jdc.js";import"./iconBase-CW1Jb1pT.js";const W="_wrapper_xu49t_1",B="_left_div_xu49t_19",F="_select_xu49t_33",G="_info_xu49t_45",Q="_heading_xu49t_55",z="_container_xu49t_67",H="_item_xu49t_91",J="_img_xu49t_115",K="_right_div_xu49t_125",R="_right_div_top_xu49t_133",X="_right_div_bottom_xu49t_135",Y="_d_flex_xu49t_157",d={wrapper:W,left_div:B,select:F,info:G,heading:Q,container:z,item:H,img:J,right_div:K,right_div_top:R,right_div_bottom:X,d_flex:Y},te=()=>{var m,f,_,j,g;const{res:l,fetchData:b,isLoading:Z}=U(),{res:n,fetchData:D,isLoading:ee}=V(),{state:a}=q(),[T,k]=o.useState(0),[se,u]=o.useState(0),[ie,h]=o.useState(0),P=w(),[e,C]=o.useState(a||""),[S,x]=o.useState(a==null?void 0:a.status),{id:A}=E();console.log("stateData",a);const p=async()=>{D(`/admin/get-order-details?orderId=${A}`)};o.useEffect(()=>{p()},[e==null?void 0:e._id]),o.useEffect(()=>{var i,c,t;((n==null?void 0:n.status)===200||(n==null?void 0:n.status)===201)&&(console.log("getOrderRes",n),C((i=n==null?void 0:n.data)==null?void 0:i.data),x((t=(c=n==null?void 0:n.data)==null?void 0:c.data)==null?void 0:t.status))},[n]);const I=async i=>{const c=i.target.value;x(()=>c),b(`/admin/change-order-status/${e==null?void 0:e._id}`,{status:c})};return o.useEffect(()=>{((l==null?void 0:l.status)===200||(l==null?void 0:l.status)===201)&&(O.success("Order status changed successfully"),p())},[l]),o.useEffect(()=>{if(e!=null&&e.items&&(e==null?void 0:e.items.length)>0){let i=0;for(const r of e.items)r!=null&&r.product?i=i+Number(r.quantity*r.product.offerPrice):i=i+Number(r.quantity*r.package.offerPrice);u(()=>i);const c=Number(i)*18/100;k(c);const{discountType:t,couponFixedValue:v,offPercentage:L,maxDiscount:N}=(e==null?void 0:e.couponId)||{};if(e!=null&&e.couponId)if(t==="fixed")h(v),u(r=>r-Number(v));else{let r=Math.ceil(i*(Number(L)/100));r=r>N?N:r,console.log("offerTotal",r),h(r),u($=>$-Number(r))}}},[e==null?void 0:e.orderValue,e==null?void 0:e.couponId,e,e==null?void 0:e.items,T,P]),s.jsx(M,{children:s.jsxs("div",{className:d.wrapper,children:[s.jsxs("div",{className:d.left_div,children:[s.jsxs("div",{className:d.info,children:[s.jsxs("div",{children:[s.jsxs("h4",{children:["Order Id: ",e==null?void 0:e.orderId]}),s.jsx("h5",{children:"Update Status"}),s.jsxs("select",{onChange:I,value:S,className:d.select,name:"status",id:"status",children:[s.jsx("option",{value:"Pending",children:"Pending"}),s.jsx("option",{value:"OutOfDelivery",children:"OutOfDelivery"}),s.jsx("option",{value:"Completed",children:"Completed"}),s.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),s.jsxs("div",{children:[s.jsxs("p",{children:["Date of Order: ",(e==null?void 0:e.createdAt)&&y(new Date(e==null?void 0:e.createdAt),"dd-MM-yyyy")]}),s.jsxs("p",{children:["Time of Order: ",(e==null?void 0:e.createdAt)&&y(new Date(e==null?void 0:e.createdAt),"hh:mm aa")]}),s.jsxs("p",{children:["Payment Type: ",e==null?void 0:e.paymentType]}),s.jsxs("p",{children:["No of Left Bookings: ",e==null?void 0:e.No_of_left_bookings]}),s.jsxs("p",{children:["Refund Amount: ",(m=e==null?void 0:e.refundInfo)==null?void 0:m.amount]}),s.jsxs("p",{children:["Refund Status: ",(f=e==null?void 0:e.refundInfo)==null?void 0:f.status]})]})]}),s.jsxs("p",{style:{marginTop:"20px"},children:["Admin Comment: ",e==null?void 0:e.adminComment]}),s.jsx("h5",{className:d.heading,children:"Products"}),s.jsx("div",{className:d.container,children:(_=e==null?void 0:e.items)==null?void 0:_.map((i,c)=>s.jsxs("div",{className:d.item,children:[s.jsxs("div",{children:[s.jsx("img",{className:d.img,src:`https://storage.googleapis.com/abhicares-backend-bucket/${i.package?i.package.imageUrl[0]:i.product.imageUrl[0]}`,alt:"product"}),s.jsxs("div",{children:[s.jsx("h6",{children:i.package?i.package.name:i.product.name}),s.jsx("p",{children:i.package?"Package":"Product"})]})]}),s.jsxs("p",{children:["Qty: ",i.quantity]}),s.jsxs("p",{children:["₹",Number(i.package?i.package.offerPrice:i.product.offerPrice)*Number(i.quantity)]})]},c))})]}),s.jsxs("div",{className:d.right_div,children:[s.jsxs("div",{className:d.right_div_top,children:[s.jsx("h5",{children:"Order Summary"}),s.jsxs("div",{className:d.heading,children:[s.jsx("p",{children:"Descriptions"}),s.jsx("p",{children:"Amounts"})]}),s.jsxs("div",{className:d.d_flex,children:[s.jsx("p",{children:"Sub Total :"}),s.jsxs("p",{children:["₹",e==null?void 0:e.itemTotal]})]}),s.jsxs("div",{className:d.d_flex,children:[s.jsx("p",{children:"Tax (18%) :"}),s.jsxs("p",{children:["+ ₹",e==null?void 0:e.tax]})]}),(e==null?void 0:e.discount)>0&&s.jsxs("div",{className:d.d_flex,children:[s.jsxs("p",{children:["Discount ('",(j=e==null?void 0:e.couponId)==null?void 0:j.name,"') :"]}),s.jsxs("p",{children:["- ₹",e==null?void 0:e.discount]})]}),(e==null?void 0:e.referalDiscount)>0&&s.jsxs("div",{className:d.d_flex,children:[s.jsx("p",{children:"Referal Discount :"}),s.jsxs("p",{children:["- ₹",e==null?void 0:e.referalDiscount]})]}),s.jsxs("div",{className:d.d_flex,children:[s.jsx("p",{children:"Total Amount :"}),s.jsxs("p",{children:["₹",e==null?void 0:e.orderValue]})]})]}),s.jsxs("div",{className:d.right_div_bottom,children:[s.jsx("h5",{children:"Customer Details"}),s.jsxs("div",{className:d.d_flex,children:[s.jsx("p",{children:"Customer Name :"}),s.jsx("p",{children:(g=e==null?void 0:e.user)==null?void 0:g.name})]}),s.jsxs("div",{className:d.d_flex,children:[s.jsx("p",{children:"Customer Phone :"}),s.jsx("p",{children:e==null?void 0:e.user.phone})]}),s.jsxs("div",{className:d.d_flex,children:[s.jsx("p",{children:"Customer Address :"}),s.jsx("p",{children:`${e==null?void 0:e.user.address.addressLine},${e==null?void 0:e.user.address.landmark},${e==null?void 0:e.user.address.pincode}`})]})]})]})]})})};export{te as default};
