import{n as W,r as o,e as B,u as F,_ as G,j as s}from"./index-B-IXA8Ie.js";import{W as Q}from"./Wrapper-MkLY3g7U.js";import{u as z}from"./usePostApiReq-BqGvxZz6.js";import{u as H}from"./index.esm-BbyRK8SJ.js";import{f as S}from"./index--LFhlb37.js";import"./logo -C1Nz5jdc.js";import"./useDispatch-C5OFXrAN.js";import"./iconBase-3hUsnpgH.js";const J="_wrapper_xu49t_1",K="_left_div_xu49t_19",R="_select_xu49t_33",X="_info_xu49t_45",Y="_heading_xu49t_55",Z="_container_xu49t_67",ee="_item_xu49t_91",se="_img_xu49t_115",ie="_right_div_xu49t_125",re="_right_div_top_xu49t_133",de="_right_div_bottom_xu49t_135",ne="_d_flex_xu49t_157",r={wrapper:J,left_div:K,select:R,info:X,heading:Y,container:Z,item:ee,img:se,right_div:ie,right_div_top:re,right_div_bottom:de,d_flex:ne},je=()=>{var m,f,_,j,g,v,N,y,b,D,T,k;const{res:l,fetchData:A,isLoading:ce}=z(),{res:n,fetchData:I,isLoading:oe}=H(),{state:a}=W(),[L,$]=o.useState(0),[le,u]=o.useState(0),[ae,h]=o.useState(0),q=B(),[e,w]=o.useState(a||""),[E,x]=o.useState(a==null?void 0:a.status),{id:O}=F();console.log("stateData",a);const p=async()=>{I(`/admin/get-order-details?orderId=${O}`)};o.useEffect(()=>{p()},[e==null?void 0:e._id]),o.useEffect(()=>{var i,c,t;((n==null?void 0:n.status)===200||(n==null?void 0:n.status)===201)&&(console.log("getOrderRes",n),w((i=n==null?void 0:n.data)==null?void 0:i.data),x((t=(c=n==null?void 0:n.data)==null?void 0:c.data)==null?void 0:t.status))},[n]);const M=async i=>{const c=i.target.value;x(()=>c),A(`/admin/change-order-status/${e==null?void 0:e._id}`,{status:c})};return o.useEffect(()=>{((l==null?void 0:l.status)===200||(l==null?void 0:l.status)===201)&&(G.success("Order status changed successfully"),p())},[l]),o.useEffect(()=>{if(e!=null&&e.items&&(e==null?void 0:e.items.length)>0){let i=0;for(const d of e.items)d!=null&&d.product?i=i+Number(d.quantity*d.product.offerPrice):i=i+Number(d.quantity*d.package.offerPrice);u(()=>i);const c=Number(i)*18/100;$(c);const{discountType:t,couponFixedValue:P,offPercentage:U,maxDiscount:C}=(e==null?void 0:e.couponId)||{};if(e!=null&&e.couponId)if(t==="fixed")h(P),u(d=>d-Number(P));else{let d=Math.ceil(i*(Number(U)/100));d=d>C?C:d,console.log("offerTotal",d),h(d),u(V=>V-Number(d))}}},[e==null?void 0:e.orderValue,e==null?void 0:e.couponId,e,e==null?void 0:e.items,L,q]),s.jsx(Q,{children:s.jsxs("div",{className:r.wrapper,children:[s.jsxs("div",{className:r.left_div,children:[s.jsxs("div",{className:r.info,children:[s.jsxs("div",{children:[s.jsxs("h4",{children:["Order Id: ",e==null?void 0:e.orderId]}),s.jsx("h5",{children:"Update Status"}),s.jsxs("select",{onChange:M,value:E,className:r.select,name:"status",id:"status",children:[s.jsx("option",{value:"Pending",children:"Pending"}),s.jsx("option",{value:"OutOfDelivery",children:"OutOfDelivery"}),s.jsx("option",{value:"Completed",children:"Completed"}),s.jsx("option",{value:"Cancelled",children:"Cancelled"})]})]}),s.jsxs("div",{children:[s.jsxs("p",{children:["Date of Order: ",(e==null?void 0:e.createdAt)&&S(new Date(e==null?void 0:e.createdAt),"dd-MM-yyyy")]}),s.jsxs("p",{children:["Time of Order: ",(e==null?void 0:e.createdAt)&&S(new Date(e==null?void 0:e.createdAt),"hh:mm aa")]}),s.jsxs("p",{children:["Payment Type: ",e==null?void 0:e.paymentType]}),s.jsxs("p",{children:["No of Left Bookings: ",e==null?void 0:e.No_of_left_bookings]}),s.jsxs("p",{children:["Refund Amount: ",(m=e==null?void 0:e.refundInfo)==null?void 0:m.amount]}),s.jsxs("p",{children:["Refund Status: ",(f=e==null?void 0:e.refundInfo)==null?void 0:f.status]})]})]}),s.jsxs("p",{style:{marginTop:"20px"},children:["Admin Comment: ",e==null?void 0:e.adminComment]}),s.jsx("h5",{className:r.heading,children:"Products"}),s.jsx("div",{className:r.container,children:(_=e==null?void 0:e.items)==null?void 0:_.map((i,c)=>s.jsxs("div",{className:r.item,children:[s.jsxs("div",{children:[s.jsx("img",{className:r.img,src:`https://storage.googleapis.com/abhicares-backend-bucket/${i.package?i.package.imageUrl[0]:i.product.imageUrl[0]}`,alt:"product"}),s.jsxs("div",{children:[s.jsx("h6",{children:i.package?i.package.name:i.product.name}),s.jsx("p",{children:i.package?"Package":"Product"})]})]}),s.jsxs("p",{children:["Qty: ",i.quantity]}),s.jsxs("p",{children:["₹",Number(i.package?i.package.offerPrice:i.product.offerPrice)*Number(i.quantity)]})]},c))})]}),s.jsxs("div",{className:r.right_div,children:[s.jsxs("div",{className:r.right_div_top,children:[s.jsx("h5",{children:"Order Summary"}),s.jsxs("div",{className:r.heading,children:[s.jsx("p",{children:"Descriptions"}),s.jsx("p",{children:"Amounts"})]}),s.jsxs("div",{className:r.d_flex,children:[s.jsx("p",{children:"Sub Total :"}),s.jsxs("p",{children:["₹",e==null?void 0:e.itemTotal]})]}),s.jsxs("div",{className:r.d_flex,children:[s.jsx("p",{children:"Tax and other charges :"}),s.jsxs("p",{children:["+ ₹",e==null?void 0:e.tax]})]}),(e==null?void 0:e.discount)>0&&s.jsxs("div",{className:r.d_flex,children:[s.jsxs("p",{children:["Discount ('",(j=e==null?void 0:e.couponId)==null?void 0:j.name,"') :"]}),s.jsxs("p",{children:["- ₹",e==null?void 0:e.discount]})]}),(e==null?void 0:e.referalDiscount)>0&&s.jsxs("div",{className:r.d_flex,children:[s.jsx("p",{children:"Referal Discount :"}),s.jsxs("p",{children:["- ₹",e==null?void 0:e.referalDiscount]})]}),s.jsxs("div",{className:r.d_flex,children:[s.jsx("p",{children:"Total Amount :"}),s.jsxs("p",{children:["₹",e==null?void 0:e.orderValue]})]})]}),s.jsxs("div",{className:r.right_div_bottom,children:[s.jsx("h5",{children:"Customer Details"}),s.jsxs("div",{className:r.d_flex,children:[s.jsx("p",{children:"Customer Name :"}),s.jsx("p",{children:(g=e==null?void 0:e.user)==null?void 0:g.name})]}),s.jsxs("div",{className:r.d_flex,children:[s.jsx("p",{children:"Customer Phone :"}),s.jsx("p",{children:(v=e==null?void 0:e.user)==null?void 0:v.phone})]}),s.jsxs("div",{className:r.d_flex,children:[s.jsx("p",{children:"Customer Address :"}),s.jsx("p",{children:`${(y=(N=e==null?void 0:e.user)==null?void 0:N.address)==null?void 0:y.addressLine},${(D=(b=e==null?void 0:e.user)==null?void 0:b.address)==null?void 0:D.landmark},${(k=(T=e==null?void 0:e.user)==null?void 0:T.address)==null?void 0:k.pincode}`})]})]})]})]})})};export{je as default};
