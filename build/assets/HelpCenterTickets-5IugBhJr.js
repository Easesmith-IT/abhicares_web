import{r,e as A,f as h,j as s,_ as M}from"./index-DmceSUEu.js";import{a as Q,h as E}from"./LogoutModal-BO_6Xxx7.js";import{W as z,c as l}from"./Wrapper-CijAMONv.js";import{h as o}from"./HelpCenter.module-CDSZ6uwM.js";import{L as F}from"./Loader-ChNLyE8c.js";import{D as L}from"./DeleteModal-BiCqzwz4.js";import{P as R}from"./react-bootstrap-pagination-control.esm-z_C9wi5S.js";import{u as O}from"./useAuthorization-C8MmfE-L.js";import{f as W}from"./index-DSEmMwTb.js";import"./iconBase-CgRV0d11.js";import"./logo -C1Nz5jdc.js";const ee=()=>{r.useState(!1);const[p,d]=r.useState(!1),[f,v]=r.useState(""),[n,x]=r.useState([]),[g,j]=r.useState(!0),C=A(),{checkAuthorization:b}=O(),[i,S]=r.useState(1),[I,y]=r.useState(0),[a,N]=r.useState({date:"",serviceType:"",raisedBy:"",status:"",searchQuery:""}),[u,T]=r.useState([]);console.log("filter",a);const _=async()=>{try{const{data:e}=await h.get("https://abhicares.com/api/admin/get-all-category",{withCredentials:!0});T(e.data),console.log("allCategories",e)}catch(e){console.log(e)}};r.useEffect(()=>{_()},[]);const D=async e=>{S(e)},t=e=>{const{name:c,value:B}=e.target;N({...a,[c]:B})},m=async()=>{try{const{data:e}=await h.get(`https://abhicares.com/api/admin/get-all-tickets?page=${i}&ticketId=${a.searchQuery}`,{withCredentials:!0});console.log("tickets",e),y(e.totalPages),x(e.data)}catch(e){console.log(e)}finally{j(!1)}};r.useEffect(()=>{!a.date&&!a.raisedBy&&!a.serviceType&&a.searchQuery&&!a.status?m():$()},[i,a.date,a.raisedBy,a.serviceType,a.searchQuery,a.status]);const $=async()=>{try{const{data:e}=await h.get(`https://abhicares.com/api/admin/filter-ticket?date=${a.date}&serviceType=${a.serviceType}&raisedBy=${a.raisedBy}&page=${i}`,{withCredentials:!0});console.log("filter tickets",e),y(e.totalPages),x(e.data)}catch(e){console.log(e)}finally{j(!1)}},w=e=>{v(e),d(!p)},P=async()=>{try{const{data:e}=await h.delete(`https://abhicares.com/api/admin/delete-ticket?ticketId=${f}`,{withCredentials:!0});M.success("Ticket deleted successfully"),m(),d(!p)}catch(e){console.log(e),d(!1),b(e)}};return s.jsxs(s.Fragment,{children:[s.jsx(z,{children:s.jsxs("div",{className:l["report-container"],children:[s.jsxs("div",{className:l["report-header"],children:[s.jsx("h1",{className:l["recent-Articles"],children:"All Tickets"}),s.jsxs("div",{className:l.filter,children:[s.jsx("input",{type:"search",name:"searchQuery",value:a.searchQuery,onChange:t,placeholder:"Search by ticket Id",className:l.filter_input}),s.jsx("input",{type:"date",name:"date",value:a.date,onChange:t,placeholder:"Start Date",className:l.filter_input}),s.jsxs("select",{name:"serviceType",value:a.serviceType,onChange:t,className:l.filter_input,children:[s.jsx("option",{value:"",children:"Select Service Category"}),u==null?void 0:u.map(e=>s.jsx("option",{value:e==null?void 0:e._id,children:e==null?void 0:e.name},e==null?void 0:e._id))]}),s.jsxs("select",{name:"raisedBy",value:a.raisedBy,onChange:t,className:l.filter_input,children:[s.jsx("option",{value:"",children:"Raised by"}),s.jsx("option",{value:"customer",children:"Customer"}),s.jsx("option",{value:"partner",children:"Partner"})]})]})]}),s.jsxs("div",{className:o.container,children:[!g&&(n==null?void 0:n.length)===0&&s.jsx("p",{children:"No tickets found"}),g&&(n==null?void 0:n.length)===0&&s.jsx(F,{}),n==null?void 0:n.map(e=>{var c;return s.jsxs("div",{className:o.helpCenter,children:[s.jsxs("div",{className:o.helpCenter_left,children:[s.jsx("p",{children:e!=null&&e.status?s.jsxs("div",{children:[s.jsx("b",{children:"Status:"})," ",s.jsx("span",{className:(e==null?void 0:e.status)==="in-review"?o.under_review:o.resolved,children:e==null?void 0:e.status})]}):s.jsx("span",{children:"Status unavailable"})}),s.jsxs("p",{children:[s.jsx("b",{children:"Raised by:"})," ",e==null?void 0:e.raisedBy]}),s.jsxs("p",{children:[s.jsx("b",{children:"Concern:"})," ",e==null?void 0:e.description]}),s.jsxs("p",{children:[s.jsx("b",{children:"Issue Date:"})," ",W(new Date(e==null?void 0:e.createdAt),"dd-MM-yyyy")]}),s.jsxs("p",{children:[s.jsx("b",{children:"Raiser ID :"})," ",(e==null?void 0:e.raisedBy)==="customer"?e==null?void 0:e.userId:e==null?void 0:e.sellerId]}),(e==null?void 0:e.bookingId)&&s.jsxs("p",{children:[s.jsx("b",{children:"Booking ID :"})," ",(c=e==null?void 0:e.bookingId)==null?void 0:c.bookingId]}),s.jsxs("p",{children:[s.jsx("b",{children:"Service ID :"})," ",e==null?void 0:e.serviceId]}),s.jsxs("p",{children:[s.jsx("b",{children:"Ticket type :"})," ",e==null?void 0:e.ticketType]}),s.jsxs("p",{children:[s.jsx("b",{children:"Ticket Id :"})," ",e==null?void 0:e.ticketId]})]}),s.jsxs("div",{className:o.helpCenter_right,children:[s.jsx(Q,{onClick:()=>w(e._id),cursor:"pointer",size:22,color:"red"}),s.jsx(E,{onClick:()=>C(`/admin/help-center/tickets/${e._id}`),cursor:"pointer",size:22})]})]},e==null?void 0:e._id)})]}),s.jsx("div",{children:s.jsx(R,{changePage:D,limit:10,page:i,total:I+"0"})})]})}),p&&s.jsx(L,{handleDelete:P,setState:d})]})};export{ee as default};
