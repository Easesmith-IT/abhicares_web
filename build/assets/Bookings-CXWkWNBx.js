import{r as i,u as y,j as e,e as r}from"./index-DkoRNXTn.js";import{W as v,c as s}from"./Wrapper-BE5Wi-p6.js";import{i as N}from"./LogoutModal-CkNuOxDX.js";import{L as b}from"./Loader-DVwzzA9D.js";import{f as k}from"./index-BWTSNkdF.js";import"./logo -C1Nz5jdc.js";import"./iconBase-CHCpDIrE.js";const B=()=>{const[o,n]=i.useState([]),[d,h]=i.useState(!0),[l,m]=i.useState({date:"",status:""});console.log("filters",l);const p=t=>{const{name:a,value:c}=t.target;m({...l,[a]:c})},g=y(),u=i.useRef(),x=async()=>{try{const{data:t}=await r.get("https://abhicares.com/api/admin/get-booking-list",{withCredentials:!0});n(t.data),console.log("allBookings",t)}catch(t){console.log(t)}finally{h(!1)}};i.useEffect(()=>{x()},[]);const j=async()=>{try{const{data:t}=await r.get(`https://abhicares.com/api/admin/search-filter-bookings?status=${l.status}&bookingDate=${l.date}`,{withCredentials:!0});n(t.data),console.log("filterBookings",t)}catch(t){console.log(t)}finally{h(!1)}};i.useEffect(()=>{(l.date||l.status)&&j()},[l.date,l.status]);const f=async()=>{var t;try{const a=u.current.value;if(!a){x();return}const{data:c}=await r.get(`https://abhicares.com/api/admin/get-booking-by-id?bookingId=${a}`,{withCredentials:!0});console.log("bookingId data",c),n(c.data)}catch(a){console.log(a),((t=a==null?void 0:a.response)==null?void 0:t.status)===404&&n([])}};return e.jsx(e.Fragment,{children:e.jsx(v,{children:e.jsxs("div",{className:s["report-container"],children:[e.jsxs("div",{className:s["report-header"],children:[e.jsx("h1",{className:s["recent-Articles"],children:"Bookings"}),e.jsxs("div",{style:{display:"flex",gap:"20px",alignItems:"center"},children:[e.jsxs("div",{className:"d-flex",style:{position:"relative"},children:[e.jsx("input",{ref:u,style:{width:"300px",padding:"5px 10px",borderRadius:"5px"},type:"text",placeholder:"search booking by id"}),e.jsx(N,{onClick:f,style:{position:"absolute",right:"8px",top:"10px",cursor:"pointer"}})]}),e.jsx("input",{type:"date",name:"date",value:l.date,onChange:p,className:s.filter_input}),e.jsxs("select",{name:"status",value:l.status,onChange:p,className:s.filter_input,children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"alloted",children:"Alloted"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"not-alloted",children:"Not Alloted"})]})]})]}),e.jsxs("div",{className:s["report-body"],children:[e.jsxs("div",{className:s["report-topic-heading"],children:[e.jsx("h3",{className:s["t-op"],style:{width:"200px"},children:"Booking Id"}),e.jsx("h3",{className:s["t-op"],children:"Booking Date"}),e.jsx("h3",{className:`${s["t-op"]}`,children:"Status"}),e.jsx("h3",{className:`${s["t-op"]}`,children:"Booking Value"}),e.jsx("h3",{className:s["t-op"],children:"Details"})]}),e.jsxs("div",{className:s.items,children:[!d&&(o==null?void 0:o.length)===0&&e.jsx("p",{children:"No bookings found"}),d&&(o==null?void 0:o.length)===0&&e.jsx(b,{}),o==null?void 0:o.map((t,a)=>e.jsxs("div",{className:`${s.item1} ${s.cursor}`,children:[e.jsx("h3",{className:`${s["t-op-nextlvl"]}`,style:{width:"200px"},children:t.bookingId}),e.jsxs("h3",{className:s["t-op-nextlvl"],children:[e.jsx("span",{style:{color:"green"},children:t.autoAssigned&&"auto"})," ",k(new Date(t==null?void 0:t.bookingDate),"dd-MM-yyyy")]}),e.jsx("h3",{className:`${s["t-op-nextlvl"]} ${s.status} ${t.status==="cancelled"?s.Cancelled:t.status==="completed"?s.Completed:t.status==="alloted"?s.alloted:s.OutOfDelivery}`,children:t.status}),e.jsxs("h3",{className:`${s["t-op-nextlvl"]}`,children:["â‚¹",t.orderValue]}),e.jsx("h3",{className:s["t-op-nextlvl"],children:e.jsx("button",{onClick:()=>g(`/admin/bookings/${t._id}`,{state:t}),className:s.button,children:"View Details"})})]},a))]})]})]})})})};export{B as default};
