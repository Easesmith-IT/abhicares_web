import{r as c,e as D,j as e,_ as N,f as v,o as F,p as P}from"./index-lY8eDmQj.js";import{W as A,c as f}from"./Wrapper-C5Vyjcs6.js";import{A as U}from"./add-icon-nobg-CDiYK8IX.js";import{p as R}from"./index-9JSMm1vn.js";import{R as M}from"./index.esm-TZhK3vYx.js";import{R as L}from"./index-DzltI5z0.js";/* empty css                   */import{u as $}from"./useAuthorization-ZL8Fu2nK.js";import{g as I,a as z}from"./LogoutModal-CpkpXklC.js";import{D as E}from"./DeleteModal-CI6_ta-U.js";import{L as O}from"./Loader-D1crzail.js";import{F as T}from"./index.esm-CnaLvXm0.js";import"./logo -C1Nz5jdc.js";import"./iconBase-BlupGJxB.js";const W="_heading_container_rgxyq_1",q={heading_container:W},B="_wrapper_10nyf_1",Q="_modal_10nyf_27",G="_heading_container_10nyf_47",J="_form_10nyf_59",K="_input_container_10nyf_73",V="_input_10nyf_73",X="_button_wrapper_10nyf_105",Y="_button_10nyf_105",Z="_img_container_10nyf_133",ee="_icon_10nyf_145",n={wrapper:B,modal:Q,heading_container:G,form:J,input_container:K,input:V,button_wrapper:X,button:Y,img_container:Z,icon:ee},H=({setIsModalOpen:p,categoryId:b,service:a="",getCategoryServices:j})=>{const{checkAuthorization:m}=$(),[l,g]=c.useState((a==null?void 0:a.description)||""),[t,h]=c.useState({name:(a==null?void 0:a.name)||"",startingPrice:(a==null?void 0:a.startingPrice)||"",img:(a==null?void 0:a.imageUrl)||"",appHomepage:(a==null?void 0:a.appHomepage)||!1,webHomepage:(a==null?void 0:a.webHomepage)||!1,previewImage:""}),x=c.useRef(null),w=d=>{d.preventDefault();const i=d.target.files[0],o=new FileReader;o.readAsDataURL(i),o.addEventListener("load",function(){h({...t,img:i,previewImage:this.result})})},_=d=>{const{name:i,value:o}=d.target;h({...t,[i]:o})},C=()=>{x.current&&(x.current.value=null),h({...t,img:"",previewImage:""})},S=()=>{h({...t,img:"",previewImage:""})};D();const r=async d=>{if(d.preventDefault(),!t.name||!t.startingPrice||!t.img||!l){N.error("All the fields are required");return}const i=new FormData;if(i.append("name",t.name),i.append("startingPrice",t.startingPrice),i.append("description",l),i.append("appHomepage",t.appHomepage),i.append("webHomepage",t.webHomepage),i.append("img",t.img),i.append("categoryId",b),a)try{const{data:o}=await v.patch(`https://abhicares.com/api/admin/update-service/${a._id}`,i,{withCredentials:!0});N.success("Service updated successfully"),j(),p(!1)}catch(o){p(!1),m(o)}else try{const{data:o}=await v.post("https://abhicares.com/api/admin/create-service",i,{withCredentials:!0});N.success("Service added successfully"),j(),p(!1)}catch(o){p(!1),m(o)}};return e.jsx("div",{className:n.wrapper,children:e.jsxs("div",{className:n.modal,children:[e.jsxs("div",{className:n.heading_container,children:[e.jsxs("h4",{children:[a?"Update":"Add"," Service"]}),e.jsx("div",{className:n.d_flex,children:e.jsx(M,{onClick:()=>p(!1),cursor:"pointer",size:26})})]}),e.jsxs("form",{onSubmit:r,className:n.form,children:[e.jsxs("div",{className:n.input_container,children:[e.jsx("label",{htmlFor:"name",children:"Name"}),e.jsx("input",{className:n.input,onChange:_,value:t.name,type:"text",name:"name",id:"name"})]}),e.jsxs("div",{className:n.input_container,children:[e.jsx("label",{htmlFor:"startingPrice",children:"Starting Price"}),e.jsx("input",{className:n.input,onChange:_,value:t.startingPrice,type:"number",name:"startingPrice",id:"startingPrice"})]}),e.jsxs("div",{className:n.input_container,children:[e.jsx("label",{htmlFor:"description",children:"Description"}),e.jsx(L,{theme:"snow",value:l,onChange:g})]}),e.jsxs("div",{className:n.input_container,children:[e.jsx("label",{htmlFor:"imageUrl",children:"Image"}),e.jsx("input",{ref:x,onChange:w,type:"file",name:"imageUrl",id:"imageUrl"}),t.previewImage&&e.jsxs("div",{className:n.img_container,children:[e.jsx("img",{width:200,height:150,src:t.previewImage,alt:"service"}),e.jsx(I,{onClick:C,className:n.icon})]}),!t.previewImage&&t.img&&e.jsxs("div",{className:n.img_container,children:[e.jsx("img",{width:200,height:150,src:`https://storage.googleapis.com/abhicares-backend-bucket/${t.img}`,alt:"service"}),e.jsx(I,{onClick:S,className:n.icon})]})]}),e.jsxs("div",{className:n.input_container,children:[e.jsx("label",{htmlFor:"appHomepage",children:"App Homepage"}),e.jsxs("select",{onChange:_,value:t.appHomepage,className:n.input,name:"appHomepage",id:"appHomepage",children:[e.jsx("option",{value:"true",children:"True"}),e.jsx("option",{value:"false",children:"False"})]})]}),e.jsxs("div",{className:n.input_container,children:[e.jsx("label",{htmlFor:"webHomepage",children:"Web Homepage"}),e.jsxs("select",{onChange:_,value:t.webHomepage,className:n.input,name:"webHomepage",id:"webHomepage",children:[e.jsx("option",{value:"true",children:"True"}),e.jsx("option",{value:"false",children:"False"})]})]}),e.jsx("div",{className:n.button_wrapper,children:e.jsx("button",{className:n.button,children:a?"Update":"Add"})})]})]})})},ue=()=>{const[p,b]=c.useState(!1),[a,j]=c.useState(!1),[m,l]=c.useState(!1),[g,t]=c.useState([]),[h,x]=c.useState({}),[w,_]=c.useState(!0),C=D(),{state:S}=F(),r=P(),{checkAuthorization:d}=$(),i=(s,u)=>{s.stopPropagation(),x(u),j(!m)},o=(s,u)=>{s.stopPropagation(),x(u),l(!m)},y=async()=>{try{const{data:s}=await v.get(`https://abhicares.com/api/admin/get-category-service/${r==null?void 0:r.categoryId}`,{withCredentials:!0});console.log("services",s),t(s.data)}catch(s){console.log(s)}finally{_(!1)}};c.useEffect(()=>{y()},[]);const k=async()=>{try{const{data:s}=await v.delete(`https://abhicares.com/api/admin/delete-service/${h}`,{withCredentials:!0});N.success("Service deleted successfully"),y(),l(!m)}catch(s){console.log(s),l(!1),d(s)}};return e.jsxs(e.Fragment,{children:[e.jsx(A,{children:e.jsxs("div",{className:f["services-wrapper"],children:[e.jsxs("div",{className:f["services-header"],children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Sub-Categories"}),e.jsx("h4",{style:{marginTop:"30px"},children:S.categoryName})]}),e.jsx("button",{onClick:()=>b(!0),className:f.services_add_btn,children:e.jsx("img",{src:U,alt:"add service"})})]}),e.jsxs("div",{className:f.card_container,children:[!w&&g.length===0&&e.jsx("p",{children:"No service found"}),w&&g.length===0&&e.jsx(O,{}),g==null?void 0:g.map(s=>e.jsxs("div",{onClick:()=>C(`/admin/services/${r==null?void 0:r.categoryId}/product/${s._id}`,{state:s}),className:f.card,children:[e.jsx("img",{src:`https://storage.googleapis.com/abhicares-backend-bucket/${s.imageUrl}`,alt:"product"}),e.jsxs("div",{children:[e.jsxs("div",{className:q.heading_container,children:[e.jsx("h5",{children:s.name}),e.jsxs("div",{className:f.icon_container,children:[e.jsx(T,{onClick:u=>i(u,s),size:20}),e.jsx(z,{onClick:u=>o(u,s._id),size:22,color:"red"})]})]}),e.jsx("p",{children:R(s.description)})]})]},s._id))]})]})}),p&&e.jsx(H,{setIsModalOpen:b,categoryId:r==null?void 0:r.categoryId,getCategoryServices:y}),a&&e.jsx(H,{setIsModalOpen:j,service:h,getCategoryServices:y}),m&&e.jsx(E,{setState:l,handleDelete:k})]})};export{ue as default};
